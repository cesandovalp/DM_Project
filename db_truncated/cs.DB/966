decid equival aggreg count distinct queri babak bagheri harari val tannen comput scienc depart univers pennsylvania abstract address problem equival count distinct gregat queri prove problem decid decid third level polynomi hierarchi introduc notion core conjunct queri comparison extens classic notion rela tional queri prove exist isomorph core queri suffici condit equival conjunct queri comparison sim ilar classic relat set condit equival count distinct queri introduc relax condit base notion queri equival initi queri introduc captur behavior count distinct oper introduct problem decid equival conjunct gregat count distinct queri investig start late problem decid aggreg oper includ sum averag count count distinct queri suffici condit propos open problem decid paper studi problem equal count distinct conjunct queri provid suffici condit problem introduc notion core conjunct queri comparison classic relat conjunct queri exist isomorph core conjunct queri comparison suffici nec essari condit equal condit suffici condit equal conjunct queri easi exist pod system databas principl symposium sigart sigmod sigact acm seventeenth proceed queri aggreg equival decid shurin sagiv nutt acm journal inequ queri conjunct klug logic comput transact acm negat queri aggreg equival nutt sagiv cohen acm journal queri aggreg conjunct equival decid sagiv nutt cohen record sigmod queri aggreg contain cohen refer queri distinct count contain problem happen will question open legitim isomorph check iti equal problem address domain discret happen will open domain order dens flip comparison queri core tion introduc problem cidabl prove comparison queri distinct count equival problem discuss paper conclus equal infer isomorph result equal equal impli lemma equal equal lemma equival decid condit suffici queri core flip core isomorph equal equal core flip comput core core comput compar queri consid queri distinct count equival check algorithm idea proof equival check decid queri distinct count theorem lemma consequ direct proof comparison comparison linear dag dag morphism 