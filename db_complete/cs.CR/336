vulner discoveri stage program analysi bhargava fabian konrad jean pierr secur telecommun berlin germani institut system secur braunschweig germani abstract elimin vulner low level code vital secur softwar static analysi promis approach discov ere vulner provid develop earli feedback code write present multipl challeng understand bug exploit convey develop paper design implement practic vulner assess framework call lang lang perform data control flow analysi agnos potenti secur bug output well format bug report help develop understand secur bug base intu ition real vulner manifest multipl part program lang perform local global analys scale larg program global analysi demand driven proto type detect multipl vulner class code includ type confus garbag memori read evalu lang extens case studi lang scale larg code base chromium easi import capabl discov vulner real code find indic static analysi viabl reinforc softwar test tool set keyword program analysi vulner assess llvm introduct vulner popular softwar detriment user secur hard identifi high inter connect system escal damag inflict user secur promis well cost fix vulner address threat landscap softwar vendor establish mechan softwar qualiti assur test prevail thought secur bug identifi fix earli impos lower cost identifi test phase wild vulner mediat process identifi fix vulner softwar develop process isol analysi practic discov secur bug softwar develop prior approach vulner discoveri static code analysi rang simpl pattern match context path sensit data flow analysi instanc vulner scanner program pars sourc code lexic token terest exist vulner databas initi experi pattern match approach employ produc larg number warn ing modern codebas contrari secur vulnera biliti subtl corner case rare approach well suit extrem fast analysi high amount manual effort requir valid warn undermin tool spectrum clang static analyz present analyt superior approach defect discoveri precis context path sensit analysi enabl clang warn evid bug feasibl program path precis warn reduc burden manual valid find clang local inter procedur analysi miss secur bug span file boundari omiss bug span file boundari object orient object implement object typic sourc file natur solut analysi global global analysi scale larg program paper find middl ground design implemen tation lang vulner assess tool program perform local global analysi stage discov potenti vulner abil span sourc file lang implement extens llvm compil infrastructur analysi scalabl lang perform comput expens analys local sourc file perform cheaper analys global program addit global analysi demand driven perform valid outcom local analys provid good diagnost lang analyz sourc code output develop friend bug report point exact posit sourc code potenti vulner exist problemat remedi case studi valid design decis find lang capabl highlight hand problemat corner case scale larg program chromium firefox lang plement extens compil toolchain clang llvm invok build process current implementa tion fast incorpor night larg codebas mysql chromium optim third firefox summari contribut major browser includ chromium firefox implement ject orient code build automat initi overnight virtual machin cluster design implement lang extens pro gram analysi framework demonstr util lang employ detect multipl class vulner includ garbag read incorrect type data common sourc exploit vulner evalu lang extens benchmark lang juliet benchmark program analysi tool lang tect multipl vulner php interpret chromium codebas discov defect firefox background clang llvm lang anchor clang llvm open sourc compil toolchain outcom pioneer work lattner view compon toolchain core design clang llvm compil heart util limit code generat optim part compil front clang llvm encapsul librari select client system depend llvm project lend well multipl compil technolog driven case program analysi build lang top analysi infrastructur llvm project infrastructur compris clang static analyz sourc code analyz object program llvm analyz optim framework permit analysi llvm bitcod paragraph describ compon clang static analyz clang static analyz clang spirit metal xgcc author classifi meta level compil framework goal framework allow modular extens compil enabl check domain specif program properti abstract view framework compris set checker domain specif analysi procedur compil system divis labor envis hallem checker encod properti check leav mechan actual check compil system compil system facilit check provid analysi infrastructur figur framework realiz clang sourc file pars subsequ pass data flow analysi engin dfa engin analysi infrastructur requir checker checker encod program properti check produc bug report violat bug report review human analyst file bug report clang static analyz checker graph reachabl engin symbol execut engin dfa engin fig clang static analyz overview data flow analysi engin clang perform context path sensit ter procedur data flow analysi context sensit analysi preserv call context function call path sensit analysi explor path fork branch statement independ context sen sitiv realiz graph reachabl engin implement sake algorithm propos rep path sensit implement symbol execut engin symbol execut engin static forward symbol execut fse explor program path sourc file checker checker implement domain specif check issu bug report clang default suit checker implement varieti check includ unsaf api usag memori access error import checker framework clang programm add custom check facilit custom check clang expos callback api hook dfa engin pre defin program locat clang checker demonstr util meta level compil llvm pass infrastructur llvm pass infrastructur modular perform anal yses optim llvm intermedi represent pro gram llvm type sourc languag independ represent program facilit uniform analysi program librari simpli llvm pass oper procedur invoc unit llvm code granular code oper vari function entir program modul llvm parlanc pass sequenc allow success pass reus work transform carri preced pass llvm pass framework api tap sourc level meta data llvm bridg syntact gap sourc level level analys sourc liter match llvm meta data programmat lang take approach teach llvm pass sourc level bug report builder analyz m√©lang extend diagnost build interceptor nativ compil sourc analyz librari execut bitcodeanalysi codebas candid bug report nativ librari execut fig lang overview lang primari goal develop earli warn system secur critic softwar defect envis lang tool assist develop iden tifi fix potenti secur bug softwar develop figur overview approach lang compris high level ponent build interceptor llvm builder sourc analyz program analyz summar role compon analyz program subsequ describ greater detail build interceptor build interceptor program interpos tween build program gnu compil system clang llvm lang build interceptor respons correct independ invok program builder sourc analyz llvm builder llvm builder util program assist gen erat llvm bitcod object program mirror step nativ compil llvm bitcod generat sourc analyz sourc analyz execut domain specif check sourc file output candid bug report diagnos potenti secu riti bug sourc analyz invok stage analysi implement sourc analyz librari checker plug patch version clang program analyz analyz examin candid bug report step extend diagnost report classifi fals posit develop report extend diagnost classifi fals posit analyz implement analyz multipl llvm pass analysi util eas deploy design goal lang softwar velop analysi framework build environ seamless build interceptor llvm builder analysi util help achiev goal build interceptor llvm builder facilit tran parent analysi codebas plug analys exist build system describ paragraph build interceptor approach transpar analyz larg softwar project hing trigger analysi build command exist build interceptor scan build clang project scan build command util intercept build command invok sourc analyz tandem compil analysi target program llvm bitcod instrument scan build invok sourc analyz llvm builder llvm builder generat llvm bitcod program librari execut modifi sourc code build configur daunt task fortun program llvm wllvm exist open sourc llvm builder solv problem wllvm python base util lever age compil generat program librari llvm bitcod drop replac compil point builder gnu wllvm suffici sourc analyz sourc analyz assist lang search potenti bug sourc code build event collect system aid search event collect system flexibl cater multipl case employ detect tradit taint style vulner well semant defect event collect system implement system taint languag construct declar call under mechan declar taint taint propos event collect system associ ast declar identifi object write checker flag defect checker develop client propos event collect system divis labor checker event collect system mirror meta level compil concept checker encod polici flag defect event collect system maintain state requir perform check prototyp system flag garbag uniniti object incorrect type cast php interpret codebas common weak enumer algorithm flag garbag read base variat gen kill set demonstr util propos system code snippet list run exampl aim detect uniniti read class member exampl list encompass sourc file header file maintain set event collect system def set declar identifi class member definit usewithoutdef set identifi class member preced definit maintain instanc set function analyz translat unit function denot analysi summari set checker decid event collect set popul logic popul def usewithoutdef set simpl program statement function defin class member time add class member identifi def set analysi summari program statement function class member absent def set add class member identifi usewithoutdef set analysi summari class foo public int foo bool iszero includ bool foo iszero return true includ int main foo return return list run exampl foo object initi class member foo call iszero lead garbag read list function foo iszero file analyz checker add class member foo usewithoutdef set foo iszero analyz branch condit checker encount definit foo analysi context subsequ analysi constructor function foo foo yield addit def usewithoutdef set foo foo empti final checker compar set membership analysi context foo mark valid definit foo iszero foo member def set constructor analysi summari foo foo checker classifi candid bug checker encod proof bug candid bug report list candi bug report encod bug report encod locat analysi stack correspond potenti garbag uniniti read propos event collect approach benefit retrofit simpl declar base object taint clang enabl checker perform analysi base propos taint abstract general purpos natur taint abstract discov defect type null pointer derefer second taint api expos opt exist checker third addit leverag high precis analysi infrastructur clang implement event collect system patch mainlin version clang static analyz paragraph describ candid bug report analyz program analyz program analyz program analysi demand driven candid bug report analyz analysi target llvm bitcod file librari execut aspect analysi pars candid bug report construct queri analysi written simpl python base parser pars candid bug report construct queri analysi implement set llvm pass bug report parser encod queri preprocessor direct pass header file driver script recompil pass candid bug report program analysi routin compos callgraph analysi pass leverag exist llvm pass call basic callgraph pass build program call graph basic pass miss control flow indirect call site implement addit analys improv precis basic callgraph foremost analys class erarchi analysi cha cha enabl devirtu dynam dispatch call site sure deleg cha undertaken scenario class hierarchi introduc scenario cha applic examin call instruc tion resolv form indirect call site prototyp resolv alias global function function cast program call graph perform domain specif analysi instanc valid garbag read pass inspect load store buggi program variabl object run exampl list load store foo class member indic candid bug report list track garbag read pass program call graph travers check load foo match store load match store candid bug report classifi fals posit program call chain load foo match store display analyst program bug report list sourc level bug report report local path bug foo annot sourc code warn uniniti object field warn generat program bug report report pars bug report report write queri llvm pass header file recompil llvm pass run llvm bugreportanalyz pass main candid callchain foo iszero main list candid bug report top program bug report bottom garbag read run exampl list evalu evalu lang static analysi benchmark real code gaug util test defect vulner evalu seek answer que tion effort requir lang exist build system lang perform static analysi benchmark lang fare secur vulner analysi time effect lang larg well test codebas deploy eas deploy design goal lang build interposit low analyz codebas modifi build configur sourc code deploy lang amazon comput instanc codebas build system analyz benefit build system integr increment analysi build codebas incur cost analysi subsequ analys increment increment analysi conjunct daili build full analysi coupl night build initi virtual machin cluster nist benchmark static analysi benchmark releas samat project benchmark detect rate juliet test suit version measur true fals posit detect rate defect spread multipl categori juliet suit compris test set multipl defect type test set test case specif mon weak enumer cwe cwe system assign identifi common class softwar weak lead exploit vulner implement lang checker pass cwe categori garbag uniniti read type con fusion unexpect sign extens sign sign convers error except list cwes receiv scant attent static analysi tool instanc type confus emerg attack vector exploit popular applic figur summar true fals posit rate tprs fprs clang lang chosen cwe benchmark current clang port compar report clang lang test set find err side precis fewer fals posi tive err side caution fewer fals negat chosen cwe benchmark lang attain true posit rate capabl spot half bug test suit stagger analysi approach allow sourc file wide program wide diagnost figur contrast clang agnost restrict singl sourc file call stack present extend diagnost speed manual valid bug report tpr fpr percentag clangsa melang melang melang melang fig juliet test suit true posit rate tpr fals posit rate fpr lang clang static analyz clang support detect vulner test type confus vulner php interpret lang test flaw taint style vulner attack con troll input pass secur sensit function call wrong interpret type ultim vulner result invalid memori access leverag attack arbitrari code execut disclosur wrote checker detect multipl instanc vulner type php interpret codebas patch vulnera biliti test carri unpatch version codebas lang flag vulner entri tabl summar find three vulner sign common vulner exposur cve identifi mitr corpor report cve cve php report receiv bug bounti total internet bug bounti panel addit checker php releas candid php releas novemb lang drawn atten tion php system vulner exist verifi exploit exercis demonstr util bring attent multipl instanc softwar flaw larg codebas activ develop case studi investig practic util lang conduct case stud three popular open sourc project chromium firefox codebas cve rate bug vulner php cve type confus php cve type confus php cve type confus php unassign type confus php unassign type confus chromium medium sever garbag read chromium garbag read firefox garbag read tabl detect summari lang product codebas lang confirm vulner flag defect firefox list chromium firefox bug exploit chromium bug classifi medium sever bug intern bug tracker mysql focus detect garbag read para graph case studi emphas analysi effect ness analysi time softwar version evalu carri chromium version date august firefox revis mysql version april evalu setup analysi perform amazon comput instanc run ubuntu provis virtual intel xeon cpus clock ghz ram ssd base storag effect true posit prototyp flag confirm defect chromium firefox includ defect bottom three entri tabl defect prototyp mysql codebas report upstream triag figur bug report garbag read pdf librari ship chromium sourc level bug report figur code buggi bug report figur candid call chain libpdf librari uniniti read manifest manual valid verac bug report generat lang sourc code audit bug report verifi data flow control flow convey report talli pro gram semant classifi defect pass audit true posit addit chromium true posit match find report generat memorysanit dynam pro gram analysi tool googl defect discov firefox port upstream evalu demonstr lang complement dynam program analysi tool today bug summari file out_analyz debug pdf locat column descript uniniti object field local path bug chrome_pdf pageind fade_out_timer_id_ annot sourc code copyright chromium author right reserv sourc code govern bsd style licens licens file includ pdf includ base includ base string includ pdf includ pdf includ pdf namespac chrome_pdf pageind pageind current_page_ fade_out_timer_id_ splash_timeout_ kpageindicatorsplashtimeoutm fade_timeout_ kpageindicatorscrollfadetimeoutm always_visible_ fals pageind pageind ect field fade_out_timer_id_ right reserv bsd style licens shtimeoutm fadetimeoutm bug summari file out_analyz debug pdf loca col descript uniniti object local path bug chrome_pdf pageind fade_out_timer_id_ annot sourc code copyright chromium author right reserv sourc code govern bsd style licens licens file includ pdf base string draw_ut numb includ pdf namespac chrome_pdf pageind pageind current_page_ out_timer_id_ splash_timeout_ kpageindicatorsp ashtimeoutm fade_timeout_ kpageindicatorscrollfadetimeoutm always_visible_ fals pageind pageind pars bug report write queri llvm pass header file recompil llvm pass select llvm analysi target run llvm bugr portanalyz pass candid llchain chrome_pdf pageind ontimerfir unsign int chrome_pdf instanc oncontroltimerfir int unsign int const unsign int program bug report sourc level bug report uniniti object field buffer rect fals draw buffer point origin rect rect alphablend buffer draw_rc image_data origin transpar void pageind ontimerfir timer_id fadingcontrol ontimerfir timer_id timer_id fade_out_timer_id_ fade fals fade_timeout_ fig lang bug report chromium bug fals posit broad encount kind fals posit imprecis data flow analysi imprecis control flow analysi paragraph describ exampl kind fals posit data flow imprecis analys flag garbag read lack sophist alia analysi instanc initi object pass refer miss list code snippet borrow fire fox codebas illustr categori fals posit altsvcmap object construct list class member mhttps pass refer calle function schemeishttp calle function schemeishttp initi mhttps alia outishttp garbag read checker miss alias store incorrect flag class member mhttps candid bug garbag read pass taint function store mhttps store mhttps alia pass miss store output legitim control flow sequenc bug report control flow imprecis analyz miss control flow format indirect call site virtual function invoc class codebas build time analysi time bug report sax wpax tax wpavgt total true posit chromium firefox mysql term wpavg normal nativ compil time tabl lang analysi summari larg open sourc project true posi tive mysql left await confirm develop member initi call sequenc compris indirect func tion call regist garbag read pass resolv indirect call site larg program imposs employ best effort devir tualiz techniqu rapid type analysi improv control flow precis altsvcmap altsvcmap fail schemeishttp originschem mhttps void altsvcmap getconnectioninfo object stack setinsecureschem mhttps static nsresult schemeishttp const nsacstr originschem bool outishttp outishttp liter cstring https list code snippet involv alias definit caus fals posit lang column tabl summari bug port chromium firefox mysql project stage anali sis complet find stage analysi pipelin effect filter hand bug report merit attent instanc analys output twelv bug report chromium codebas span line code true posit rate low case studi corner case point notwithstand confirm bug flag encourag chromium firefox mysql fraction total analysi time sax wpax fig codebas sourc program analysi time fraction total analysi time evalu lang well test product code fact point three confirm defect chromium firefox codebas promis result plan tool product readi incorporat ing insight gain case studi discuss analysi time analysi time complet analysi chromium firefox mysql codebas million line code hour mysql chromium analyz hour hour tabl summar time case studi present analysi time codebas relat normal build time instanc normal analysi time codebas indic time analyz codebas longer build time normal time denot subscript normal sourc analysi time analysi time total analysi time lang denot sax wpax tax term wpavgt denot averag time normal analyz analyz singl candid bug report figur sourc analysi time codebas fraction percentag term total analysi time modular build system local sourc defect small size librari averag size program analyz chromium lower compar mysql firefox consequ analysi time firefox mysql high foremost prioriti prototyp lang function effect implement leav room optim will help bring analysi time limit approach limit design lang requir analysi procedur code abstract defect type depend programm written analysi routin scale multipl defect type actual lend credenc approach analysi infrastructur requir carri extend analys well document assist prototyp lang cwes second complex analysi routin time lower program analysi analysi procedur span line code total largest analysi target chromium line code lang precis diagnost secur bug discov ere manual valid bug report requir softwar routin undergo manual review develop tool intro duce addit requir diagnost bring attent problemat corner case sourc code manual valid process bug report streamlin subsum tool exist softwar develop process night build continu integr implement limit analysi path context insen sitiv program analyz imprecis prone issu fals warn counter imprecis augment ana lyzer addit analys power alia analysi gressiv devirtu algorithm will help prune fals posit approach counter exist imprecis employ rank mechan bug report rank work program analysi garner attent late lint program checker develop bell lab program analysi tool develop primari goal check portabl style effici program demand program checker grown program paradigm invent program increas complex contribut develop commerci close sourc free open sourc tool broad tool base model check theorem prove static program analysi dynam analysi hybrid system aeg paragraph comment work close spirit lang program instrument tradit memori access bug fuzz test fuzz instrument program instrument take care track state program memori add time check memori access instrument time valgrind compil time addresssanit asan compil time instrument prefer poor perform tool employ time instrument sanit tool asan memorysanit msan pect fals posit rate practic difficulti uninstru ment code extern librari lead fals posit practic time tool elimin manual valid bug report guarante absenc uniniti memori msan monitor eri load store memori philosophi pose problem uninstru code pre compil librari stan dard librari program will invari lead fals program crash fals crash rectifi instrument code crash tool suppress warn sanit tool render unus msan imping instrument code direct indirect execut pro gram mainten blacklist file record fals posit msan access librari sourc code lower analysi accuraci imped analysi lang will benefit mechan suppress fals posit dynam tool invalu vulner assess tool complement well symbol execut symbol execut find bug program generat test case improv code coverag klee clang aeg flavor forward symbol execut program symbol execut constraint program path path predic maintain satisfi queri path predic prune infeas program path klee aeg symbol execut clang local henc scale larg codebas anecdot evid suggest klee aeg scale larg program best knowledg klee evalu medium size codebas larg codebas firefox chromium static analysi parfait employ analysi strategi spirit employ multipl stage analysi success stage precis preced stage parfait find buffer overflow program contrast evalu lang mul tipl vulner class effect detect multipl cwes valid general design addit lang fare well multipl code paradigm legaci program modern object orient code yamaguchi goal empow develop find mul tipl instanc defect approach yamaguchi structur trait ast represent drive machin learn phase phase extrapol trait vulner codebas obtain match struc ture vulner cqual cqual flow insensit data flow analysi framework languag oink form program data flow analysi elsa parser cqual data flow analysi base type qualifi approach advantag cqual product compil pars code better success rate pars advanc code cus tom parser elsa second sourc level analysi flow path sensit cqual final clang static analyz borrow idea public clude limit inter procedur context sensit analysi clang base graph reachabl algorithm propos rep clang spirit metal xgcc conclus develop lang static analysi tool help secur critic defect open sourc softwar tool premis intuit vul nerabl search necessit multi prong analysi anchor lang clang llvm compil toolchain leverag sourc analysi build corpus defect program analysi filter corpus approach capabl identifi defect vulner open sourc project largest chromium span line code demonstr analys viabl empir evalu time instanc lang easi deploy exist softwar develop environ ment programm receiv earli feedback code write fur thermor analysi framework extens compil plug abl programm lang implement domain specif secur check lang complement tradit softwar test tool fuzzer ultim aim propos system help vulner open sourc softwar earli stage acknowledg work support grant project nemesi project enzevalo project devil author colleagu sect daniel defreez valuabl feedback draft paper jani danisevski discuss standard occasion code review refer bugzilla mozilla bug https chromium issu tracker issu https chromium issu detail chromium issu tracker issu https chromium issu detail clang static analyz http clang access cover http havoc http project havoc php bug bounti program https php php bug https php bug https php bug https report type confus vulner soapclient https hackeron report scan build http clang scan llvm compil infrastructur http wllvm program llvm https travitch program llvm avgerino cha hao brumley aeg automat exploit gen erat ndss bacon sweeney fast static analysi virtual function call proceed acm sigplan confer object orient program ming system languag applic oopsla acm york usa http ball rajamani lam project debug system softwar static analysi acm sigplan notic acm cadar dunbar engler klee unassist automat generat high coverag test complex system program osdi cifuent scholz parfait design scalabl bug checker proceed workshop static analysi acm dean grove chamber optim object orient program static class hierarchi analysi ecoop object orient program european confer arhus denmark august springer engler chelf chou hallem check system rule system specif programm written compil extens proceed con ferenc symposium oper system design implement volum usenix associ foster johnson kodum terauchi shankar talwar wagner aiken elsman harrelson cqual tool type qualifi https jfoster cqual access grammatech codesonar http codesonar hallem chelf xie engler system languag build system specif static analys proceed acm sigplan con ferenc program languag design implement pldi acm york usa http heelan vulner detect system cyborg robot secur pri vaci ieee henzing jhala majumdar sutr softwar verif blast model check softwar springer hewlett packard fortifi static code analyz http softwar solut static code analysi sast howard lipner secur develop lifecycl media incor porat johnson lint program checker bell telephon laboratori knoop steffen effici optim bit vector data flow analys uniform interprocedur framework inst informatik und praktisch mathematik kremenek engler rank statist analysi counter pact static analysi approxim proceed intern confer static analysi sas springer verlag berlin hei delberg http lattner adv llvm compil framework lifelong program anal ysis transform code generat optim cgo intern symposium ieee lee song kim lee type cast verif ping emerg attack vector usenix secur sympo sium usenix secur usenix associ wash ton aug https confer technic session present lee nethercot seward valgrind framework heavyweight dynam binari instrument acm sigplan notic acm nist samat softwar assur metric tool evalu http nist test suit softwar assur refer dataset http gov srd rep horwitz sagiv precis interprocedur dataflow analysi graph reachabl proceed acm sigplan sigact sympo sium principl program languag acm schwartz avgerino brumley want dynam taint analysi forward symbol execut afraid secur privaci ieee symposium ieee serebryani bruen potapenko vyukov addresssanit fast address saniti checker proceed usenix confer annual technic confer usenix atc usenix associ berk ley usa http stepanov serebryani memorysanit fast detector uniniti mem ori code generat optim cgo ieee acm intern symposium ieee tsipenyuk chess mcgraw pernici kingdom taxonomi softwar secur error secur privaci ieee viega bloch kohno mcgraw static vulner scanner code comput secur applic acsac annual confer dec wilkerson daniel cqual https daniel oink access yamaguchi lottmann rieck general vulner extrapol abstract syntax tree proceed annual comput secur applic confer acm 