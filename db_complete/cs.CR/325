propos architectur network forens system larg scale network tala elham hossein secur technolog group iran telecommun center tehran iran tafazoli gharae secur system group iran telecommun center tehran iran e_salahi abstract cybercrim increas faster pace billion dollar busi loss investig attack commit utmost main concern network manag network forens process collect identifi extract analyz data systemat monitor traffic network main requir detect track crimin paper propos architectur network forens system propos architectur consist main compon collect index databas manag analysi compon soc communic compon databas main differ propos architectur system analysi compon compon compos part analysi investig subsystem report subsystem alert visual subsystem malwar analysi subsystem differenti factor propos system exist system cluster rank malwar dynam analysi malwar collect analysi network flow anomal behaviour analysi keyword network forens forens system architectur forens analysi system databas manag introduct continu technolog cyber attack occur rapid malwar spread globe consider countermeasur develop protect react cyber attack cyber crime despit reactiv prevent secur measur protect network forens investig critic infrastructur secur oper centr soc store secur alert produc network secur applianc store partial network traffic hand network forens system store network traffic digit forens process investig depend store secur oper centr soc communic channel network applianc raw traffic store forens system applianc need perform forens process communic channel help investig answer question forens commit crime digit forens process cyber attack cyber crime investig intellig task perform investig investig innov intellig observ attack crime evid investig intellig extract traffic alert store secur applianc analys evid investig accept reject hypothesi paper architectur network forens solut cover weak current commerci product framework commerci product solut establish analysi capabl session reconstruct signatur analysi statist analysi search method reason speed storag capabl support traffic framework focus aspect network forens distribut storag search evid soft comput base method forens analysi key compon architectur bring advanc capabl unlimit scalabl bear network traffic monitor analysi problem anomal behaviour analysi onlin execut filter onlin process cluster analysi execut propos architectur purpos paper uniqu network forens tool will allow network forens examin particip effect analysi network crime base investig network forens tool network forens examin enhanc success solv case attribut accur time analysi captur network traffic crime analysi investig intellig purpos chapter organ network forens architectur framework present chapter propos architectur network forens system larg scale network telecommun infrastructur network present chapter compar propos architectur exist network forens system chapter exist framework architectur format rule strict doc document templat paper prepar microsoft word paper conform requir publish confer proceed organ network requir specif architectur forens system depend characterist goal framework architectur network forens system introduc framework classifi distribut system framework dynam network framework soft comput base framework graph base framework investig exampl framework class detail fornet distribut network forens framework shanmugasundaram introduc fornet distribut network log mechan wide area network system develop digit forens purpos framework compos compon synapp forens server synapp integr network devic switch router summar rememb network event time interv verifi event confid level singl synapp provid forens analyst network oper applianc bring power possibl type infer combin synapp network synapp help share data storag answer queri accur synapp organ peer peer architectur collabor absenc central control hierarch architectur simpler work better structur internet hierarch architectur synapp domain form network associ forens server domain fact forens server central administr control domain manag group synapp domain forens server receiv queri domain process help synapp pass sender authent certif network synapp form level hierarchi fornet hierarch architectur forens server network inter domain collabor form second level hierarchi queri cross domain boundari appropri forens server forens server gateway queri domain domain boundari queri domain forens server domain authent server pass appropri synapp domain likewis synapp process forens server control domain certifi practic queri leaf node branch hierarchi travers forens server higher level leaf node branch queri travel opposit direct attack crime wang propos dynam network forens model base artifici resist theori multi agent theori system present moment method collect store log data simultan system capabl collect evid automat respond network crime rapid agent theori method design analys implement open system group agent solv problem handl agent agent role protect white cell human bodi agent base secur system flexibl human bodi immun system dynam forens network larg scale network store digit data distribut secur manner attack happen soft comput approach network forens system deal analyz collect data classifi attack neural network fuzzi tool verifi occurr attack zhang propos network forens system base neural network featur extract ann pca store analyz larg amount pose challeng network forens expert ann pca correl featur attack reduc amount store data ann pca techniqu fraud detect featur extract signatur generat attack faar algorithm classifi search relat rule comput pca valu featur extract ann pca increas classif accuraci decreas data storag amount wang daniel propos graph base approach network forens analysi descript main compon work evid collect modul collect digit evid heterogen sensor network host evid preprocess modul transform collect evid standard format reduc redund raw evid attack knowledg base knowledg attack phase target vulner asset knowledg base knowledg network host investig includ network topolog system configur entiti evid graph manipul modul generat evid graph retriev preprocess evid depositori hypothes band instanti evid graph graph edit oper attack reason modul perform semi autom reason base evid graph hierarch reason process local reason provid instant updat evid graph review network forens system netwit compani offer modular hardwar softwar network forens solut consid modular scalabl architectur netwit product small size compani organ larg multin enterpris datacentr isp netwit architectur consist subsystem network traffic collect subsystem data process subsystem data synchron subsystem index subsystem analysi subsystem silk open sourc analysi softwar consist set command tool process flow record collect silk pack system silk tool read process flow record gather binari format segment sort analysi analysi capabl silk includ filter display sort count classifi process store statist label base port number address silent runner tool collect visual data analysi capabl tool correl network traffic log alert file analysi content pattern analysi request secur incid tool simpl flexibl architectur silent runner monitor analyz network applic layer data propos architectur propos network forens system architectur larg scale network present figur main compon system network traffic collect index subsystem databas manag subsystem analysi subsystem soc communic databas compon describ subsect figur propos architectur network forens system network traffic collect index subsystem raw traffic databas soc commun secur incid manag data mana event resourc extern seim analysi investigatio sys report alert visualizatio sys malwar analysi sys raw traffic collect index subsystem databas manag analysi sys traffic collect refer set oper receiv traffic network interfac import data extern file databas appli filter store traffic system databas phase index provid quick access requir data mass data index method perform defin system speed paramet receiv store phase analysi phase index paramet implic network forens system speed collect analysi subsystem implement index compon depend file system macro architectur traffic collect index subsystem figur describ subsect figur macro architectur traffic collect index subsystem network traffic collect traffic data collect technolog span mirror port indic abil copi traffic port singl port second rap devic monitor traffic flow point network method advantag disadvantag forens system proper analysi consider expect level advantag disadvantag span port lower cost lower reliabl compar tap devic router send receiv packet inconsist crc span port disadvantag span port possibl bandwidth overflow port packet loss reason traffic port transmit singl port span port tap devic send copi packet transmit input network separ line bandwidth origin current soc system data transmit intrus detect system tap devic imag traffic store forens system polici data collect determin index traffic pass filter app layer filter creat applic layer rule decis make reconstruct session traffic session reconstruct applic layer extract network layer filter creat network rule determin futur packet pars rrrrs session reconstructio raw traffic index process databas compani system forens system capabl import network traffic data network packet file system compat network traffic file type network filter network layer filter separ packet session reconstruct type filter packet classifi base header header three tcp layer network internet transport layer separ traffic session reconstruct header traffic filter tabl tabl protocol stack layer characterist filter protocol tcp layer address destin sourc type ethernet network interfac address destin sourc protocol internet layer sourc port destin port tcp transport layer udp parser parser program receiv continu string symbol pars defin unit parser main compon compil program languag articl parser scan reconstruct session search characterist string exampl parser specif mail standard protocol scan mail session parser scan session find sourc account content parser memori applic layer filter applic layer filter session reconstruct extract applic characterist rule traffic filter base applic layer characterist develop filter layer lower layer traffic filter perform base applic layer rule exampl rule defin store header ssl packet payload goal network applic layer filter limit input output traffic storag filter network applic layer system admin choos action perform packet consid rule futur packet determin base rule appli exampl action packet session reconstruct packet store network metadata process data mine action rule exist system network traffic collect index subsystem resid isol hardwar network endpoint receiv copi traffic mirror port input scalabl distribut basic requir collect subsystem system receiv network traffic multipl point network simultan exampl suppos network traffic receiv ethernet port ethernet port case three traffic collect subsystem instal network separ metadata collect collect subsystem integr store system index phase indic generat network traffic speed databas access figur indic provid quick access data index perform determin speed system collect analysi phase analysi system analysi system analyz store data databas consist three part analysi investig system report alert visual system malwar analysi system analysi investig subsystem system analysi capabl raw traffic store databas analysi system base count count packet session metadata generat system consist part sourc address destin address list analysi investig system capabl focus metadata metadata session metadata investig close exampl queri metadata session sourc address servic tcp http session size queri event reconstruct session network analys perform layer analysi way session analysi path content analysi find sourc extern threat map address geograph locat store data session display data user web voic email chat file search analyz content session mac keyword usernam abil defin parser alert abil defin custom oper output unit alert sourc destin address sourc destin port number address titl email content session graph display server program servic type http ssl dns site attach file type usernam reconstruct session protocol restor content web email content decrypt decompress content analysi method provid unit tempor analysi storag display session oper chronolog order limit investig rang time packet level analysi display number packet metadata session level analysi display number session metadata file content analysi type origin metadata system provid capabl perform analys tempor analysi display start time time incid creat incid time axi display incid durat exampl display fast malwar spread life time incid incid sourc analysi sourc attack determin incid destin analysi destin target attack determin relat analysi relat attack sourc relat culprit victim determin report alert visual subsystem subsystem connect databas subsystem graphic represent volum traffic protocol creat file content exchang protocol extract display visual unit subsystem store databas investig onlin report creat malwar analysi system system architectur figur consist main unit file signatur control unit network anomal behaviour detect unit automat sandbox domain knowledg unit unit describ figur malwar analysi system compon file signatur control unit malwar file signatur creat unit compar signatur execut transmit network network anomal behaviour detect unit unit respect network traffic characterist network bandwidth server capac threshold determin detect anomal behaviour network behaviour profil creat traffic analyz onlin real time network behaviour perspect method network behaviour pattern time period consid network normal behaviour network normal pattern time measur base method network risk area address method cover analys address system domain knowledg unit unit latest malwar signatur receiv compani insid compani autom malwar analysi unit execut file transmit network extract unknown execut sampl sandbox control environ behaviour log malwar behaviour profil extract record log network trace registri chang access file profil purpos identif seizur malwar transmit malwar analysi unit network anomal behaviour detect unit file signatur control unit domain knowledg unit automat sandbox unit network main applic compos main unit preprocess filter automat sandbox figur scheme unit autom malwar cluster analysi benefit execut analyz rapid determin belong unknown famili malwar belong famili dynam analysi fewer sampl analyz sandbox sandbox platform capabl onlin analysi malwar sampl figur scheme automat malwar analysi unit main respons unit will explain sequenti preprocess filter unit purpos unit princip focus extract execut code reduc count separ unknown sampl approach achiev goal explain approach approach figur figur scheme execut code preprocess filter unit explain unit scheme featur extract static featur sampl extract execut code extract code featur file structur antivirus analysi code cluster predict behaviour profil static featur code input unit attempt predict behaviour cluster sampl supervis learn approach cluster score phase score assign sampl investig dissimilar sampl cluster high score sampl pass dynam analysi phase malwar execut preprocess filter automat sandbox select sampl cluster probabl dynam analysi cluster score cluster predict featur extract static characterist behaviour cluster behaviour featur dynam analysi select execut sampl execut sandbox network level host level behaviour observ execut condens set behaviour featur set featur fed cluster rank phase cluster malwar sampl base malici behaviour featur behaviour cluster sampl belong fed cluster predict phase high score sampl preprocess phase fed input dynam analysi phase behaviour characterist malwar sampl output sandbox characterist store behaviour profil profil express object function databas manag secur oper center respons receiv network secur event secur tool correl analyz connect secur oper center occur data manag general view connect secur oper center figur network forens system search pattern request secur oper center appropri respons receiv databas manag system accept time figur communic secur oper center api soc analysi system covert data structur transmit unit databas manag unit combin raw traffic alert transmit secur oper center consid telecommun infrastructur polici forens system author access search alert databas correl log direct search perform proper speed databas method store traffic metadata method cluster storag storag raw traffic metadata aggreg store server farm advantag technolog includ integr traffic store network secur unit reduc setup mainten cost increas system secur contrast implement complex system implement detail disadvantag cluster storag subsystem comparison method propos method tabl aspect compon netwit silk solent runner system compar propos architectur strength weak architectur comparison product conclus main purpos forens system help investig identifi crimin crime sign strength network forens system depend abil process network traffic speed proport data transmiss analysi paper propos architectur forens system secur oper center compos unit data collect index databas manag system analysi system propos architectur maximum exist potenti optim design system effici compar exist framework propos architectur bring advanc capabl dynam malwar analysi cluster analysi network behaviour analysi tabl propos architectur compar exist system rop ose rchitectu silent silk etw itn ess extg data traffic collect characterist traffic support wireless network snif capabl voip call record cdr analysi capabl session restor network behaviour analysi statist analysi anomal behaviour analysi malwar onlin detect onlin dynam code analysi malwar cluster execut code filter execut code filter process accept search speed raw traffic protocol restor protocol network flow base analysi raw traffic index ssl https key exchang proxi alert notif system architectur characterist scalabl distribut capabl develop capabl devic capabl remot search capabl open sourc product capabilit refer emmanuel pilli joshi rajdeep niyogi network forens framework survey challeng digit investig shanmugasundaram memon savant bronnimann fornet distribut forens network proceed second intern workshop mathemat method model architectur comput network secur mmmacn lncs springer wang daniel graph base approach network forens analysi acm transact system secur tissec oct terrenc lillard clint garrison craig schiller jame steel digit forens network internet cloud comput forens evid guid move target data cheri cheung jue wang data partit index network forens analysi geambasu bragin jung balazinska demand view materi index network forens analysi proceed netdb april http matthia paolo milani gregoir christoph kruegel forecast skim malwar cream proceed annual comput secur applic confer acsac decemb bayer milani comparetti kruegel kirda scalabl behaviour base malwar cluster network distribut system secur ndss jacob neugschwandtn milani comparetti kruegel vigna static packer agnost filter detect malwar sampl technic report santa barbara anubi http norman sandbox http sartori scala partial index nonuniform data distribut relat ieee transact knowledg data engin stonebrak store column orient dbms proceed vldb lukasz golab theodor johnson spencer seidel vladislav shkapenyyuk stream wareh data depot sigmod york gibson cost effect high bandwidth storag architectur architectur support program languag oper system publish sigplan notic novemb tala tafazzoli receiv degre comput engin sharif univers technolog receiv degre comput engin amirkabir univers technolog faculti member network secur group iran telecom center interest area includ digit forens intrus detect system network secur elham salahi bsc degre comput scienc sharif univers msc degre appli mathemat minor comput scienc iran univers scienc technolog year experi work research itrc interest digit forens imag watermark intrus detect system network secur hossein gharae receiv degre electr engin khaje nasir toosi univers degre electr engin tarbiat modar univers tehran iran depart network technolog iran telecom center itrc interest includ general area vlsi emphasi basic logic circuit low voltag low power applic dsp algorithm crypto chip intrus detect prevent system 