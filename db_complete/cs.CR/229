secur toolbox detect novel sophist android malwar benjamin holland tom deer suresh kothari depart electr comput engin iowa state univers ame iowa email bholland tdeer kothari jon mathew nikhil ranad ensoft corp email jmathew nikhil abstract paper present demo secur toolbox detect novel malwar android app toolbox develop project fund darpa autom program analysi cybersecur apac project adversari challeng red team darpa apac program task design sophist malwar test bound malwar detect technolog develop develop blue team group blue team darpa apac program propos human loop program analysi approach detect malwar sourc java bytecod android app malwar detect apparatus consist compon general purpos program analysi platform call atlas secur toolbox built atlas platform paper describ major design goal toolbox compon achiev goal workflow audit android app accompani video illustr featur toolbox live audit video http introduct search novel malwar needl haystack know needl learn stuxnet target nation state level attack iranian nuclear site attack detect specul intent began util noisi tradit attack vector usb malwar propag prolifer high level logic bug ssl discov year logic bug bash shell agre bug honest mistak specul malici intent determin intent examin code secur analyst consid softwar bug potenti malic case consequ catastroph stake high current practic malwar detect adequ darpa apac program aim creat techniqu tool detect sophist android malwar capabl caus serious damag depart defens scenario materi base sponsor darpa agreement number govern author reproduc distribut reprint government purpos notwithstand copi notat thereon usaf colonel john boyd describ ooda loop iter decis cycl observ orient decid boyd develop framework explain unan ticip superior agil fighter pilot aerial combat situat paradigm ooda loop appli equal well apac context detect malwar tool outmaneuv capabl adversari will continu develop varieti android malwar secur toolbox android design util best class autom iter techniqu maxim odd emerg victori confront complet phase darpa apac program top perform blue team design goal minim human effort goal minim human effort cross verifi automat detect malwar perform periment hypothes refin postul applic specif malwar radar autom malwar detect incorpor queri model refin qmr program analysi platform call atlas develop ensoft tool mechan human loop detect malwar heterogen attribut direct graph data structur abstract repres essenti aspect syntax semant structur control flow data flow requir reason softwar atlas construct graph set softwar project provid user atlas offer express queri languag user write compos analyz analyz comput form subgraph relev queri evid visual base evid user issu queri involv specif program artifact specif url iter continu user satisfi analysi secur toolbox includ analyz atlas queri languag analyz incorpor android semant invok programmat interact smart view describ incorpor android semant goal incorpor rich complex semant android facilit develop mobil app address semant android secur toolbox incorpor permiss map android api permiss api requir toolbox incorpor semant fundament android compon activ servic content provid broadcast well android specif xml develop algorithm automat sum mariz android api work progress complet will incorpor summari toolbox portabl format evolut user friend design goal develop detect tool evolut friend high usabl decoupl architectur achiev goal malwar detect capabl decoupl built top program analysi platform atlas under design philosophi platform matlab mathematica domain specif toolbox built top general purpos machineri low level static analysi resid insid atlas malwar detect capabl resid insid tool box analyz atlas queri refin extend exist detect capabl well creat entir capabl easi queri enabl analyz creat complet list malwar properti unrealist imper simpl expand cookbook readi properti adversari think iii case secur toolbox toolbox android malwar detect task three main case describ autom detect android malwar clear defin specif product evid support conclus auto mate analysi enabl human perform experi hypothes detect malwar detect automat pattern specif priori compon secur toolbox logic separ compon detail guid compon guid topic resourc provid resourc html permiss map sensit function send receiv text messag access geo locat access user contact protect runtim check enforc applic grant mission invok function secur toolbox leverag permiss map produc toronto pscout group api version android transform pscout map xml file precis repres permiss protect method toolbox code pars manifest xml file automat annot correct api map atlas program graph auto matic scrape encod java object googl develop document permiss permiss group protect level aid develop analyz addi tional recov map android permiss protect level permiss permiss group mine relationship android index atlas program graph informa tion need analyz program conserv estim exampl type infer dynam dispatch edg conserv resolv potenti target address problem secur toolbox implement rapid type analysi rta strategi exclud call edg method runtim base observ constructor call type infer index perform rta analysi annot edg program graph analyz android extens xml user inter face manifest resourc program artifact miss java program graph produc atlas secur toolbox index annot add miss program element resourc atlas program graph analyz secur toolbox defin analyz interfac encapsul logic travers program graph extract envelop subgraph empti secur properti satisfi empti locat violat secur properti analyz encapsul descript assumpt continu refin broaden travers exampl continu data flow base taint analysi sensit sourc sensit sink produc graph larg interpret perform taint analysi call object type flow sensit enabl analyz subdivid properti smell confidenti integr avail analyz properti analyst awar indic malic ensoftcorp android essenti toolbox declaresedg retainedg calledg retainedg overridesedg edg overrid retainedg abortbroadcast methodselect broadcastreceiv abortbroadcast union methodselect pendingresult abortbroadcast abortbroadcast overridesedg revers abortbroadcast onrec methodselect broadcastreceiv onrec onrec onrec highprioritytyp highpriorityonrec highprioritytyp highprioritybroadcastblock highpriorityonrec abortbroadcast list analyz queri find high prioriti broadcast blocker nativ code smell heurist properti indic stronger suspicion demand justif java reflect invok privat api confidenti integr avail cia analyz tect violat cia properti taint analysi sourc sink modif oper sensit mutabl loop detect expens resourc list queri analyz detect high prioriti broadcast blocker inter cept block sms messag android devic line select declar call overrid subgraph select abortbroadcast method includ overridden method select broadcastreciev onrec method includ overridden method select class regist high prioriti android manifest select high prioriti onrec method select call graph edg high prioriti onrec method abortbroadcast method dashboard dashboard figur interfac tomat execut manag autom analyz dashboard account analyz depend enabl highest amount parallel putat run multitud analyz comput present analyst work item queue dashboard filter categori mark review option analyst addit note work item work item correspond subgraph program graph name color help identifi separ program subsystem program artifact manual remov work item base color program artifact smart view smart view develop observ graph travers queri analyst audit forward revers control figur secur toolbox dashboard interfac figur smart view show revers data flow android xml resourc select field data flow discov declar structur instanti object speed task graph queri automat generat respons mous select event relev sourc code exist graph compon smart view custom android specif analysi task show user interfac xml button event callback figur custom smart view show revers data flow program slice includ program artifact android xml resourc graph generat user click destin field sourc window inspect workflow workflow audit comprehens driven model iter observ orient decid ooda decis loop audit start run dashboard produc evid human analyst inspect help analyst observ program behavior orient context applic aid analyst priorit exploratori hypothes discov malic aid test hypothesi smart view follow control data flow perform target analysi symbol analysi android intent resolut match except throw catch site confirm hypothesi discoveri malwar hypothes explor process anew hypothesi set deplet audit halt audit remain applic repriorit final discoveri malwar secur toolbox adapt write analyz rais bar futur autom analysi evalu phase darpa apac project team audit android applic develop red team contain novel malwar evad current automat detect techniqu darpa employ control team current state art tool audit app side blue team perform process correct classifi app malici benign unintend malici behaviour app miss malwar app consist beat control team complet phase top perform blue team vii work number tool techniqu develop detect malwar android app includ base static analysi base dynam analysi autom detect method fall general categori signatur base machin learn base signatur base approach easili evad bytecod level transform attack learn base approach extract featur applic syntax program semant subject evas berkeley mine map android permiss correspond permiss pro tect api dynam analysi approach random call api toronto improv incomplet map quicker involv static analysi approach mine complet public privat api map android sourc code toolbox incorpor toronto map viii conclus novel human loop approach detect android mal ware minim human effort allow human evid produc machin focus effort machin assist reason afford greater opportun detect malwar radar autom analyz experiment capabl provid machin enabl user posit attack intent hypothes modus operandi tailor queri detect sophist malwar approach increas autom reduc human effort error valuabl machin assist detect novel sophist malwar demo paper describ secur toolbox plement novel approach accompani video live audit bring featur toolbox includ dashboard manag autom ana lyzer permiss usag view list permiss app smart view facilit experi acknowledg valuabl feedback review paper compon secur toolbox open sourc mit licens https ensoftcorp refer langner kill centrifug langner group http content upload kill tech rep nov cve onlin https cgi bin cve cve onlin https cgi bin cve cve onlin https cgi bin cve heartble conspiraci theori onlin http openssl heartble crimin govern conspiraci theori deer kothari sauceda mathew atlas explor softwar build analysi tool companion proceed intern confer softwar engin ser ics companion york usa acm atlas video demo onlin https watch czowlj zhou huang lie pscout analyz android permiss specif proceed acm confer comput communic secur ser ccs york usa acm onlin http bacon sweeney fast static analysi virtual function call proceed acm sigplan confer object orient program system languag applic ser oopsla york usa acm onlin http fuch chaudhuri foster scandroid autom curiti certif android applic depart comput scienc univers maryland colleg park tech rep payet spoto static analysi android program softwar technolog mao wei lee droidmat android malwar detect manifest api call trace secur asia jcis seventh asia joint confer ieee zhou jiang dissect android malwar character evolut ieee fedler schutt kulick effect malwar protect android fraunhof aisec tech rep aafer yin droidapimin mine api level featur robust malwar detect android proc intern confer secur privaci communic network curecomm enck gilbert chun cox jung mcdaniel sheth taintdroid flow track system realtim privaci monitor smartphon osdi reina fattori cavallaro system call centric analysi stimul techniqu automat reconstruct android malwar behavior proceed european workshop system secur eurosec pragu czech republ april felt chin hanna song wagner android permiss demystifi proceed acm confer comput communic secur ser ccs york usa acm onlin http 