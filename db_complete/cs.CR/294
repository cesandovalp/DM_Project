univers anomali detect algorithm applic shachar siboni asaf cohen member ieee abstract modern comput threat complic constant evolv alter appear perpetu chang disguis circumst detect threat fortiori day attack requir tool captur essenc behavior fix signatur work propos novel univers anomali detect algorithm learn normal behavior system alert abnorm prior knowledg system model knowledg characterist attack suggest method util lempel ziv univers compress algorithm order optim probabl assign normal behavior learn estim likelihood data oper classifi suggest techniqu generic appli dif ferent scenario appli key problem comput secur detect botnet command control channel botnet logic network compromis machin remot control attack infrastructur order perform malici activ deriv detect algorithm base time data collect deep inspect open well encrypt flow evalu algorithm real network trace show univers low complex identif system built high detect rate low fals alarm probabl applic includ malici tool detect system call monitor data leakag identif term comput secur anomali detect univ sal compress probabl assign individu sequenc botnet command control channel malici tool data leakag introduct cyber attack disturb secur threat exist ing today communic comput base sys tem affect wide rang domain includ elec triciti water infrastructur financi capit market medicin healthcar armi busi enterpris univers major massiv cyber attack today conduct botnet includ distribut denial servic ddos attack spam fraud iden titi theft botnet logic network compromis machin bot remot control botmast part work appear workshop forens secur wif atlanta siboni cohen depart communic system engin ben gurion univers beer sheva israel mail sibonish coasaf partial support isra chief scientist kabarnit consor tium command control infrastructur compro mise machin collect vulner host comput mobil phone tablet infect infect websit file share network email attach infect tree analysi host infect bot program channel download updat await instruct botmast updat data oper receiv command botmast launch ddos attack channel play key role botnet oper communic network botma ter manag control bot channel order perform malici activ select target bot distribut attack platform demand coordin botmast fact channel botmast communic bot consid weakest link botnet block render botnet useless main object identifi block activ real harm caus order mask activ bypass defens mecha nism firewal botnet common communic protocol includ irc http peer peer dns botnet adopt social network under tempt develop protocol specif method detect botnet attack constant improv infrastructur develop evas capabl includ chang signatur traffic employ encrypt obfusc domain generat order deceiv detect system current techniqu botnet studi detect base honeynet signatur base detect anomali detec tion model honeynet trap order collect bot studi behavior mechan monitor bot expos design design detect block mechan signatur base approach reli signatur databas notori botnet learn signatur base techniqu prone day attack requir constant updat signatur databas anomali base detect techniqu hand aim detect anomali network traffic system behaviour indic presenc malici activ basic assumpt anomali detect attack differ normal behavior traffic analysi packet flow level consid metric rate volum latenc respons time timestamp order identifi anomal data anomali detect promis approach botnet detect detect structur attack day attack cost high fals alarm rate achiev good perform requir prior knowledg statist assumpt normal data markov model arma model propos anomali base detect system botsniff botmin base traffic analysi design irc http base botnet design protocol independ tection requir prior knowledg system reli deep packet inspect techniqu suitabl fli analysi larg amount traffic assadhan suggest period behavior indi cate botnet activ tegel present detect system botfind consid high level statist featur communic extract botnet control environ limit abil detect type attack protocol specif system villamarn salomn brustoloni dns traffic chang daniel botnet topolog strayer correl packet size time pattern irc base botnet classif base point view pre sent classif scheme botcop decis tree statist model classifi type applic botcop appli payload signatur techniqu est mazzariello sanson employ support vector machin singl class classifi model construct statist model base train set order distinguish normal malici activ suggest system reli memoryless featur data specif valu signatur contrast build context tree learn data data sequenc test order valu event main impact classif perform contribut studi problem detect botnet channel novel univers anomali detect algorithm priori botnet traffic pattern normal behavior pattern effici learn normal behavior order generat statist model test traffic compar classif model base celebr lempel ziv algorithm optim univers pression algorithm prefer univers predict algorithm appli stationari ergod sourc finit alphabet probabl assign induc predict algorithm rigor defin statist model repres normal behavior offer mechan test unknown sequenc model offer data classif process offer context data sequenc key characterist classif evalu model real network trace time data main test featur allow protocol independ encrypt independ allow system immun hide techniqu low level featur data time size clear suggest model favor solut problem hand excel term low fals alarm high detect rate moder linear time complex deep packet inspect final note suggest scheme applic sequenc behavior time data test anomal applic behavior anomal communic pattern orga nizat short confer version work appear current paper includ algorithm applic addit explan discuss rest paper organ requir background materi iii describ key concept univers anomali detect key applic botnet identif main exampl test case real network trace addit applic real data discuss prevent strategi attack suggest system prove robust argu strategi requir huge amount data massiv learn final vii conclud paper preliminari classif refer problem label unknown instanc appropri class set predefin class under probabl distribut class decid generat sequenc decis rule form mpi optim sens minim probabl error unari class classifi cation type instanc goal identifi instanc case anomali detect identifi instanc fit learn anomal instanc exist learn instanc normal behavior build behavior model base normal instanc classifi instanc deviat model anomal probabl distribut normal data optim decis rule term maxim detect probabl fix fals alarm probabl neyman pearson sens compar threshold decid normal threshold anomal threshold determin requir fals alarm probabl practic der distribut generat normal sequenc cours unknown reason approach case estim observ sequenc estim note estim problem differ statist model markovian order knowledg sequenc stationari ergod sourc worst case data constitut individu sequenc determinist sequenc pre defin statist model paper anomali detect techniqu general case under statist model build relat predict discret sequenc lossless compress order univers compress algorithm associ probabl assign anomali detect procedur univers probabl assign lempel ziv algorithm univers compress algorithm vanish redund cons quentli optim univers predict algorithm appropri probabl assign algorithm varieti applic context classif typist identif base keyboard event english text music piec protein classif complet describ compress method associ probabl assign algorithm algorithm dictionari base compress method sequenc data symbol dictionari phrase pars sequenc construct base increment pars process dictionari empti step algorithm smallest prefix consecut data symbol exist dictionari pars dictionari phrase uniqu phrase dictionari extend phrase symbol sequenc pars phrase smallest prefix consecut data symbol consid suffix concaten symbol sequenc phrase dictionari dictionari collect dis tinct phrase pars data exampl sequenc aabdbbacbbda pars common represent dictionari root tree phrase dictionari repres path root intern node tree set symbol phrase consist addit leaf node suffix phrase tree statist model defin data sequenc construct phrase tree describ initi tree construct includ root node leaf node children size alphabet phrase pars sequenc tree travers start root set symbol phrase consist appropri leaf node leaf node reach tree extend point symbol alphabet children node leaf make intern node order defin statist model node tree root node maintain node travers counter leaf counter set intern counter equal sum counter probabl assign leaf node counter set assum uniform distribut probabl total number leaf node intern probabl defin sum probabl equal ratio counter current exampl figur demonstr statist model sequenc aabdbbacbbda node tree repres tupl symbol counter probabl addit probabl edg defin divid node probabl note probabl edg connect direct root equal appropri root counter divid total number leaf node step algorithm probabl phrase calcul multipli probabl edg path defin symbol note phrase exist specif node tree probabl repres probabl phrase instanc exampl figur consid sequenc travers leaf node reach symbol finish travers return root continu symbol sequenc consum exampl probabl sequenc bdca statist model defin travers probabl multipl root root calcul bdca maabdbbacbbda stem condit probabl symbol sequenc calcul ratio counter symbol counter symbol consid context time iii anomali detect univers probabl assign describ build block anomali detec tion system system describ context detect anomali network traffic problem domain data instanc discret sequenc network trace mention propos system generic easili adapt detect anomali discret sequenc event proper preprocess fact addit applic algorithm preprocess data sequenc defin seri event flow specif client specif host ith network event denot data transact fig statist model sequenc aabdbbacbbda client host defin tupl tti csbi scbi time event occur tti durat event csbi scbi total number byte client host host client network flow denot fxi seri network event client host sort time occurr fxi actual learn test requir featur field data experiment good detect capabl achiev focus singl featur exampl time data character differ consecut event flow denot time differ defin tdi perspect total time event denot time defin tti tti focus size client server byte csb server client byte scb defin csbi csbi scbi scbi consequ singl featur data sequenc serializa tion featur respect time differ sequenc flow defin fxi procedur result sequenc larg alphabet exampl time high precis reduc rang valu quantiz perform quantiz level set centroid centroid extract data train phase clear number centroid method extract affect experi real data fine tune easili train learn base classif model divid learn phase test phase illustr figur binari train sequenc predict algorithm sequenc probabl test sequenc centroid fig classif model base predict algorithm learn phase statist model built base train set discret quantiz sequenc finit alphabet mechan explain cours train normal benign traffic test phase test sequenc separ quantiz quantiz method set centroid extract learn phase probabl suspect sequenc test sequenc test set estim base construct statist model learn phase classifi respect predefin threshold probabl test sequenc estim sequenti probabl assign stati tical model built learn phase test sequenc greater equal classifi normal fit model lower threshold classifi anomal perform classifi measur fals alarm hit detect ratio fals posit rate fpr type error true posit rate tpr demonstr roc receiv oper characterist curv fals alarm ratio reflect number negat instanc incorrect classifi posit proport total number negat test hit detect ratio measur proport number posit instanc correct classifi total number posit test roc curv generat respect set threshold case rang minj maxj threshold defin specif confus matrix specif point graph note classif model updat extend exist statist model rebuild train data sequenc time appli perform lower threshold configur interv time momentari decreas botnet identif data set high level real network trace provid internet secur compani order maintain confidenti custom compani withheld data set consist client server transact time window hour specif day data set https rar client denot cid connect host web server denot transact data client host defin communic pair cid transact label legal denot good normal data traffic generat client illeg transact denot hostil bot label secur expert base well black list note label classif process valid phase tabl exemplifi structur data set note transact repres singl record data set consist field time refer time transact place time total time transact byte byte field repres total byte client server host server host client transact mime type denot internet content type transact plain text imag html applic cat categori transact good hostil cid field refer host internet site web server client protect ident custom indic arbitrari malici site identifi domain process data includ serial featur extract data set split set flow base cid connect illustr tabl respect flow mark gray flow sequenc transact communic pair cid sort time label good hostil total flow label good hostil flow indic imbal data set transact legal small fraction illeg characterist real network traffic behavior tabl exampl databas structur record data set repres data transact specif client specif host server time time byte byte mime type cat cid imag gif good text html good imag gif good imag gif good imag jpeg good imag jpeg good imag gif good imag gif good imag gif good imag gif good applic octet stream good applic octet stream good imag jpeg good imag jpeg good imag jpeg good imag jpeg good text html iso hostil imag jpeg good imag jpeg good text css good select featur extract transac tion time differ time server client byte client server byte quantiz quenc discret time finit alphabet sequenc learn test perform note flow singl client consist good flow reflect legitim data traffic generat client well hostil flow generat bot instal client contrast server host flow label host label infrastructur transact consid malici client host definit repres perspect data set hand examin event occur network client point view host point view will experi experi conduct dataset flow sequenc random select dataset client host perspect divid equal train test phase roc base newli data test singl featur achiev best system optim featur best term optim threshold roc auc area curv achiev time differ represent data sequenc uniform quantiz quantiz algorithm test better understand superior consid legitim web surfer compar hostil connect http channel surfer reason behavior time domain time requir read time requir server respond channel behav differ exampl reason respons time server collect data bot messag sole transmit space limit includ inferior featur focus uniform quantiz fals posit rate sit subseq hauc subseq hauc subseq hauc optim threshold anomali detect fals alarm fals posit rate sit subseq hauc subseq hauc subseq hauc optim threshold anomali detect fals alarm fig test major vote classif featur uniform quantiz method consid client type flow left receiv oper curv zoom upper left corner test sequenc partit set subsequ denot subseq graph decis set subsequ better achiev higher subsequ definit optim threshold detect fals alarm singl short sequenc test improv major vote sequenc flow data segment partit subsequ length classif base major subsequ estim posit negat better classif perform number subsequ higher exampl auc fals alarm rate achiev threshold illustr figur cost higher detect time data segment cours subsequ data segment decis subsequ delay client point view consid semisupervis train amin host point view differenti semisupervis negat consid normal data sequenc train semisupervis posit account anomali sequenc train unsupervis train set consist normal anomal sequenc well refer reader figur clear learn anomal behavior fail red curv auc sampl traffic differ bot system train key messag figur learn noisi data includ traffic normal degrad perform unsupervis train mode classifi achiev good despit fact under dataset train phase normal anomal sequenc semisupervis negat achiev best auc note unsupervis realist scenario priori train data final concret exampl examin flow uniform quantiz threshold fals posit rate sit unsupervis hauc semisupervis negat hauc semisupervis posit hauc optim threshold anomali detect fals alarm fig test train mode semisupervis negat semisupervis posit unsupervis mode featur uniform quantiza tion method respect host type flow classifi achiev best auc detect fals alarm semisupervis negat train mode worst auc fals alarm detect case semisupervis posit train mode test case flow classifi anomali client point view indic client infect bot program form host perspect impli host command control server examin three server list actual domain correspond host find confirm server server server address black list detect malici tool data leakag includ addit strengthen applic univers anomali detec tion suggest appli anomali detect system suggest system call order detect malici tool window machin tcp traffic server order detect unwant data leakag experi capabl tool detect abnorm behaviour prior knowledg demonstr monitor context system call anomal behaviour sequenc system call process serv identifi process behaviour resourc program exploit malici tool run sequenc system call differ compar normal behaviour incrimin program entir machin refer work univers anomali detect tool learn context normal system call alert anomal behaviour sequenc system call creat process record process learn view data process anomali detect algorithm compar process data learn model order decid process benign malici exploit tool larg amount system call call group type base natur call devic file memori process registri secur syn chroniz time differ data describ quantiz process includ minim distanc requir uniform probabl label call base function record classif nttrace learn phase system call record quantiz type discret sequenc alphabet size creat sequenc build normal behaviour tree describ histogram probabl tupl length calcul histogram data save learn phase learn phase includ hour data test segment minut record segment histogram calcul learn phase calcul probabl tupl length oven alphabet size work decis base kullback leibler diverg distanc normal histogram test figur plot distanc histogram learn phase histogram extract test phase process test vertic thick line mark time tool zeus activ clear context system call chang dramat tool activ simpl monitor distanc minut suffici detect chang system behaviour identifi data leakag work univers anomali detect algorithm order identifi data leakag tabl data leakag identif mse tabl iii data leakag identif addit download normal normal normal normal normal ncat web server set learn phase period day benign traffic web server record wireshark previous exampl time base sequenc extract quantiz order build tree tree serv model normal data ncat script instal server script initi download larg chunk data server period minut long traffic includ ncat record comparison length period traffic ncat record well tree built minut dataset identifi data leakag botnet set con sider case compar joint distribut tupl tree distribut tupl tree identifi data set calcul distanc distribut tabl includ tabl depict distanc learn normal data test period includ data leakag ncat distanc measur squar error mse distanc mse leakag session clear stand compar normal data distanc clear ncast session includ normal data second final challeng algorithm data leakag will stand normal commu nicat includ peac massiv download normal communic augment benign download size tabl iii depict distanc clear ncat stand compar normal traffic web server indistinguish normal traffic learn includ download larg file expect ncat protocol key differ time caus file size data leakag clear detect compar normal surf undistinguish server peac time serv larg download discuss discuss issu problem question discuss attack botmast order neutral solut complex time day fig distanc learn histogram normal behavior histogram creat minut test phase process function time gray vertic line mark time zeus activ infinit alphabet problem exist lempel ziv compress algorithm probabl assign mech anism approach problem attack rememb statist model construct lempel ziv algorithm base observ quenc generat legitim sourc client newli sequenc assign probabl base model sequenc probabl equal higher predefin threshold classifi normal classifi anomali attack build exact model suggest system order generat illeg sequenc disguis legitim matter attack access databas build statist model sensit case protect servic provid organ implement system larg amount legitim traffic record organ learn process strategi simul model prior knowledg under probabl distribut sourc generat data sequenc possibl precis quantifi probabl rigor defin under alphabet binari alphabet length sequenc assum legitim sequenc generat under probabl unknown attack generat sequenc probabl distribut base estim attack generat case attack trial error strategi will random generat sequenc probabl distribut question aris probabl accept sequenc generat answer question reli method type type sequenc defin relat proport occurr element probabl mass function exampl type type class denot set sequenc length type complet discuss notat probabl type class distribut order expon precis kullback leibler diverg measur act error expon compon matter consequ long attack estim probabl decay exponenti grow infin longer sequenc test phase attack chanc bypass neutral suggest solut estim attack approach consid attack manag legitim sequenc exist phrase tree generat cord simul monitor http legitim connect extract time differ session attack period send attack sequenc pattern sequenc method will fail repeat singl sequenc legitim deriv will creat stream distribut exampl consid case take short sequenc unbias coin toss generat clear sequenc will fail test compar unbias coin sophist approach generat sequenc base sequenc present basic idea legitim quenc consid train sequenc denot length sequenc string pure random bit independ object generat sequenc length shorter denot probabl distribut minimum statist depend sequenc generat sequenc generat sourc achiev goal determinist function independ unknown sourc employ minimum mutual requir order guarante weak depend train sequenc result output sequenc order faith repres characterist data input length larg number random bit need guarante low depend grow linear output length consid problem domain botmast generat sequenc model date bot channel sequenc order carri attack hand case botmast constant produc maintain random bit guarante low statist depend high complex mechan hand case botmast generat larg sequenc preserv characterist origin data difficult send sequenc exampl email attach note receiv sequenc channel bot will generat independ disqualifi complex legal sequenc generat bot oper simpl manner requir coordin attack vii conclus work propos generic univers anomali detect framework propos framework base univers compress probabl assign build model learn data prior knowledg model assumpt model detect anomal behavior alert case attack univers probabl assign tech niqu base algorithm sug gest model system requir prior knowledg normal behavior learn statist model optim sens converg true probabl assign sourc stationari ergod optim decis rule base neyman pearson criteria probabl assign result robust effici detect mechan techniqu suggest base practic univers compr sion implement low complex minim pre process overhead prove applic test perform appli key techniqu framework problem comput secur detect channel botnet evalu system real trace offer time differ event network key featur context simpl featur easili learn suggest algorithm enabl detect botnet data set neglig fals alarm probabl continu addit applic mon itor system call order detect malici tool identifi data leakag applic concur main test detect confirm ing applic suggest framework detect problem clear addit applic suggest tool identifi abnorm behavior user comput system abnorm larg data network base traffic pattern communic partner test node refer wang chen chen characterist worm infect famili tree forens secur ieee tran action strayer laps walsh livada botnet detect base network behavior botnet detect springer zhang lee botsniff detect botnet command control channel network traffic chang daniel botnet detect behavior cluster statist test proceed acm workshop secur artifici intellig acm noh lee noh jeong detect botnet multi phase flow model digit societi icd third intern confer ieee francoi wang bronzi state engel botcloud tect botnet mapreduc forens secur wif ieee intern workshop ieee salomo brustoloni identifi botnet anomali detect techniqu appli dns traffic consum communic network confer ccnc ieee ieee burghouwt spruit sip detect botnet communic social media monitor user activ system secur springer shin reddi lee larg scale empir studi confick forens secur ieee transact silva silva pinto sall botnet survey comput network abbasi harri moretti haider anwar classif malici network stream honeynet global communic confer globecom ieee ieee celenk conley willi graham predict network anomali detect visual forens secu riti ieee transact perdisci zhang lee botmin cluster analysi network traffic protocol structur independ botnet detect usenix secur symposium assadhan moura lapsley jone strayer detect botnet command control traffic network pute applic nca eighth ieee intern symposium ieee tegel vigna kruegel botfind find bot network traffic deep packet inspect proceed intern confer emerg network experi technolog acm tavallae rammidi ghorbani botcop onlin botnet traffic classifi communic network servic confer cnsr seventh annual ieee est gringoli salgarelli support vector machin tcp traffic classif comput network mazzariello sanson anomali base detect irc botnet class support vector classifi imag analysi process iciap springer siboni cohen botnet identif univers anomali detect forens secur wif ieee intern workshop dec chandola banerje kumar anomali detect survey acm comput survey csur feder merhav gutman univers predict indi vidual sequenc theori ieee transact ziv lempel compress individu sequenc variabl rate code theori ieee transact nisenson yariv yaniv meir behaviometr secur system learn identifi typist knowledg discoveri databas pkdd springer begleit yaniv yona predict variabl order markov model artif intel res jair fava byer yang project cyberattack variabl length markov model forens secur ieee transact nttrace nativ api trace window onlin http nttrace cover thoma element theori john wiley son wireshark onlin https ncat onlin http ncat guid cover thoma element theori john wiley son merhav weinberg univers simul informa tion sourc train data theori ieee transact 