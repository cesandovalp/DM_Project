autom web applic logic reconstruct applic level secur georg noseevich denni gamayunov system secur lab lomonosov moscow state univers moscow russia abstract modern overlay secur mechan web applic firewal waf suffer inabl recogn custom high level applic logic data object low accuraci high fals posit rate overhelm manual effort fine tune paper propos approach web applic model secur purpos help generat waf adapt specif web applic automat aim creat multi layer model adequ simul aspect web applic function intrus detect prevent includ request pars rout reconstruct action data object action interdepend keyword web applic intrus detect web applic firewal function model introduct paper address problem detect prevent intrus web applic help web applic firewal waf kind dedic secur product evolv generic intrus detect system signific web applic increas complex level web applic grow inadequaci tradit detect protect intrus web applic recogn despit plenti waf nowday commerci open sourc empir reasearch firewal provid satisfactori protect modern intrus commerici firewal current lose open sourc firewal case compani find compel develop solut protect web applic scratch analyz web applic firewal flaw reduc effici version commerci industri leader subject variat travers method http messag pars level substandard case order applic function portion protect mechan will switch reach configur reason level fals respons protect base intrus xss sqli arduous process requir month long oper hundr hour man power protect broad rang intrus applic logic includ intrus author mechan main reason web applic firewal unabl effect fight intrus web applic firewal perform intrus detect http protocol level time web applic develop technolog long escap bound clean http construct multi level abstract base provid applic author tool resolv typic task authent session support user author structur data messag develop develop web technolog firewal hoc rout support separ technolog exampl rest applic base logic integr bundl signatur respons public intrus travers method result waf firewal understand intern applic function proven realist order resolv issu firewal adapt applic protect level abstract rais complex growth web applic develop task complex standard protocol structur data exchang server side web applic client side execut browser applic implement protocol top http differ syntax semant problem web applic model order ensur adequ protect web applic firewal rais level understand protect object organ formal standpoint requir contruct function model adequ proper describ properti web applic relev task detect intrus describ requir model web applic function aspect properti model conform fit express power suffici describ broad class web applic preserv balanc univers model rest properti general web applic arbitrari program attempt account option implement inevit lead model difficult comprehend comput complex allow autom suffici express power model establish formal fashion altern suffici conform model declar help expert evalu specialist develop web applic well specialist web applic protect analysi creat model build web applic widespread framework autom possibl final goal autom web applic model creation overlay secur applic draw current experi expens manual creation mainten model outweigh benefit addit protect provid time case build model requir involv oper requir level expertis minim interpret despit model creation autom burden manual analysi correct select mathemat formal model evalu model follow black box principl neural network will limit practic averag secur analyst conclus typic neural network recognit classifi object specif data part valu caus anomali web applic function model synthesi mention creation effici web applic firewal requir develop web app model take relev aspect function account paper divid model aspect three level lowest highest abstract aspect will describ detail name aspect written bold syntax level syntax level model process select specif web applic multitud web applic serv communic channel well syntact structur request pars process select web applic rule base domain port model process match list correspond pair domain port web applic syntact structur pars process transform raw http protocol request data structur applic logic pars logic divid three stage pars http protocol specif framework level pars final pars logic applic stage pars http protocol level standard stage firewal differenti protocol pars implement nuanc depend platform malici attack nuanc bypass protect system detail intrus protocol pars investig order illustr level syntax pars provid exampl bodi http request applic framework googl web toolkit actori _hzpg persist dasd structur data specif gwt framework underlin data specif applic bold structur messag order model http request pars tree edg vertic built sequenti appli decod step instanc request json load jqueri core jqueri migrat load util ver json pars tree fig will built sequenti appli three step decod figur exampl http request pars tree order model algorithm web applic pars arbitrari request solut tree describ order condit decod step appli correspond top tree condit tag arc correspond describ form predic content oper request pars tree exampl desicion tree illustr fig figur decis tree request pars action level abstract level action level transit pars http request sampl action quantiti request occur applic massiv legim request sampl action envisag logic applic quantiti action rule fair small complic applic action paramet rule specif domain definit area type request obgliatorili set action list actual paramet algorithm select action highlight actual paramet base content request refer rout order effici protect web applic firewal complet transit request action paramet requir rout model process ensur syntax valid action paramet waf support syntax model paramet base analysi main method organ rout process modern framework decis list propos rout model logic express display predic content pars tree result action address actual paramet pars tree will examin rout configur django base web applic exampl urlpattern url articl url articl url articl decis list correspond exampl syntax model propos differenti case approach scheme present paramet type enumer case model list paramet valu paramet correspond priori widespread data type number type indic mail address phone number model case entail descript select type exampl form regular express paramet correspond predefin data type regular syntax structur case propos statist classifi base multi diment normal distribut train histor data paramet arbitrari format string enter user case definit area paramet unlimit creat meaning model seri valu paramet train period set statist test determin case list abblic train correspond classifi predic action paramet articl view news year month article_id articl month archiv year month articl year archiv year action level authent process includ multi level model well user session implement propos describ process term life cycl session attribut attribut defin procedur establish valu attribut exampl attribut session set set cooki header http respons csrf token attribut http respons bodi user attribut success authent http request bodi procedur verifi correct valu attribut transmit request exampl session transmit cooki header http request correct action public servic csrf token transmit csrftoken paramet correct idempot chang condit applic action procedur invalid valu attribut exampl execut exit action valu attribut oper ealier invalid case level case level analys logic dependend action chain case order model case firewal abil describ depend action data depend action oper base action time depend action exuct action execut order model time depend propos finit state automata data depend model onlin bank system illustr fig figur model depend action model describ system initi access allow start view enter user credenti password complet key author token user opportun view data account view account complet transfer transfer fund user will requir enter addit text code case level perform data object reconstruct learn data object web applic oper term logic exampl account messag user profil addit data object life cycl whould defin action correspond creation view modif remov type object level model process access control take place well dynam definit multitud sampl action permit user moment time order propos analyz content web server user deriv list action activ envisag interfac conclus paper analys aspect web applic function perspect secur enforc web applic firewal propos model principl indic aspect make creat function model applic identifi abnorm request traffic counter construct model approach model properti web applic allow autom train network data descript autom escap bound articl manual automat reconstruct web applic aspect model allow waf adapt specif protect web applic dramat improv accuraci addit requir model interact web applic bound complex ecosystem exampl singl entri point technolog sigl sign promis trend creation user behavior model applic identifi incid theft illeg user credenti function model web applic relev properti consider necess creat effici firewal web applic refer ristic protocol level evas web applic firewal black hat proceed juli ivan novikov lie bypass modern web applic firewal http lie jason haddix bypass web applic firewal http header http fortifi applic secur bypass web applic firewal http header cloudflar incapsula modsecur http zerosci cloudflar incapsula modsecur http zerosci cloudflar incapsula round alexey sintsov waf scale http alexeysintsov waf scale corey benning secur ecommerc data metric https lib talk rivest learn decis list machin learn krueger tokdoc heal web applic firewal proceed acm symposium appli comput acm noseevich petukhov detect insuffici access control web applic syssec workshop syssec ieee 