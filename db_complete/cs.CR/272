version obfusc imped softwar tamper replic program divers hui yangfan zhou michael lyu depart comput scienc chines univers hong kong moe key laboratori high confid softwar technolog cuhk lab depart comput scienc fudan univers abstract tamper resist fundament softwar curiti area approach propos thwart specif procedur tamper obfusc checksum best knowledg achiev theoret tamper resist idea imped replic tamper program diversif increas complex break softwar system propos deliv featur function nonequival softwar copi machin formal defin problem version obfusc provid viabl solv problem evalu result time requir break softwar system linear increas number softwar version complex introduct softwar releas face secur threat exampl attack crack licens protect mechan sell pirat softwar pack payload advertis origin softwar purpos nowaday repack app malici payload major threat mobil secur attack general involv revers engin techniqu tamper softwar protect softwar tamper major approach propos obfusc checksum hand softwar protect obfusc approach deter attack locat target code spot hand softwar emb checksum code detect tamper execut current tamper resist work propos kind trick thwart specif tamper tool approach loop unsolv conjectur thwart symbol execut trick recogn skill attack design hand craft tool launch attack safe conjectur softwar achiev theoret tamper resist trust hardwar circuit general softwar tamper object enabl replic tamper machin intuit guarante piec softwar fulli tamper resist fail execut tamper softwar general machin idea program diversif prevent widespread attack make intrus harder replic attack tamper softwar machin work cut contagion tamper control scope potenti damag survey exist softwar diver sific approach general consid function equiva lent program effect kind attack return orient program approach function equival constraint meet disabl replic tamper softwar attempt propos deliv featur function nonequival softwar copi machin major challeng goal program function nonequival divers formal defin problem version obfusc provid viabl solut softwar client server architectur integr messag authent code mac mechan function nonequival algorithm origin softwar resist tamper replic softwar integr protect problem reduc solut model worth note version obfusc appli seamless exist tamper resist approach equip replic resist properti analysi result tamper complex incur version obfusc increas linear number function nonequival softwar version rest paper organ discuss background demonstr approach iii evalu effect work discuss final conclud paper background threat model assumpt softwar deliv user vulner tamper attack modifi origin program execut logic specif purpos replic tamper machin modif achiev way softwar repack attack manipul softwar execut direct exampl remov origin advertis modul embed mobil app instal file replac benefici dynam inject attack dynam inject piec code program process manipul load program execut linux ptrace tool approach adopt virus anti virus softwar inject inspect code monitor program execut place door control work consid hostil host model adopt softwar tamper resist work assum launch tamper attack attack malici host analyz softwar fulli inspect softwar execut step step limit anti revers engin revers engin crucial technolog softwar tamper involv process analyz manipul softwar base execut execut linkabl format elf anti revers techniqu imped process trick execut fool analyz general revers engin elf file involv phase disassembl phase analyz phase disassembl phase decod elf binari assembl code perform tool ida automat imped decod eventu processor decod execut file hand trick propos obstruct analyz phase discuss major approach limit general way revers analysi offlin approach onlin approach offlin approach execut assembl code direct analyz revers engin tool ida program proper obfusc control flow graph cfg easili deriv assembl code block indic call relationship complex analyz assembl code simplifi cfg provid great assist revers engin grasp mean low level assembl code semant protect program analyz offlin obfusc approach propos main idea obfusc add junk code origin program origin function program preserv method propos achiev exampl opaqu constant add block junk code execut fig exampl creat hard problem bunch code discuss method confus trigger condit code block function static analyz infer code execut junk code fig exampl transfer obvious condit opaqu condit hash function unsolv conjectur propos confus exit criteria loop fig exampl collatz conjectur obfusc techniqu increas great difficulti general static analysi tool analyz cfg grasp mean assembl code obfusc approach vulner exampl opaqu constant vulner symbol execut implement smart constraint solver unsolv conjectur vulner homemad tool recogn pattern conjectur power offlin analysi tool shelf pure offlin analysi suffer hard limit detect anti revers protect runtim code unpack malwar escap foo origin code obfusc foo function function int getchar true foo junk opaqu constant int foo collatz conjectur fig demonstr obfusc approach trick origin code fig fig foo static analysi adversari execut code execut instruct trace debug code step step perform analysi onlin revers engin analysi process general obfusc adversari leverag set system monitor tool monitor execut outcom code block facilit revers engin process research suggest set trap anti debugg code hinder debug exampl simpli check debug regist detect debugg count execut time code block detect paus penal debugg trick anti debugg code recogn adversari suppress check patch binari simpli switch debugg deriv understand code adversari manipul binari delet code specif purpos preserv abil execut detect code patch checksum code basic idea pre calcul relat address checksum program fetch instruct execut checksum govern region tamper instruct correct program suspend overlap checksum code increas strength protect defeat care detect remov explor vulner execut environ overwhelm anti revers engin method softwar fulli resist tamper hardwar protect iii propos approach introduc version obfusc problem discuss solut applic scenario achiev tamper resist problem definit formal defin version obfusc problem algorithm automat generat larg set function nonequival algorithm parent algorithm meet properti homo properti perform task output result gene vector diverg properti perform task general output suppos softwar architectur client server mode deploy parent algorithm server side deliv uniqu children algorithm client softwar distribut client function nonequival divers diverg properti homo properti enabl server handl divers version obfusc viabl solv version obfusc problem algorithm approach leverag iter calcul need generat function nonequival divers main loop origin algorithm includ round iter iter take plaintext block calcul twenti round calcul equat generat switch secur consider choos specif calcul round evid program suffer great secur degrad switch diversifi origin algorithm choos sequenc equat generat valu gene individu design parent algorithm receiv gene child process data input set gene algorithm parent algorithm design algorithm pointer array equat generat array round iter pass algorithm gene child clear input parent algorithm comput result child proper set implement autom process generat version algorithm base low level virtual machin llvm opensourc compil support extens llvm repres sourc code abstract syntax tree ast transfer intermedi code final compil execut specif platform llvm support plugin libtool manipul sourc code target ast branch compil process custom libtool tool automat generat version obfusc algorithm xor xor xor xor temp leftrot leftrot temp algorithm main loop data call pointer tail function function xor xor function function xor xor function tail temp leftrot leftrot temp algorithm parent algorithm algorithm gene possibl bit repres gene compil random generat length bit sequenc chromosom equat function pointer chromosom option replac correspond ast branch hardcod equat function pointer set worth note version obfusc approach provid resist revers engin approach seamless integr aiti revers engin protect exampl obfusc approach propos compos hard problem function pointer opaqu constant client client guard guard client guard server mac child mac parent version databas fig applic version obfusc program tamper resist applic discuss client server softwar adopt version obfusc idea implement mac mechan obfusc algorithm mac popular mechan adopt client server comput architectur check integr authent messag client send request server calcul mac request append origin request server valid mac process request hash function major compon mac algorithm version obfusc algorithm adopt fig illustr mechan fig client embed uniqu base mac calcul algorithm perform request server send identif machin serial number user request mac server server queri gene client local version databas identif client verifi mac distribut divers program achiev implement mac mobil code dynam librari deliv server request client softwar launch librari time request server librari server random choos librari pool pre compil librari deliv client record map gene client uniqu identif version obfusc databas server verifi mac generat client homo properti provid tamper resist capabl client softwar base version obfusc librari resist replic diverg properti viabl implement integr check function align mac librari librari serv secur guard softwar interleav code integr check function mac algorithm integr check trigger calcul mac algorithm exemplari integr check function app android oper system function navig map file app process record program segment address memori compar record fig exemplari android app inject lbe librari check map file app process pid detect tamper data dict segment list predefin segment size function integritychk pid getpid file open proc pid map readlin file eof segnam getsegnam segsiz getsegs segnma reaction segnma segsiz reaction algorithm exemplari integr check function defin standard dictionari develop abnorm segment map integr violat respons mechan trigger approach effect detect softwar repack dynam inject attack discuss adversari model exemplari app fig tamper lbe commerci secur softwar android algorithm detect tamper find abnorm segment attack tamper copi guard remov integr check function replic machin server detect replic incorrect mac inconsist map identif gene implement reaction mechan renew guard crash client softwar direct question simpli key compos divers exampl key hash messag authent code hmac algorithm hardcod uniqu symmetr key client librari note approach effect vulner hide key whitebox cryptographi difficult hide program logic evalu goal work imped tamper replic creat divers softwar instanc increas tamper complex softwar system evalu complex increas version obfusc tamper multipl softwar client suppos program adopt protect mechan discuss iii decent attack wish manipul program binari specif purpos includ delet modifi adversari analysi guard simpli remov disabl app mac mechan rest guard execut hostil host environ softwar fulli inspect care analysi attack identifi protect lie integr check function algorithm disabl check care remov function suppress reaction version obfusc protect attack deliv tamper softwar user replic tamper softwar execut machin softwar system broken version obfusc protect attack simpli repack app tamper guard messag verif fail program function break softwar system attack analyz tamper guard machin order tamper softwar machin attack guard machin develop tamper guard substitut origin guard protect interleav checksum code success tamper requir remov checksum code time chanc low sophist analysi exist approach identifi code general requir dynam analysi taint analysi empir time requir tamper guard neglig denot time need analyz softwar copi tamper hostil host time complex equal tamper softwar copi version obfusc denot time need guard machin replac denot time need tamper attack wish tamper softwar machin total time estim interleav checksum code neglig complex equal tamper approach build algorithm parent algorithm calcul hash gene specif child attack recogn gene set guard compar differ implement locat gene attack deriv knowledg version obfusc theori implement kind attack theoret guard obfusc difficult best knowledg exist work break obfusc program requir symbol execut sophist constraint solver complic taint analysi comput intens time consum denot time need extract gene guard time need tamper softwar system estim neglig complex equal note arbitr larg obfusc task fulli autom work review work revers engin field discuss work appli autom program divers improv program secur revers engin softwar protect problem decad ago propos solut general fold hard ware circuit assist solut provid better secur assur pure softwar solut better adapt general hardwar problem hardwar circuit assist solut applic requir specif hardwar discuss pure softwar solut literatur softwar protect anti revers gineer approach purpos research protect piraci intrus investig imped malwar detect share set common protect techniqu differ obfusc basic softwar protect approach complic binari increas difficulti revers engin ogiso propos obfusc code construct hard complex problem requir determin real function pointer array pointer approach vulner symbol execut constraint solver thwart symbol execut sharif notic code block conceal set trigger condit function constraint solver solv wang propos obfusc techniqu combat symbol execut explor general limit symbol execut tool analyz loop idea unsolv conjectur confus termin condit loop approach vulner trick unsolv conjectur recogn set trick sourc code linn propos obfusc binari direct insert error bit automat correct execut cpu current disassembl tool secur protect limit vulner dynam analysi actual instruct trace easili softwar execut deter dynam analysi debugg oishi propos camouflag anti debugg effect homemad debugg protect softwar tamper general popular approach detect unauthor modif runtim employ checksum mechan checksum mechan redund overlap checksum tester insid program verifi integr side investig focus defeat protect wurster propos defeat checksum approach duplic memori attack examin effect popular cpu type qiu propos identifi checksum code taint analysi approach yadegari find general deobfusc obfusc algorithm work exist work focus imped replic softwar tamper autom softwar diversif idea softwar divers initi propos softwar reliabl engin cohen first propos creat function equival program enhanc softwar secur forrest state benefici effect divers comput system overlook introduc divers comput system robust replic attack propos way creat divers respect program behavior includ nonfunct code refector code diversifi memori layout crane build fine grain code diversif prevent code reus attack adopt function permut regist alloc random calle save regist save slot reorder diversif process best knowledg work consid automat generat function nonequival program improv tamper resist conclus work investig softwar tamper resist issu version obfusc formal defin version obfusc problem provid viabl solut algorithm discuss appli cation version obfusc idea client server softwar architectur introduc function nonequival divers approach effect imped replic tamper evalu result complex tamper softwar system linear increas number softwar version automat generat trivial cost refer fip pub secur hash standard shs http public fip fip pdf ida https product ida lbe http llvm http chang atallah protect softwar code guard secur privaci digit right manag springer chen venkatesan cari pang sinha jakubowski oblivi hash stealthi softwar integr verif primit hide springer chow eisen johnson oorschot white box cryptographi implement select area cryptographi springer cohen oper system protect program evolut comput secur collberg thomborson watermark tamper proof obfusc tool softwar protect softwar engin ieee transact crane liebchen homescu davi larsen sadeghi brunthal franz readactor practic code random resili memori disclosur ieee symposium secur privaci volum eilam revers secret revers engin john wiley son forrest somayaji ackley build divers comput system oper system sixth workshop hot topic ieee gagnon taylor ghosh softwar protect anti debug secur privaci ieee horn matheson sheehan tarjan dynam check techniqu improv tamper resist secur privaci digit right manag springer kil jim bookholt ning address space layout permut aslp fine grain random commod softwar comput secur applic confer acsac annual ieee larsen brunthal franz automat softwar divers ieee secur privaci linn debray obfusc execut code improv resist static disassembl proceed acm confer comput communic secur acm lyu handbook softwar reliabl engin ieee comput societi press moser kruegel kirda limit static analysi malwar detect comput secur applic confer acsac twenti third annual ieee ogiso sakab soshi miyaji softwar obfusc theoret basi implement ieic transact fundament electron communic comput scienc sezer mclaughlin obfusc hidden malwar secur privaci ieee pappa polychronaki keromyti smash gadget hinder return orient program place code random secur privaci ieee symposium ieee qiu yadegari johannesmey debray framework understand dynam anti analysi defens proceed program protect revers engin workshop acm qiu yadegari johannesmey debray identifi understand checksum defens softwar sander tschudin protect mobil agent malici host mobil agent secur springer sharif lanzi giffin lee imped malwar analysi condit code obfusc ndss shield anti debug develop view wang ming jia gao linear obfusc combat symbol execut comput secur esor springer wurster oorschot somayaji generic attack checksum base softwar tamper resist secur privaci ieee symposium ieee yadegari johannesmey white debray generic approach automat deobfusc execut code technic report zhang liu zhu program logic base softwar plagiar detect symposium softwar reliabl engin issr zhou jiang dissect android malwar character evolut secur privaci ieee symposium ieee 