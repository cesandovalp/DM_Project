enhanc secur protocol actor key compromis problem jing sklcs institut softwar chines academi scienc univers chines academi scienc wenhui zhang sklcs institut softwar chines academi scienc beij china abstract secur complex system issu softwar engin complex comput system involv actor secur protocol communic sensit data actor key compromis akc denot situat long term secret key actor adversari reason protocol secur ensur secur situat paper studi problem potenti type attack defin formal properti provid solut enhanc level secur case studi analyz vulner respect potenti akc attack practic protocol includ kerbero provid solut enhanc level secur protocol introduct secur complex system issu soft ware engin complex comput system involv actor secur protocol commu nicat sensit data secur protocol secur reason includ weak method generat secret key storag key key reveal adversari imperson parti munic actor key compromis imperson kci attack attack sensit data imperson actor key compromis akc attack general kind attack studi properti formal condit achiev identifi previous work focus kci attack domain key establish protocol concret parti protocol studi countermeasur prevent attack provid type kci attack classifi base respond authent initi digit signatur time stamp help studi secur attribut group key exchang protocol kci attack comput model kci provid systemat analysi consequ compromis secret key countermeasur construct imposs addit issu investig first classif kci attack base capabl eavesdrop send messag generic reveal featur attack provid definit attack type easier analyz vulner modifi protocol enhanc secur second work focus problem actor secret key compromis focus solut enhanc secur case actor unknown secret key compromis consid multi parti protocol type secur claim third practic algorithm provid transform protocol akc resili practic method purpos work provid practic solut transform protocol achiev higher secur level akc attack work includ classifi type akc attack provid formal definit furnish solut provid practic algorithm rest paper organ introduc model framework formal secur properti classifi type akc attack formal definit attack propos solut prevent attack case studi conclud remark proof proposit corollari algorithm transform protocol appendix preliminari follow formal framework protocol specif execut model defin protocol specif partial function denot domain rang denot dom denot function coincid write denot sequenc element fresh var func tid denot set agent role fresh tid distinguish thread identifi test tida stand thread arbitrari agent adversari thread tid bind local term protocol thread identifi tid denot asymmetr long term public key denot correspond secret key superscript func termn denot ariti paramet const special case func ariti symmetr cryptographi hash suffici ensur akc resili breviti consid symmetr cryptographi paper omit symmetr cryptograph term definit basic element protocol definit term term fresh fresh tid tid func termn term term term term defin roleterm set term subterm fresh tid runterm set term subterm fresh role term transform term appli instanti set inst tid fresh runterm defin binari relat term denot term infer set term denot invers function term agent term term func relat smallest relat satisfi subterm relat defin reflex transit closur smallest relat satisfi term function name access subterm relat vacc identifi retriev subterm defin subset subterm relat vacc vacc order identifi posit defin subterm relat vace vace definit event claim set claim includ claim commit run secret nisynch label set label set event defin roleev sendlabel roleterm revclabel roleterm claimlabel claim roleterm runev creat sendlabel runterm revclabel runterm claimlabel claim runterm advev lkr event roleev runev advev runev describ agent start thread send receiv messag lkr event adversari compromis long term secret key advev execut singl adversari thread tida exampl event sendl alic bob tid alic denot alic send bob nonc tid tid encrypt secret key event event type label denot evtyp label content send event denot cont order simplifi type constraint stand event stand sequenc event stand role stand agent stand label stand role term term clear context stand term messag tid tid set sequenc element denot element sequenc denot oper denot concaten sequenc powerset denot pow sequenc roleev well form variabl initi access posit recv event event var denot set variabl appear wellform recvl vacc var protocol partial function event function formal term store variabl role sequenc event wellform definit protocol event pow runterm dom wellform protocol conveni extend domain term term set term variabl substitut initi protocol label associ send role receiv role denot defin label sendl recvl label sendl recvl execut model protocol execut model label transit system state runev state trs ths consist trace trs tid runev advev knowledg partial function ths tid runev role variabl instanti inst denot tid tid trs trs event trace initi state tida fresh initi adversari knowledg oper semant protocol defin transit system compos execut rule fig select subset adversari rule fig creat rule start thread protocol role send rule send messag network add adversari knowledg receiv rule accept messag match pattern claim rule state secur properti expect hold lkractor rule allow adversari learn long term key agent execut test protocol initi role dom set adversari rule rule write set reachabl state denot set trace protocol denot trace state trace trs thread trace creat role special thread test creat role tid function identifi tid role role test role tid tid creat trs secur properti secur properti model reachabl proper tie secreci claim role term form claiml secret label role definit secreci claim state claiml secret secreci claim test test test trs test test properti data agreement commit properti initi agre data respond nisynch properti initi complet protocol respond run protocol agent agre variabl commit claim role term form claiml commit label role correspond run claim commit claim form claiml run definit commit claim state claiml commit commit claim test test test trs iff tid role tid run claim claiml run tid test trs exist send event tid trs vacc cont denot total order event sequenc sequenc event order event induc communic defin sendl recvl transit closur union role event order communic relat call protocol order prec set causal preced communic claim event label prec recvl claimcl tidinst pow tid denot function map role run trs state trs denot iff trs tid tid nisynch claim form claiml nisynch state correspond send messag recv messag definit nisynch claim state claiml nisynch nisynch claim test test test trs prec tid tidinst trs recvl tid tid tidinst trs sendl tid protocol akc secur secur claim hold akc attack properti formalis denot definit actor key compromis secur akc protocol dom versari repres set adversari rule secur claim actor key compromis secur akc respect correct secur properti assum asymmetr long term secret key appear access posit messag protocol subsequ section dom dom tida test tid creat tid tid sendl seq tid sendl seq send tid recvl seq dom var dom tid recvl seq tid seq evtyp claim tid seq claim fig execut model rule dom tida lkr ltk dom tida lkr ltk fig adversari compromis rule attack type understand techniqu launch attack attack object help identifi weak protocol work categor attack tradit dolev yao adversari model classif key attack studi protocol categor attack base capabl modifi messag pass parti key establish protocol kci attack studi class kci attack describ studi type attack stronger adversari model provid formal definit attack base trace model techniqu fix protocol provid secreci attack purpos protocol transmit secret nonc initi respond order nonc secret initi will encrypt nonc public key safe intrud secret key definit secreci attack protocol roleterm test test secreci attack denot secrecyattack exampl suppos initi transmit secret nonc respond set session key order nonc secret initi will encrypt nonc public key safe intrud secret key consid ccit protocol hash clear secreci attack secret key respond intrud substitut attack attack type occur situat initi respond fresh valu secret key authent main characterist type attack adversari replac term messag term discov match denot thread instanti agent correspond thread munic instanti state match iff tidi tidi denot deriv replac subset label set term access relat predic replac defin replac tid tid tid tidinst tid tidinst match tid tid trs recvl tid trs sendl tid substitut attack adversari eavesdrop messag modifi fresh valu fresh valu transmit receiv messag finish tid denot thread tid plete event sequenc ths tid correspond event trs fresh func advfresh func advfresh denot subset fresh adversari definit substitut attack secur pro tocol substitut attack tid finish tid replac label vacc tid hold denot subattack exampl consid bilater key exchang bke proto col exampl suppos guarante secreci kir agreement hash kir hash kir protocol vulner substitut attack intrud denot dalic secret key bob agent role decrypt messag secret key construct messag nonc adversari imperson bob alic agent break agreement alic bob bob bob bob dalic hash alic kir alic dalic decrypt messag alic learn hash dalic choos kir construct hash alic kir alic dalic alic hash alic kir alic alic dalic hash kir role mixup attack attack type result particip entiti agre play role protocol termin denot exist label role access posit match send event recv event trace termin tid tid tid tidinst tid tidinst match tid tid trs recvl tid label trs sendl tid role mixup attack state messag agent name access posit replac adversari public secret key agent replac public secret key adversari forg messag agent name access posit imperson parti definit role mixup attack protocol subset label agent name access correspond event label vacc cont role mixup attack denot rolemixupattack defin rolemixupattack tid finish tid replac vacc tid termin tid replac label vace tid exampl consid isoiec protocol exampl cert cert protocol vulner role mixup attack protocol bob alic agre fresh valu attack fig adversari listen messag imperson alic bob alic assum bob bob assum alic alic bob act parallel attack environ protocol thread authent preserv communic thread protocol assum communic definit parallel attack protocol parallel attack denot parallelattack defin parallelattack tid tid trs recvl tid tid tidinst trs sendl tid match tid tid exampl consid protocol agent authent three nonc protocol vulner parallel attack alic run protocol adversari forg messag second bob initi session alic receiv authent messag attack fig prevent attack construct method avoid potenti akc attack transform achiev unilater secur provid work provid tran format achiev bilater secreci agreement secret key achiev agreement hash function public key achiev agreement argument content encrypt public key will compromis easili hash function commit valu short term key point cert alic racert bob bob intrudertialic intrudertialic alic text racert bob cert alic alic intrudertibob rolein alic bobb assum rolein bob aliceb assum intrud racert bob learn transmitand intruderti choos transmitand intruderti choos transmitand choos nisynch fig bob alic alic bob bob rolein alic boba assum aliceb assum rolein bob boba assum rolein alic intrud bob learn bob alic synch fig work special tag includ role name prevent role mixup attack modifi parti nsl protocol order achiev higher agreement properti nisynch illustr practic approach resili secreci attack tag function transform provid recal function restrict defin definit tag function const term term term atom long term key denot modif restrict main set term avoid tag unnecessari term transform fig ensur akc secreci three messag constant nonc second encrypt nonc third secreci encrypt nonc public key work encrypt secreci pair key adversari compromis pair achiev akc secreci side add constant tag messag ensur secreci typet request secret request secret typet typet rpk cbi tag type secret secret request fig transform secreci formal definit transform asymmetr long term secret key appear acc sibl posit messag requir state prove adversari reveal infer peer asymmetr long term secret key adversari adversari rule proof proposit fact adversari forg messag appear access posit secreci depend secreci compromis time reader refer appendix detail proposit secreci asymmetr encrypt dom adver sari compromis long term secret key request const label unequ unus fresh roleterm vacc unus typet protocol typet typet secret typet secret typet secrecyattack typet remark idea messag ensur secreci differ purpos ensur bilater secreci matter key compromis secreci guarante substitut parallel attack prevent parallel attack tag messag hash function includ previous variabl adversari disorgan messag thread learn previous variabl side hard order prevent substitut attack advantag hash function includ fresh variabl hash function adversari forg messag fresh hash function techniqu transform function prove commit properti achiev akc attack transform fig ensur akc agreement assum fresh occur secret add messag hash function previous event second respons hash hash function work signatur take secreci ensur adversari forg messag cbi tag type commit commit run run fig transform agreement typeta commit run run commit typeta typeta formal definit transform proposit agreement hash dom adversari compromis long term secret key label const unus roleterm adversari test typeta protocol typeta typeta commit typeta commit reader refer appendix proof kind transform resili substitut parallel attack corollari resili substitut attack origin protocol resili substitut attack modifi protocol properti subattack subattack typeta corollari resili parallel attack origin protocol resili parallel attack modifi protocol properti parallelattack parallelattack typeta corollari transform protocol induc tive assum protocol empti add messag base proposit ensur agreement reader refer appendix proof corollari resili role mixup attack prevent role mixup attack find special kind tag role name encrypt secret key term term dom tag function defin atom long term key term term extend event event replac term event sequenc will provid transform function assum content messag composit contrast atom term send event respons transform help prevent role mixup attack reason consid agent name fresh valu base proposit parti communic agre agent name communic parti form connect graph parti agre agent name role mixup attack exist reachabl state replac termin function hold parti agre agent instanti role replac forgeri detect agent appli techniqu transform provid proposit achiev nisynch properti multi parti protocol akc multi parti authent protocol multi parti protocol vulner akc attack result complic communic parti consid famili multi parti nsl protocol brought protocol vulner akc attack protocol denot denot number parti protocol approach transform modifi messag pair parti add hash function tag prevent substitut parallel attack combin messag pair form protocol final add tag prevent role mixup attack fresh defin protocol messag msg simplifi tag function suffi cient tag round communic acc sibl posit encrypt fresh secret key ensur agreement label defin msg recvlp msg sendlp msg nisynch recvli rimsg send msg recvli msg claimmi nisynch modif protocol unchang transform protocol structur origin messag replac correct respect nisynch claim state proposit prove fact messag encrypt asymmetr secret key hash function secret nonc achiev agreement parti reader refer appendix proof proposit multi parti nsl agreement typetm transform protocol dom adver sari compromis respect long term secret key claimmx nisynch typetm case studi protocol vulner akc attack exampl appli techniqu enhanc secur level protocol transform provid proposit transform protocol akc tabl experi scyther tool appli transform scheme properti requir protocol properti hold parti protocol transform tabl protocol experi protocol secreci nisynch bilater key exchang kir ccit ccit isoiec nsl prepak kerbero tmn splice cardhold registr pan demonstr three prac tical protocol kerbero cardhold registr protocol transform origin model protocol point akc attack autho rizat secreci transform protocol base proposit subprotocol wimax wireless access system deliv mile wireless broadband access subprotocol authent key manag secur communic authent base station mobil station establish share secret secur exchang traffic encrypt key tek messag secreci tek depend secreci prepak three messag resili akc attack three messag protocol proceed msrand msrand bsrand prepak bsrand secreci prepak base secreci mobil long term secret key akc attack secreci tek agreement side implement protocol encrypt prepak messag add hash function messag exampl transform scheme proposit modifi protocol msrand msrand bsrand prepak bsrand msrand prepak tabl modifi protocol satisfi nisynch properti claim secreci prepak hold kerbero kerbero design authent client multipl network servic pkinit extens kerbero modifi allow public key authent basic ker bero parti client goal authent applic server kerbero authent server provid ticket grant ticket tgt ticket grant server present tgt provid server ticket client credenti client authent applic server role talk separ divid protocol three parti part tgt main issu ensur secreci client send server secreci depend secreci depend secreci reveal intrud easi intrud fake messag proposit modifi messag tgt achiev secret nisynch properti part modifi cardhold registr cardhold registr protocol set protocol onlin purchas compris three messag exchang cardhold certif author exchang cardhold request registr certif public key second exchang cardhold suppli credit card number pan receiv applic form bank issu credit card third exchang cardhold return complet applic form deliv public signatur key suppli cardsecret process pan pan nca pan nsecc pan nsecc nsecca protocol secur secreci pan nsecc nsecca will reveal long term secret key compromis fail reach agreement messag receiv messag vulner parallel attack modifi protocol insert nonc encrypt pan nsecc hash tag messag guarante nisynch properti modifi protocol pan pan nca nca pan nca nsecc pan nsecc nsecca nca nsecc nsecca modif guarante secreci pan nisynch properti conclud remark paper analysi akc attack solut enhanc level secur consid type akc attack definit type base attack type provid techniqu transform protocol guid principl design ing secur protocol potenti akc attack short term key ensur secreci hash function maintain agreement role name prevent role mixup attack appli techniqu transform practic protocol verif tool scyther modifi protocol achiev higher level secur refer blake wilson simon johnson menez key agreement protocol secur analysi lectur note comput scienc david basin cas cremer marko horvat actor key compromis consequ countermeasur ieee comput secu riti foundat symposium csf ieee comput societi gao meng zhang key compromis imperson attack certificateless key agreement protocol improv protocol educ technolog comput scienc intern workshop ieee qiang tang liqun chen extend kci attack parti key establish protocol process letter chalkia type key compromis imperson attack pass key establish protocol busi telecommun busi telecommun chalkia key compromis imperson vulner abil pass key establish protocol secrypt gorantla model key compromis imperson attack group key exchang protocol lectur note comput scienc lamacchia lauter mityagin stronger secur authent key exchang paper present proceed lncs zhu robert tian xiaojian wong duncan enhanc model key compromis imperson resili ident base key exchang iacr cryptolog eprint archiv basin david cremer model analyz secur presenc compromis adversari lectur note comput scienc cremer cas mauw oper semant verif secur protocol oper semant verif secur protocol springer shim kyungah risk compromis secret infor mation communic secur springer berlin heidelberg chalkia type key compromis imperson attack pass key establish protocol busi telecommun busi telecommun cremer mauw famili multi parti authent pro tocol benelux workshop system secur wissec basin david improv secur cryptograph protocol standard secur privaci ieee aaron jaggard break fix public key kerbero proc bella giampaolo massacci paulson overview verif set intern journal secur cremer scyther tool verif falsif analysi secur protocol open repositori http softwar spore secur protocol proc cav ser lncs springer basin david cremer meier provabl repair iso iec standard entiti authent proceed intern confer principl secur trust springer verlag appendix proof present proof proposit corol lari lemma lemma state term secret event part occur access posit event secret sequenc event lemma state term encrypt secret nonc agent deriv term lemma state properti hash term lemma state suppos trs tid trs test denot element sequenc suppos vacc cont label label label vacc cont test test proof lemma execut rule adversari rule denot newli adversari knowledg prove test test cont appear term access posit help deduc test lemma suppos tid const fresh runterm tid tid reachabl state test test trs test recvl trace tid trs evtyp send vacc cont proof lemma deriv test composit step impli vacc lemma exist tid tid runev tid trs evtyp send vacc cont lemma suppos tid func fresh tid tid reach state test test trs test recvl trace const tid trs evtyp send vacc cont proof lemma test tid appear forg adversari test access adversari deriv test composit step vacc lemma exist tid tid runev tid trs evtyp send vacc cont proof proposit prove secret test test secret test trs goal prove test test roleterm proposit vacc appear time test test prove secret test test secret trs goal prove test tid step prove test test tid tid event tid trs evtyp send test vacc cont proposit test test lemma test test lemma exist tid tid trs evtyp send vacc cont assum instanc tag step exist roleterm tid tid cont sendl role tid exist tid tid test tid impli contradict condit transform test test tid appear time proposit tid access set subterm term test prove test test test test proof proposit prove commit test test commit tid trs prove correspond run claim hold test tid test tid lemma exist tid tid trs evtyp send vacc cont assum instanc tag event tid tid test tid contradict run claim hold prove commit test test commit test trs proposit lemma test test rest proof lemma prove correspond run claim hold proof corollari long term secret key compromis proof proposit tid tid reachabl state trs test tid trs tid tid trs tid trs test precondit label prec tid match trs sendl trs recvl violat definit substitut attack fore conclus correct proof corollari prove exist tid match cor respond send recv event violat definit parallel attack conclus correct proof proposit arbitrari prove reachabl state test test appear time send event access posit test appear encrypt test prove agent assumpt agent name adversari agent assumpt agent name test test agent name transmit secret key test assumpt test test test msg composit step test will find assumpt termin protocol violat premis nisynch properti adversari agent assumpt agent name proof adversari role posit trs test claimmk test nisynch posit test test test trs recvlk msg test trs sendlk msg test trs recvlk msg test prove posit tid trs sendlk msg trs recvlk msg trs sendlk msg label adversari prove test lemma establish posit equal trs sendlk msg label adversari replac determin agent deriv sendlk msga composit step exist trs sendlk msg label prove agre receiv messag msg deduc msg access sition exist trs recvlk msg role test lemma exist send event correspond recvlp msg recv event proof algorithm subsect algorithm transforma tion base transform scheme provid protocol syntax practic reason striction protocol syntax requir content messag fix structur term protocol organ role name appear fresh name hash function fresh appear access messag role respond role initi term origin messag encrypt fresh name encrypt transform protocol defin protocol mess claim mess role role tmp tms tmps tmsp tmr tmf tmh tmn tmp tmr tms tmr tmh tmf tmr role tmf fresh tmn tmf fresh tmps tmp tmr tmsp tms tmr claim role secret fresh role commit role fresh role nisynch function event messag set oper defin collect fresh name messag chn collect fresh name appear hash function collect fresh name secreci claim collect fresh name commit claim mess fresh tmf vacc mess vacc chn mess fresh tmf vacc mess vacc claim fresh secret claim claim fresh commit claim fresh denot secret key public key repres fresh encrypt public key secret key defin fen function encrypt type fresh messag fen mess tms vacc vacc mess tmp vacc vacc mess tmps vacc vacc mess tmsp vacc vacc mess null defin enc encrypt messag encrypt enc mess mess fen mess mess defin eha encrypt fresh set hash function fresh eha mess mess chn mess mess algorithm transform tech niqu present design algorithm enhanc secur level protocol pseudo code algorithm algorithm denot initi respond algorithm algorithm base proposit ensur secreci akc algorithm work fol low set secret set ini secret set res store fresh claim secret initi respond messag encrypt fresh secret set ini secret set res secret short term key generat opposit parti algorithm transform parti secreci protocol secret set ini claim secret set res claim secret set ini secret set res mess messag request insert messag secret set enc transmit secret short term key generat secret set secret set ini secret short term key generat secret set secret set res secret set enc algorithm algorithm base proposit ensur commit properti algorithm messag encrypt fresh secret key hash function set set ini set res store fresh claim commit initi respond assum secret valu fresh encrypt secret key algorithm will follow proposit will follow proposit algorithm transform parti commit protocol set ini claim set res claim secret short term key secret short term key set ini set res mess transmit set set res set set ini set fen null enc fen eha 