reus lose effici secur comput reus encrypt valu benjamin mood bmood univers florida debayan gupta yale univers kevin butler butler univers florida joan feigenbaum yale univers abstract parti secur function evalu sfe sig nific feasibl resourc constrain vice advanc server aid comput sys tem bottleneck input valid stage comput sfe search devot suffici attent impor tant problem retain state comput perform expens process repeat comput paper present partialgc sfe system allow reus encrypt valu generat garbl circuit compu tation partialgc reduc computa tion time bandwidth comparison previous outsourc scheme secur comput demonstr feasibl approach set experi garbl circuit evalu mobil devic evalu server partialgc build privaci preserv friend finder applic android reus previous input allow state eval uation repres sfe reduc comput barrier introduct secur function evalu sfe allow multipl parti joint comput function maintain input output privaci parti variant sfe introduc yao theoret curios develop year sfe vast effici comput function sfe slower privaci preserv manner garbl circuit describ yao power mechan perform sfe modern variant allow malici secur complex program mobil devic power ubiquit user expect servic access sfe perform mobil devic resourc constraint tight extrem slow putat exhaust mem ori happen trivial input size algo rithm allow mobil devic perform sfe server aid comput model allow ing major sfe comput outsourc power devic preserv privaci approach consid way mobil comput differ desktop bile devic call perform increment oper continu previous comput consid exampl friend finder applic locat user updat period determin contact proxim tradit applic disclos locat central server privaci preserv friend finder perform oper mutual oblivi fashion increment cation updat requir full evalu func tion fresh input standard sfe solut amin outsourc sfe scheme mobil devic carter hereon cmtb determin cryptograph consist check perform input sfe comput constitut great est bottleneck perform addit applic requir abil save state featur current garbl circuit impl mentat possess abil save state reus intermedi garbl circuit execu tion way split larg comput number smaller piec combin effici input valid extrem attract proposit paper reus crypt outsourc sfe comput cut choos garbl circuit protocol strict primit standard garbl cir cuit system partialgc base cmtb encrypt output wire valu sfe comput save reus input wire garbl circuit method vast duce number cryptograph oper compar trivial mechan simpli time pad requir generat insid cir cuit input larg time pad complex oper improv input valid mechan propos shelat shen hereon method partial input gate check evalu ation improv previous propos approach creation reusabl garbl circuit previous work reus encrypt valu oram model earlier scheme implement contrast implement scheme practic effici provid perform analysi sampl applic garbl circuit garbl circuit garbl circuit figur partialgc overview evalu gen erat blue box standard execut produc partial output garbl valu yellow box repres exe cution partial input produc partial output generat cloud generat cloud outsourc sfe comput outsourc sfe comput save valu save valu figur system three parti cloud generat save intermedi valu phone comput illustr feasibl well simplifi exampl execut appendix break larg program smaller piec sys tem allow interact garbl circuit comput best knowledg practic protocol perform interact mid dle cut choos garbl circuit comput system compris three parti generat eval uator third parti cloud evalu outsourc comput protocol cure malici adversari assum collus parti cloud provid semi honest version protocol figur partialgc work high level standard sfe execut blue take place save intermedi output valu execut intermedi valu previous execut order reus valu parti generat evalu save protocol cloud evalu save allow multipl distinct evalu particip larg comput time save state cloud garbl circuit execu tion exampl scenario mobil phone outsourc comput cloud partialgc save encrypt intermedi output cloud phone figur allow phone communic store encrypt intermedi valu cloud effici requir direct particip save valu requir earlier sfe system friend finder applic built android devic reflect usag model allow multipl friend share intermedi valu cloud friend save valu check map cell hav ing copi send data incorpor optim contribut reusabl encrypt valu reus encrypt garbl circuit map garbl reduc runtim bandwidth reusabl encrypt valu practic reduc execut time garbl circuit comput reduct runtim reduct band width cmtb impress reduc amount bandwidth requir mobil parti arbitrarili input check perform partial intermedi input protocol outsourc state applic sys tem increas scope sfe applic allow multipl evalu parti period time erat save state sfe comput parti remaind paper organ background sfe introduc concept partial garbl circuit detail partialgc protocol implement describ secur analyz evalu ate partialgc introduc friend finder applic discuss work conclud background secur function evalu sfe address scenario mutual distrust parti privat input comput function output receiv learn logic impli exist trust third parti pis simpli send input trust parti evalu function return yis sfe propos semin area studi extens cryp tographi communiti lead creation gen eral purpos platform sfe fairplay earli today exist platform classic platform sfe includ fairplay garbl circuit garbl circuit boolean circuit encrypt evalu proper input wire enter parti evalu circuit learn partic ular wire repres sfe parti generat creat garbl circuit evalua tor evalu garbl circuit addit crypto graphic techniqu input output discuss input boolean gate truth tabl entri input garbl gate truth tabl repres entri encrypt retriev proper key valu repres random string bit truth tabl entri permut evalu determin entri crypt decrypt entri entireti garbl gate encrypt output valu garbl gate encrypt entri truth tabl encrypt input wire lead result truthi enc inputx inputi outputi truthi truth tabl inputx input wire inputi input wire outputi encrypt repres enc function evalu inputx inputi receiv outputi encrypt truth tabl evalu input oblivi transfer parti offer valu parti select valu learn parti offer valu learn select techniqu evalu wire label input leak evalu correct output garbl gate correct decrypt key specif entri truth tabl well locat decrypt permut stage simpli dom permut valu generat permut valu base specif bit inputx inputi inputx inputi evalu locat entri decrypt bitx biti bit call permut bit evalu select base permut optim leak point permut threat model tradit threat model discuss sfe work semi honest malici descript garbl circuit threat model semi honest model user stay true protocol attempt learn extra system messag receiv malici model user attempt chang goal learn extra incorrect detect extra techniqu achiev secur malici adversari well attack malici adver sari garbl circuit protocol protocol secur malici adversari solut potenti pitfal describ turn generat incorrect circuit generat creat correct garbl circuit learn extra infor mation modifi truth tabl valu output eval input limit extern structur garbl circuit evalu expect select failur input generat offer correct input wire evalu evalu select wire creat proper generat learn singl bit base comput produc correct output input consist input consist circuit extra infor mation retriev output consist parti case output con sistenc check verifi evalu modifi output send collus cmtb assum collus quot outsourc parti sfe protocol secur comput function corrupt scenario cloud malici cooper respect rest parti parti semi honest parti malici cloud semi honest standard definit collus server aid work kamara collus parti trust parti work order cheat cmtb individu parti attempt cheat gain addit will caught collus tween multipl parti leak instanc generat send cloud key decrypt circuit intermedi valu gar bled function partial garbl circuit introduc concept partial garbl circuit pgcs allow encrypt wire output sfe putat input complish map encrypt output wire valu valid input wire valu comput order better demonstr structur pgcs semi honest set show aid malici adversari pgcs semi honest model semi honest model wire gen erat simpli send valu evalu transform wire label evalu own work garbl circuit depend point permut bit wire label receiv evalu map previous garbl circuit comput valid wire label comput wire pair generat wire creat wire refer comput seri cor respond valu point permut bit valu generat send valu evalu depend point permut bit possess evalu select correct xor wti wti valid partial input wire pgcs malici model malici model allow evalu circuit partial input verif map prevent select failur attack fea ture accomplish goal verifi map generat creat cure map save garbl wire comput check evalu revers map evalua tion check phase verifi map commit map fore decid partit evalu check circuit learn circuit check versus evalu set partial generat partial evalu creat garbl gate enter output intermedi encrypt valu garbl circuit garbl gate call partial input gate input garbl circuit input garbl circuit input input partial input gate partial input gate remaind garbl circuit figur figur creat singl partial input gate input bit circuit link partial input gate remaind circuit figur garbl circuit piec partial input gate remaind garbl circuit reveal incorrect transform goal inform incorrect valu detect limit leakag gain base inform caught cheat ing select failur attack protocol partialgc protocol start cmtb protocol add cut choos oper introduc mechan need save reus valu defer origin paper full detail outsourc oblivi tran fer input consist check protocol primit protocol system oper threat model cmtb secur malici adver sari assumpt collus descript cmtb protocol appendix preliminari three particip protocol generat generat parti generat garbl circuit sfe evalu evalu parti sfe outsourc comput cloud cloud cloud third parti execut garbl circuit outsourc evalu notat ith circuit ckeyi circuit key free xor optim key random generat differ enc wire label circuit cseedi creat prng generat circuit pout partial output valu encrypt wire valu output sfe comput encrypt garbl circuit valu reus garbl circuit comput replac protocol descrip tion signifi repres unknown point view denot circuit pout denot wire pouti circuit pin partial input valu enter pout valu obfusc remov circuit key previous comput valu input partial input gate gin garbl circuit input valu partial input gate input remain garbl circuit figur partial input gate garbl gate pin valu output gin valu purpos transform pin valu valu ckeyi current circuit algorithm partialcomput input circuit file bit secur number circuit input execut output circuit file output cut_and_choos execut eval garbl input evaluator_input eval select bit eval input generator_input_check gen input partial garbl input partial_input partial outputtim garbl output partial output circuit_execut garbl input gen eval partial circuit_output garbl output partial_output partial output protocol comput contain explicit describ save protocol properti singl comput random comput common input program circuit file bit level secu riti circuit level secur number circuit encrypt commit function privat input input evlinput genera input geninput output evalu generat receiv gar bled circuit output phase prepar cut choos prepar generat creat seed circuit cseedi prepar circuit output gen erat evalu output time pad crypt insid circuit augment cir cuit outevl outevl outputkeyevl outgen outgen outkeygen outevl outgen initi output generat input extend includ correspond outputkey bit secret key mac techniqu cmtb input encod split input bit bitj bitj evlinputj jth bit generat creat circuit creat input generat creat key ikeyi ith cir cuit set seed len evlinput seed creat bit repres garbl input valu creat hash ikeyi hash ikeyi cmtb input mute circuit prevent cloud algorithm cut choos input execut execut circuitselect rand bit vector size number evalu circuit generat creat garbl input circuit seed circuit cseedi rand garbledgeninputi garbl geninput rand generat creat load key execut checkkeyi rand evlkeyi rand loadkey checkkeyi hash loadedcheckkeyi evlkeyi hash loadedevlkeyi encrypt uniqu time xor pad encseedini cseedi evlkeyi encgarbledini garbledgeninputi checkkeyi execut generat offer input key circuit seed selectedkey circuitselect evlkey checkkey loadselectedkey gensendtoev hash checkkeyi hash evaluationkeyi cloudsendtoev hash selectedkeyi ischeckcircu valu match evalu learn split abort ischeckcircu correct recievedgeni recievedevli correct abort understand input map gen erat commit input cloud will verifi swap valu cut choos protocol commit circuit execut cut choos modifi cut choos mechan describ extra parti involv comput cut choos cloud select circuit evalua tion circuit circuit check circuit circuitselect evalu circuit check circuit evalu circuit check circuit select generat learn circuit select generat generat garbl version input circuit seed circuit encrypt valu ing uniqu time xor pad key circuit encrypt input garbledgeninputi garbleinput geninput checkkeyi evlkeyi encgarbledini garbledgeninputi evlkeyi encseedini cseedi checkkeyi encinputevl garbledinputevl checkkeyi garbleinput take input produc vec tor bit string bit input garbledinputevl garbl len len len length evlinput cloud generat perform oblivi transfer generat offer decrypt key input decrypt key circuit seed eval input circuit cloud select key decrypt input key decrypt circuit seed input circuit selectedkey circuitselect evlkey checkkey circuit cloud select decrypt key circuit seed input obliv ious transfer circuit check circuit cloud select key input circuit evalu circuit generat send encrypt garbl input check circuit circuit cloud cloud decrypt decrypt key cloud generat save decrypt key futur comput save valu evalu learn circuit split generat send hash encrypt key cloud select evalu circuit order pair gensend hash checkkeyi hash evaluationkeyi cloud send hash receiv evalu circuit cloud send bit indic circuit select check evalu circuit evalu cloudsend hash selectedkeyi ischeckcircu evalu compar hash cloud hash generat select circuit select cloud ischeckcircu correct receivedgeni receivedevli valu match evalu ischeckcircu learn split check evalu circuit oth erwis abort perform cut choos oblivi transfer initi comput subsequ comput generat evalu hash save decrypt key hash encrypt decrypt key circuit split select cloud save stay comput conclus step cloud evalu evalu circuit generat input evalu circuit cloud valid check circuit generat send circuit seed input check circuit cloud evalu check evalu circuit split generat circuit split phase input oblivi transfer algorithm evalu input input eval select bit eval input output eval garbl input cloud select input wire generat offer input wire valu input wire evalu select input outse baseoot bitsevl possibleinput generat send uniqu ikey valu circuit evalu gensendtoev ikeyi evalu send ikey valu evalu circuit cloud ischeckcircuit evalsendtocloud ikeyi cloud learn appropri input len evlinput ischeckcircuit inputevlij hash ikeysi outseedsj return inputevl base outsourc oblivi transfer oot cmtb oot evalu enter input but generat enter input evalu generat perform singl oper fore extend ishai extens input bit extend input bit tend garbl circuit techniqu describ algorithm oot finish cloud select input wire valu repres input cmtb singl oot seed creat input circuit cloud system seed singl base call baseoot generat input eval uation circuit cloud receiv seed input bit select evalu outse baseoot evlinput evlinputse outse seed select input generat send ikeyi key phase evalu circuit evalu send key evalu circuit cloud cloud key outse attain len evlinput ischeckcircuit inputevlij hash ikeyi outseedsj phase input consist check input consist check check univers hash prove consist genera input evalu circuit attain phase simpli hash evalua tion circuit generat enter consist input formal hash input circuit ischeckcircuit uhf garbledgeninputi algorithm generat input check input generat input cloud take hash input evalu circuit ischeckcircuit uhf garbledgeninputi singl hash cloud generat cheat correct correct abort univers hash compar sin gle hash cloud generat cheat correct phase partial input gate generat check evalu generat len savedwir gener ator creat partial input gate transform save valu valu current garbl circuit execut circuit generat creat pseu dorandom transform assist transform set generat xor hash function determin permut bit hash remov permut bit hash hash setppbitgen function setppbitgen pseudo random find bit valu wire note bit permut bit setppbitgen seed cseedi allow cloud regener valu check circuit pair set valu creat master key ckeyi differ wire label circuit classic garbl gate style truth tabl valu creat truth tabl permut permut bit cloud entri select partial input gate consist permut valu bit locat setppbitgen cloud check check circuit ischeckcircuit true len savedwir cloud receiv truth tabl bit locat setppbitgen proceed generat gate base check circuit cloud generat algorithm partial input input partial output output partial garbl input generat generat creat partial input gate transform save valu valu current garbl circuit execut len savedwir hash hash setppbitgen gensendtocloud permut permut bit locat gensendtocloud check cloud check gate sure generat cheat ischeckcircuit len savedwir cloud receiv truth tabl bit locat setppbitgen correct generategatefrominfo receivedgatefromgen gate match cloud generat cheat correct abort evalu ischeckcircuit len savedwir cloud save poutxi locat point permut bit generat creat pinxi pinxi setppbitev hash poutxi locat pinxi cloud select proper truth tabl entri ttxi decrypt creat ginxi enter garbl circuit ginxi ttxi poutxi return gin save previous execut cseedi recov cut choos generat par tial input gate manner describ cloud compar gate genera tor gate match cloud generat cheat evalu ischeckcircuit len savedwir cloud receiv truth tabl informa tion ttai ttbi bit locat setppbitgen denot permut truth tabl val cloud save poutxi creat pinxi pinxi setppbitev hash poutxi locat locat locat point permut bit generat point permut bit pinxi cloud select proper truth tabl ttxi ttai ttbi decrypt creat ginxi enter ginxi garbl circuit ginxi ttxi poutxi phase circuit generat evalu algorithm circuit execut input generat input evalu input partial input output partial output garbl output generat generat garbl gate send cloud depend circuit check evalu circuit cloud verifi gate correct evalu gate len circuit gengat send cloud receiv gate circuit check evalu circuit len circuit recvgat ischeckcircuit verifycorrect abort eval return partial output garbl output circuit generat generat generat garbl gate circuit send cloud generat check evalu circuit split chang generat check evalu circuit len circuit garbleg send circuit evalu check cloud receiv garbl gate circuit eval uation circuit cloud evalu garbl gate check circuit cloud generat correct gate base circuit seed verifi correct len circuit recvgat ischeckcircuit verifycorrect eval garbl gate correct cloud inform evalu generat incorrect gate safe abort phase output output consist check algorithm circuit output input garbl output mac output generat insid garbl circuit garbl circuit output mac encrypt time pad outevlcomplet outevl mac outevl result outevlmac mac outevl result abort output check fail final step garbl circuit execut mac output generat insid garbl circuit base bit secret key enter function outevlcomplet outevl mac outevl garbl circuit output mac encrypt time pad phase leav garbl circuit receiv output garbl circuit particu lar output bit major vote evalu circuit ischeckcircuit result major couti couti output bit ith circuit jth output bit circuit cloud send correspond encrypt time pad introduc phase output parti generat evalu decrypt receiv ciphertext time pad key perform mac real output verifi cloud modifi output compar generat mac mac calcul garbl circuit result outevlmac mac outevl parti generat evalu output phase partial output algorithm partial output input partial output len partial output generat save wire valu gensav partial gensav partial len partial output ischeckcircuit evlsav partial evlsav partial circuit evalu circuit evlsav partial outputxi generat save wire valu partial output wire evalu circuit cloud save partial output wire check circuit cloud save output valu implement garbl circuit system stage implement stage compil cre ate garbl circuit second stage execut system evalu circuit modifi compil kreuter hereon compil allow save intermedi wire label load wire label sfe compu tation compil ben efit compar circuit ident size function system cmtb protocol compar circuit vast differ ent size execut system start cmtb sys tem modifi protocol requir partialgc automat perform output consist check implement check circuit level awar correct issu cmtb relat ing primit oper input input perform outsourc oblivi transfer high circuit paramet low general secur paramet input fix reduc time oot exact amount vari secur partialgc provid proof partialgc pro tocol show protocol preserv standard curiti guarante provid tradit garbl circuit parti learn pri vate input parti logic impli output receiv high level overview proof model def init secur guarante full proof proof sketch protocol describ cmtb allow garbl individu circuit secur outsourc evalu paper modifi portion protocol allow transform output wire valu previous circuit execut input wire valu circuit execut transform valu check evalu creat generat circuit seed aspect notabl novel cut choos techniqu ensur generat learn circuit evalu check generat creat correct transform valu cut choos circuit assum cmtb garbl circuit scheme secur garbl circuit individu circuit execut circuit subsequ execut focus chang execut subs quent execut introduc partialgc differ initi garbl circuit ecut garbl circuit cmtb output wire initi partialgc circuit store cloud deliv generat evalua tor prevent learn output wire label initi circuit secur cmtb addit step subsequ circuit garbl differ ordinari cmtb garbl circuit addit row gate set partial input gate gate chang output wire differ normal gar bled gate label input wire chosen random generat deriv label output wire initi garbl circuit reduc secur partialgc input label partial input gate properti label ordinari garbl input gate generat label correspond input evalu label correspond input label input exact output initi garbl circuit output label save evalu evalu learn output label output gate output garbl gate encrypt evalu learn output label result evalu garbl circuit origin garbl circuit scheme secur generat generat initi garbl circuit input label partial eval uation gate save potenti output label initi output gate outsourc oblivi transfer cmtb generat input label initi garbl circuit will determin output label circuit generat will likewis input label subsequ garbl circuit model definit protocol assum par tie involv collud cloud theoret limit exist consid collus secur multiparti comput scheme consid ere secur comput multipl parti requir sim ilar restrict parti collud preserv secur outsourc protocol cure generat cloud malici collud impli secur parti scheme parti linear work respect size circuit current fulli homo morphic encrypt make assumpt cloud will collud particip parti outsourc secur theoret possibl reput cloud provid allow extern parti illeg control modifi computa tion system assum cloud will automat semi honest exampl protocol quir number consist check perform cloud ensur particip cheat mechan forc cloud check lazi cloud provid save resourc simpli return check verifi perform work kamara formal idea collud cloud base ideal model real model curiti definit common secur multiparti computa tion appli definit protocol parti case describ real model execut protocol take place parti execut protocol server execut parti input aux iliari input random coin server auxiliari input random coin exist subset independ parti malici adversari adversari corrupt ecut parti share adversari honest parti outi output corrupt parti outi view pro tocol execut ith partial output real execut defin real outj outi set honest parti random coin player ideal model execut ideal model setup particip parti inter act trust parti evalu function parti provid input auxiliari input random coin parti semi honest actual put trust parti parti malici collud arbitrari input valu case server simpli provid aux iliari input random coin input provid function evalu function evalu ate trust third parti return result parti server ceiv output parti abort earli send trust parti abort honest parti outi output trust parti corrupt parti outi output ith partial output ideal execut pres enc set independ simul defin ideal outj outi set honest parti random coin player definit protocol secur comput function exist set probabilist polynomi time ppt simul simi ppt adversari real ideal simi random uniform secur guarante input consist check cut choos multipl copi garbl circuit construct check evalu malici generat provid inconsist input evalu circuit function inconsist input extract input claim generat protocol trick evalu input evalu circuit greater neglig probabl input consist check defer proof provid paper note simul construct licious generat resp evalu work resp ideal model honest evalu resp generat real model note problem allow cloud perform check inconsist input pass check cloud malici input ignor violat collus assumpt valid evalu input ensur generat learn input corrupt garbl valu cmtb random input code techniqu lindel pinka techniqu allow evalu encod input bit xor set input bit generat corrupt input bit select failur attack reveal true input addit commit techniqu employ kreuter ensur generat swap garbl input wire label accomplish generat commit wire label cut choos cut choos input label check circuit open ensur correspond circuit oot commit key label will evalu wire label protocol implement techniqu direct previous work addit claim secur correct save valu scenario parti enter incorrect valu comput reduc solv problem garbl circuit generat correct valu reduc problem creat incor rect garbl circuit evalu correct save valu reduc problem evalu enter garbag valu garbl circuit execut caught output consist check garbl circuit generat ensur evalu circuit generat honest requir properti limit abil trick evalu evalu corrupt circuit cut choos techniqu typic parti garbl circuit evalu second ensur lazi cloud attempt conserv system resourc bypass circuit check step discov claim secur assum hash function uhf phase collis resist hash commit scheme fulli bind generat best probabl trick evalu evalu major corrupt circuit number circuit generat claim direct probabl generat find hash collis fool evalu rang hash function claim proof work assum hash function collis resist cloud neglig prob abil produc check hash pass seed check generat check circuit state circuit check generat send evalu hash circuit gci evalu circuit select cloud generat circuit hash check hash cloud attempt skip generat check circuit generat hash valu chk base secur guarante hash collus properti cloud neglig probabl correct generat hash valu abort check failur check circuit fail cloud report correct check circuit generat evalu point remain comput save valu abandon standard sfe cloud abort incorrect evalu circuit incorrect concaten incorrect circuit generat produc singl incorrect circuit cloud abort generat learn circuit evalu check circuit leak input output computa tion generat corrupt major evalu circuit modifi check circuit incorrect circuit undetect execut subsequ execut long total amount incorrect circuit major evalu circuit multipl evalu benefit outsourc scheme state save generat cloud allow evalu comput group user work singl server sfe secur malici adversari malici server parti malici play portion comput input gain singl putat problem system server generat cloud semi honest collus obviat attack state threat model comput involv gen erat cloud extend threat model parti comput collus singular comput malici parti chang comput long chain malici user link generat cloud break collus assumpt proof formal prove secur protocol theorem secur guarante ident cmtb protocol kamara theorem outsourc parti sfe protocol cure comput function cor ruption scenario cloud malici cooper respect rest parti parti semi honest parti malici cloud semi honest proof demonstr real ideal generat evalu cloud consid separ case parti deviat protocol case reveal dition consid point parti interact remain portion proof call generat evalu cloud denot parti malici malici evalu generat cloud particip honest protocol protocol execut evalu exchang messag particip cer tain point cut choos oblivi transfer send ing decrypt oot check input consist receiv proof valid output garbl circuit sim ulat ensur section protocol indistinguish adversari consid phase proof compris hybrid experi lemma simul random number generat coin flip experi real run fair coin toss protocol experi choos random string coin flip simul scoinflip pro duce protocol messag output lemma real proof base secur fair coin toss protocol exist simul scoinflip interact scoinflip indistinguish real protocol interact exact inreal prove lemma simul primit experi outsourc obliv ious transfer experi invok simul sot simul primit oblivi transfer oper simul send random string receiv column matrix lemma proof base malici secur primit exist simul sot teract simul indistinguish real execut oblivi transfer protocol ident prove lemma check output oot experi experi abort matrix form correct incon sistent input valu column generat lemma proof consid case send column ith bit row ith bit will encrypt entri send cloud decrypt cloud will decrypt ith choic will decrypt entri entri will result invalid decrypt probabl neglig decrypt high probabl valid commit key garbl valu commit caus cloud abort experi observ mes sage recov check consist cloud abort inconsist detect simul consist check substitut put experi experi string zero denot consist check replac input lemma proof cite proof shelat scheme messag scheme ident content simpli chang entiti send messag experi lemma hold output output consist check experi ident return circuit experi result trust extern oracl lemma proof base secur garbl circuit trust third parti output circuit output will indistin guishabl provid input bit secret key output produc mac time pad simul major vote trivial eval uator decrypt ciphertext otp key perform mac output compar mac produc garbl circuit indistinguish circuit version output ensur mac ident malici generat evalu cloud particip hon est protocol simul cut choos experi real oblivi transfer generat offer decrypt key input well circuit seed possi ble input circuit random choos check evalu circuit lemma real proof generat learn circuit split secur oblivi transfer portion protocol indistinguish real version perform check decrypt requir key need check abort select failur attack help distinguish experi real version simul experi primit oblivi transfer experi generat random input string random matrix run simul sot exact element pair depend ith select bit lemma proof base secur primit scheme simul sot exist recov select bit interact interact indistinguish real execut learn distinguish input base secur primit indistinguish hold experi check output oot experi experi check valid output oot experi possess recov oblivi transfer simul sot previous hybrid experi check encrypt set output well form experi abort lemma proof recal mat output oot correct cloud will fail recov valid commit key probabl neglig secur paramet case commit garbl circuit label will fail decrypt proper cloud will abort protocol experi valu trivial check correct form failur select failur attack help distinguish experi real ver sion swap input label commit check input consist recov input experi experi recov input input consist check dom seed recov consist check pass input recov experi abort lemma proof experi perform hash genera input evalu circuit split hash generat cheat abort cloud real version protocol generat check evalu partial input gate experi check cir cuit experi data generat well cseedi recov dur ing cut choos generat partial input gate manner phase compar gate generat gate match generat cheat evalu circuit find point permut bit produc ginxi need futur hybrid lemma proof experi pout valu previous hybrid receiv bit locat setppbitgen cseedi generat partial input gate describ phase perform check split generat ginxi valu evalua tion circuit enter garbl circuit cloud real version protocol simul output check experi output phase experi prepar result receiv trust third parti output output circuit lemma proof base secur garbl circuit trust third parti output circuit output will indistin guishabl provid input bit secret key output pro duce mac time pad simul major vote trivial experi ment decrypt ciphertext otp key perform mac output compar mac produc garbl circuit indistinguish circuit version appropri otp key malici cloud generat evalu particip honest protocol replac input oot experi real dur ing oot experi replac input string zero l·n select garbl input valu oot forward protocol lemma real proof real execut will observ random trix encrypt commit key input permut string dom indistinguish random generat real trivial indistinguish consid output pair half commit key select will consist valu comput indistinguish random hash key recov find collis hash random distinguish execut oot input input replac rest protocol real exact prove lemma replac input consist check experi experi replac input zero prepar check protocol consist eval uation circuit lemma proof hybrid observ set garbl input wire valu base secur garbl circuit serv set garbl input wire valu indistinguish observ set input wire valu distinguish garbl input garbl input rest hybrid partial gate experi experi send appropri truth tabl pout valu bit locat setppbitgen lemma proof hybrid observ set garbl wire truth tabl valu partial gate iden tical garbl circuit gate oper concern secur garbl circuit ensur observ set garbl input wire valu indistinguish observ set wire valu distinguish garbl gar bled rest hybrid check output experi circuit evalu experi check result output expect experi abort lemma proof cloud send output otp phase decrypt otp previous hybrid perform mac pare mac calcul garbl circuit verifi modifi output perform evalu demonstr efficaci partialgc comparison cmtb outsourc system apart perform gain cut choos partialgc benefit generat partial input valu execut program subsequ execut partial input amort cost execut bandwidth demonstr evalu system mobil devic outsourc comput power system devic server class machin evalu general system test environ includ core server ram model generat outsourc proxi parti separ program generat outsourc proxi thread evalu samsung galaxi nexus phone ghz dual core arm cortex ram run android connect server mbps wifi isol environ test singl server process evalu test creat process core server well cmtb implement comparison test setup execut time partialgc system well suit plex comput requir multipl stage sav ing intermedi state previous garbl circuit execut system focus singl transact evalu comput millionair problem joint evalua tion parti input greater reveal valu input evalu circuit evalu consid comparison improv ment system compar cmtb reus save valu compar protocol save reus valu cmtb reus implement protocol benchmark overhead sav ing load valu bit basi circuit number achiev secur paramet malici model case iter test time confid inter val vari number circuit system paramet set bit secur program evalu exemplar differ input size differ circuit complex key databas program parti enter databas key parti enter key index databas receiv databas entri key exampl program express small circuit larg amount input matrix multipl parti enter bit number fill matrix matrix multipl perform matrix output parti exampl program larg amount input larg circuit edit levenstein distanc program find dis tanc string length return differ exampl program small number input medium size circuit millionair classic sfe program parti ter result bit output parti greater smaller parti exampl small circuit larg amount input gate count program ble differ program describ addit mac function partialgc dis cuss reason check tabl experiment test best case execut time reduc factor cmtb second second speedup cmtb ultim system outperform cmtb input check bottleneck time improv improv ment occur key databas millionair matrix multipl program program edit distanc input check bottleneck partialgc outperform cmtb total time increas edit distanc problem overhead cut choos tech niqu requir send gate evalu check circuit evalu circuit discuss fur ther typic case imagin system key databas program larg amount input small circuit expand case reus valu test wire save capabl test dynam program problem longest common substr partialgc cmtb program determin length longest common substr string singl comput solu tion version increment add singl bit input string time comput output time evalu realist comparison real applic crement add data comput faster save intermedi state add ing intermedi result rerun entir comput time result test partialgc techniqu reus cmtb partialgc keyeddb keyeddb keyeddb edit distanc millionair lcs increment lcs increment lcs increment lcs full lcs full tabl xor gate count circuit circuit differ cmtb partialgc gate count consist check explan differ size increment version longest common substr lcs reus valu circuit circuit circuit cmtb partialgc cmtb partialgc cmtb partialgc keyeddb keyeddb keyeddb edit distanc millionair tabl time compar partialgc cmtb save valu time second program partialgc cmtb cmtb full figur test largest common substr lcs program partialgc cmtb chang singl input effici der partialgc cmtb program cmtb crash run lcs increment size memori quirement unabl complet compil cmtb full size wire valu cmtb save desir intern bit time pad enter putat well need decrypt ciphertext mac circuit verifi parti save output bit modifi generat time pad insid garbl circuit cryp tograph secur function cmtb parti enter privat key mac function program label cmtb cmtb increment size program repres size total string cre ate circuit comput complet longest common substr comput label cmtb full size partialgc cmtb circuit tabl figur result save reus valu par tialgc effici complet rerun putat input consist check add consider memori phone cmtb case input bit cmtb program will complet case bit cmtb full program complet compil hour cmtb program assum cloud save output bit multipl phone share privat key note growth cmtb cmtb full cmtb full grow larger rate factor increas cmtb factor increas impli ficient rerun program small chang desir input eventu will case effici function cmtb faster bottleneck input size circuit overhead save reus valu discuss appendix outsourc server process partialgc scenario sourc mobil devic outsourc garbl circuit evalu singl server process retain perfor manc benefit singl server process cmtb experi outsourc parti singl thread tabl display keyeddb program partialgc speedup cmtb outsourc mobil case key databas prob lem perform well partialgc comput intens input consist check greater bottleneck mobil devic server improv ment program dramat edit distanc matrix multipl program ben efit higher comput power bottleneck circuit circuit circuit cmtb partialgc cmtb partialgc cmtb partialgc keyeddb keyeddb keyeddb edit distanc millionair tabl time outsourc garbl circuit evalu singl server process second circuit cmtb partialgc keyeddb keyeddb keyeddb edit distanc millionair tabl bandwidth comparison cmtb partialgc bandwidth count instrument partialgc count byte send receiv byte server longer input consist result execut faster cmtb partialgc bandwidth main reason outsourc comput save resourc show decreas bandwidth bandwidth count make evalu count number byte partialgc send receiv server best result reduct bandwidth tabl edit distanc extra bandwidth outsourc oblivi tran fer circuit evalu circuit exceed benefit receiv secur friend finder privaci preserv applic benefit ing partialgc cach valu state case studi develop privaci preserv friend finder applic user locat nearbi friend user vulg exact locat applic differ ent mobil phone client consist generat server applic outsourc comput cloud gen erat comput cloud comput cloud generat parti comput map updat partialgc save current state map wire label partialgc outsourc valu cloud wire label transfer direct mobil devic make multi user appli cation difficult imposs defin three privaci preserv oper prise function mapstart three parti generat evalu cloud creat blank map region locat map blank remain mobil parti set locat mapset mobil parti set singl map cell program take partial valu mapstart mapset mapget program map size map size figur time comparison map program map size generat cloud output locat select mobil parti mapget mobil parti retriev content sin gle map cell program retriev partial valu generat cloud output set cell mobil applic user secur friend finder uniqu repres map divid map cell cell set amount area user press set locat program will determin cell occupi cell occupi user inform friend cell updat user remov previous locat assum maximum friend applic cell map bit figur perform program malici model secur paramet evalu circuit consid map region cell map cell oper take second three oper set locat event total execut time second execut time cell minut bottleneck cell map outsourc oblivi transfer number cell map vast larger circuit associ ate cell map set valu slower oper applic practic scenario exampl exampl friend initi friend finder comput amazon cloud face book generat friend coffe cafe second friend ride bike messag cell map figur take second oper locat select comput figur screenshot applic map radio button user select indic posit result set posit press user applic set map locat map imag googl map friend nearbi minut find cafe applic prevent amazon facebook know locat learn nearbi discuss analysi improv analyz improv three place improv consist check save reus valu fix oblivi tran fer case consist check reason improv network traf fic second symmetr key oper exponenti case save reus valu save time faster input consist check requir user recomput circuit multipl time last reduc runtim bandwidth fix part oot previous outsourc oblivi tran fer perform primit number circuit time singl time turn forc extra exponenti amount improv vari depend circuit output check garbl circuit larger output check check perform cryptograph oper outsourc parti evalu perform mac output garbl circuit check demonstr mac effici output check low power devic comput power equival parti commit cut choos cut choos unexpect cut choos partialgc slower commit cut choos cmtb periment setup theoret requir fewer cryptograph oper generat garbl circuit faster protocol differ tween cut choos protocol network usag circuit cmtb circuit transmit cut choos requir protocol cloud check gener ator creat correct gate implement optim proceed optim system light slow compar cmtb circuit larg amount gate chang turn turn default cmtb cmtb base hand optim garbl gate generat evalu remov excess memori oper remov network xor gate under implement byte spurious transmit xor gate batch process gate reduc overhead network gate remov unnecessari hash call exist partialgc artifact built cmtb correct under implement correct implement par tialgc artifact under implement error kss cmtb perform chang cor rect phase cmtb add miss input encod phase suppos exist kss error straightforward perform singl set extend circuit singl set cmtb matrix transform perform circuit singl matrix tran format remov error correct singl set perform extend manner protocol descript correct second error miss input encod step evalua input note kss subsequ system built input encod input encod select failur attack perform easili generat order gain singl bit input correct optim implement tabl correct optim implement partialgc observ fol low program larg input gate slower fix error input encod millionair program larg circuit size compar input size generat evalu improv runtim perform edit distanc program test high input high gate count improv matrix mult program reli input size low amount gate unaffect chang input encod improv optim garbl gate time key circuit circuit circuit imp orig imp orig imp orig keyeddb keyeddb keyeddb editdist millionair tabl compar origin partialgc improv version partialgc second sfe engin insight experi build framework provid insight runtim describ intuit pro tocol incorrect implement instanc averag time eval uat garbl gate greater averag time gen erat garbl gate problem garbl circuit evalu phase compar time garbl evalu interest evalu total time full garbl circuit garbl evalu clude network overhead insight network oper bottleneck practi cal system includ network usag effect cut choos protocol time take gate interpret circuit file implement check verifi protocol step exist implement implement check circuit layer expos user worth time save encod direct garbl circuit experi output consist check difficult creat correct test program ensur featur develop compil execut system thorough unit test work sfe describ yao semin paper subject general purpos platform sfe fairplay creat fairplay piler creat garbl circuit time system execut comput involv three par tie examin earliest exampl fairplaymp multipl impl mentat semi honest malici set optim garbl circuit includ free xor techniqu garbl row reduct rewrit compu tation minim sfe pipelin pipelin allow evalu proceed comput generat creat gate kreuter includ optim compil effici time system parallel impl mentat sfe malici model creation circuit sfe fast effici man ner central problem area previous piler fairplay base concept creat complet circuit optim pal improv system simpl templat circuit reduc memori usag order magnitud pcf built advanc represent reduc disk space method perform mpc involv homomorph encrypt secret share order binari decis diagram general privaci preserv putat protocol homomorph encrypt design mobil devic custom protocol design partic ular privaci preserv comput exampl kamara scale server aid privat set tersect billion element set custom protocol previous reusabl garbl circuit scheme includ branda homomorph encrypt gentri attribut base function encrypt goldwass introduc succinct func tional encrypt scheme previous work pure theoret experiment perform analysi theoret work reus encrypt garbl circuit valu oram model varieti techniqu includ garbl cir cuit ident base encrypt execut under ing low level oper program state read write queri scheme reus encrypt valu base complet techniqu enabl kind comput expand set thing comput garbl circuit quid pro quo tocol system allow fast execu tion singl bit leakag garbl circuit ecut parti switch role execut run secur protocol ensur output execut equival fail singl bit leak select failur attack conclus paper present partialgc server aid sfe scheme allow reus encrypt valu save cost valid allow save state cost multipl comput amort pare server aid outsourc scheme cmtb reduc cost comput bandwidth cost futur work will consid general iti encrypt scheme sfe evalu system larg scale system problem benefit addit state open intrigu way bring sfe practic realm acknowledg materi base sponsor defens advanc project agenc darpa air forc laboratori contract govern author reproduc distribut reprint government purpos notwithstand copyright notat thereon view conclus contain author interpret repres offici polici endors express impli darpa govern ment refer bellar micali interact oblivi transfer applic proceed advanc cryptolog crypto ben david nisan pinka fairplaymp system secur multi parti comput proceed acm confer comput communic secur ccs bendlin damg ard orlandi zakaria semi homomorph encrypt multiparti comput proceed annual intern confer theori applic cryptograph techniqu advanc cryptolog eurocrypt bogdanov laur willemson sharemind framework fast privaci preserv comput proceed european symposium comput secur esor branda secur parti comput reusabl bit commit cut choos forg lose techniqu technic report univers lisbon burkhart strasser dimitropoulo sepia privaci preserv aggreg multi domain network event statist proceed usenix confer secur secur carter amrutkar dacosta traynor phone custom protocol effici secur function evalu mobil devic journal secur communic network scn carter mood traynor butler secur outsourc garbl circuit evalu mobil devic proceed usenix secur symposium secur damg ard geisler krøigaard nielsen asynchron multiparti comput theori implement proceed intern confer practic theori public key cryptographi pkc gentri gorbunov halevi vaikuntanathan vinayagamurthi compress reusabl garbl circuit cryptolog eprint archiv report http gentri halevi ostrovski raykova wich garbl ram revisit advanc cryptolog eurocrypt gentri halevi smart homomorph evalu circuit proceed advanc cryptolog crypto goldwass kalai popa vaikuntanathan zeldovich reusabl garbl circuit succinct function encrypt proceed acm symposium theori comput stoc goyal mohassel smith effici parti multi parti comput covert adversari advanc cryptolog eurocrypt halevi lindel pinka secur comput web comput simultan interact advanc cryptolog crypto henecka sadeghi schneider wehrenberg tasti tool autom secur parti comput proceed acm confer comput communic secur ccs holzer franz katzenbeiss veith secur parti comput ansi proceed acm confer comput communic secur ccs huang evan katz malka faster secur parti comput garbl circuit proceed usenix secur symposium secur huang katz evan quid pro quo tocol strengthen semi honest protocol dual execut ieee symposium secur privaci oakland ishai kilian nissim petrank extend oblivi transfer effici advanc cryptolog crypto kamara mohassel raykova sadeghian scale privat set intersect billion element set technic report msr microsoft kamara mohassel riva salus system server aid secur function evalu proceed acm confer comput communic secur ccs kerschbaum express rewrit optim secur comput confer data applic secur privaci codaspi kiraz schoenmak protocol issu malici case garbl circuit construct proceed symposium theori benelux kolesnikov schneider improv garbl circuit free xor gate applic proceed intern colloquium automata languag program icalp kreuter mood shelat butler pcf portabl circuit format scalabl parti secur comput proceed usenix secur symposium secur kreuter shelat shen billion gate secur comput malici adversari proceed usenix secur symposium secur kruger jha goh boneh secur function evalu order binari decis diagram proceed acm confer comput communic secur ccs lindel pinka effici protocol secur parti comput presenc malici adversari advanc cryptolog eurocrypt ostrovski garbl ram program advanc cryptolog eurocrypt ostrovski garbl ram revisit cryptolog eprint archiv report http malkhi nisan pinka sella fairplay secur parti comput system proceed usenix secur symposium secur mood letaw butler memori effici garbl circuit generat mobil devic proceed ifca intern confer financi cryptographi data secur naor pinka oblivi transfer polynomi evalu proceed annual acm symposium theori comput stoc naor pinka effici oblivi transfer protocol proceed annual acm siam symposium discret algorithm soda pinka schneider smart william secur parti comput practic advanc cryptolog asiacrypt shelat shen output secur comput malici adversari advanc cryptolog eurocrypt shelat shen fast parti secur comput minim assumpt confer comput communic secur ccs yao protocol secur comput proceed ieee symposium foundat comput scienc foc zhang steel blanton picco general purpos compil privat distribut comput proceed acm confer comput communic secur ccs appendix cmtb protocol build cmtb garbl circuit exe cution system abbrevi version proto col descript refer generat cloud evalu cloud parti evalu sourc comput circuit generat check templat gar bled circuit augment add time xor pad output bit split input wire encod scheme generat generat garbl circuit commit send mitment evalu generat commit input label input cmtb reli goyal random seed check implement kreuter combat generat incorrect circuit techniqu cut choos style protocol determin genera tor creat correct circuit creat commit circuit circuit evalu check circuit input parti oblivi transfer perform three parti outsourc oblivi tran fer outsourc oblivi transfer select bit parti wire label return select wire label third parti parti select wire label learn wire bel parti input wire label learn wire select third parti learn select wire label cmtb generat offer wire label evalu select bit cloud receiv select label cmtb ishai extens reduc number cmtb encod techniqu lindel pinka prevent generat find format input select failur attack transpir cmtb commit tech niqu kreuter prevent generat swap output oblivi transfer ensur input consist cir cuit cmtb techniqu lindel pinka input deriv singl oblivi tran fer input consist check gener ator send input cloud evalu circuit generat evalu cloud work prove input consist input input consist check cmtb malleabl claw free construct shelat shen program load save figur amount time take save load bit partialgc circuit circuit evalu cloud evalu garbl cir cuit mark evalu check circuit mark check cloud enter generat eval input garbl circuit evalu circuit output bit joriti output evalu circuit cloud recreat check circuit cloud creat hash garbl circuit send hash evalu evalu verifi hash generat commit output consist check output three par tie prove cloud modifi output generat evalu evalu generat receiv respect output output blind respect time pad insid garbl circuit prevent cloud learn output bit repres cmtb xor time pad techniqu raz prevent evalu learn gener real output prevent output modif cmtb wit indistinguish knowledg proof kreuter overhead reus valu creat version key databas program determin runtim save load databas bit basi system figur figur save load larg amount save wire label short time time load wire label larger time save save involv save wire label file load involv read file creat partial input gate figur time save load singl bit increas circuit paramet copi bit circuit exampl program describ execut attend applic consid scenario host user sign phone log guest secret applic three distinct program program initi counter number input eval uator second program pro gram call take increment counter program output name return count user applic user mobil phone assum role evalu protocol host run initi program initi databas execut second program add name log reveal memori save protocol program cut choos execut select circuit split circuit evalu generat parti save cryption key cloud save key attain generat save key select cloud evalu perform oot parti input initi pro gram input generat input check execut partial input phase protocol skip garbl circuit set initi execut output generat evalu partial output produc cloud save garbl wire possess generat save wire valu generat cloud cloud save repres cloud save circuit split save memori program execut evalu input initi count save guest guest enter build execut pro gram enter guest input protocol second program second program cut choos execut generat cloud load save decrypt key valu hash valu check evalu circuit attain key break secur key save evalu perform oot generat input program check input skip exist partial input generat load wire valu creat partial input gate cloud load attain valu receiv partial input gate generat execut check partial input gate receiv garbl input valu garbl circuit execut partial output save data save program databas execut second program memori fol low count save guest guest enter dwell run program execut previous guest enter execut guest phone point memori count save guest guest enter dwell execut program point memori count save guest final host run program output count guest databas case count guest 