deep neural network base malwar detect dimension binari program featur joshua sax invincea lab llc konstantin berlin invincea lab llc kberlin abstract malwar remain serious problem corpora tion govern agenc individu attack continu tool frequent cost network intrus today malwar detect heurist signatur base method struggl malwar evolu tion machin learn hold promis autom work requir detect newli discov malwar famili learn general malwar benign softwar benignwar support detect entir unknown malwar famili propos machin learn ing base malwar detect method achiev low fals posit rate high scalabl requir deliv deploy detector paper introduc approach dress issu describ reproduc detail deep neural network base malwar detect sys tem invincea develop system achiev usabl detect rate extrem low fals posi tive rate scale real train exampl ume commod hardwar system achiev detect rate fals posit rate fpr base softwar binari sourc direct custom intern malwar databas achiev sult direct learn binari filter unpack manual separ binari file categori confirm fals posit rate direct live stream file come deploy endpoint solut provid esti mate binari file expect day enterpris network describ relat fals posit rate translat intuit threat score demonstr feasibl train deploy low resourc high accur author contribut equal work machin learn classif model fals posi tive rate approach tradit labor intens sig natur base method detect unseen malwar machin learn model tend improv larger data size forese deep neu ral network classif model gain layer network defens strategi come year introduct malwar continu facilit crime espionag unwant activ comput net work attack malwar key tool cam paign problem comput secur detect malwar stop achiev object expung discov vein categori detect proach propos includ hand rule signatur base approach requir analyst hand craft rule reason relev data detect hand machin learn approach automat reason malici benign data fit detect model param eter middl path method automat generat signatur puter secur industri knowledg favor manual automat creat rule signatur machin learn statist method low fals posit rate achiev rule signatur base method year confluenc three develop increas possibl suc cess machin learn base approach hold promis method achiev high detec tion rate low fals posit rate bur den human signatur generat requir manual method trend rise commer cial threat intellig feed provid larg ume malwar mean time time label malwar data secu riti communiti second trend comput power cheaper mean research rapid iter malwar detect machin learn model fit larger complex mod data third machin learn disciplin evolv mean research tool dispos craft detect model achiev breakthrough perform term accuraci scalabl paper introduc approach take advantag three trend deploy deep neural network base malwar detector static fea ture best report accuraci publish detect engin structur rest paper describ approach descrip tion featur extract method deep neural network bayesian calibr model tion provid multipl valid approach treat work survey relev mal ware detect compar propos method final conclud paper reiter find discuss plan futur work method full classif framework fig consist three main compon compo nent extract type complementari fea ture static benign malici binari second compon deep neural network classifi consist input layer hidden layer output layer final compon score cal ibrat translat output neural net work score realist interpret approxim probabl file malwar remaind describ model compon detail featur engin byte entropi histogram featur set featur comput input binari bin valu dimension byte entropi histogram model distribut byte extract byte entropi histogram slide featur extract contextu byte featur import featur string histogram featur metadata featur input layer input featur hidden layer prelu unit hidden layer prelu unit output layer sigmoid unit parametr score distribut estim deep neural network score calibr model bayesian estim malwar figur outlin malwar classif framework byte window input binari step size byte window comput base entropi window individu byte occur renc window uniqu valu comput entropi store pair list final comput dimension histogram pair list histogram entropi axi sixteen even size bin rang byte axi sixteen even size bin rang featur vector trix concaten row vector histogram singl vector intuit featur model content input file file format agnost practic repres byte valu entropi context occur separ byte valu occur context exampl instruct data exampl byte valu occur compress data import featur second set featur comput input binari deriv input import address tabl initi ray integ extract import address tabl binari program hash tupl dll import function rang increment associ counter featur array intuit import tabl dlls help model captur semant extern func tion call input binari reli detect heurist suspici file file combin import match mal ware famili hash larg number import function small array ensur featur space remain fix size scalabl practic find valu hash function neural network learn ing separ malwar benignwar evalu metadata featur final set fea ture deriv numer field extract target portabl execut packag ing portabl execut format standard mat execut window famili oper sys tem extract featur extract numer portabl execut field binari ing pefil python pars librari field textual compil timestamp import tabl aggreg length array motiv extract featur model opportun identifi heuri tical suspici aspect binari packag allow learn signatur captur individu malwar famili aggreg featur type construct final featur vector dimension featur vector describ con caten singl dimension featur vector cours search reduct data priori fix size small vector minor degrad accuraci model allow dra matic reduc memori cpu time load train model compar common approach assign categor column featur vector label train evalu model low fals posit rate requir accur label malwar benignwar binari accomplish run data virustot run binari malwar vote strategi decid file malwar benignwar label file anti virus engin alarm malwar file anti virus engin alarm benign ware purpos train accuraci evalu discard file anti virus engin declar malwar uncertainti surround ture file note filter binari file base actual content bias neural network classif deep feedforward neu ral network consist layer three node layer consist dropout fol low dens layer parametr recti fie linear unit prelu activ function layer sigmoid function den layer fourth layer predict elabor reason choic design choic deep neural network shallow wide neural network base develop understand deep chitectur effici term number fit paramet shallow network case number binari sam ples dataset small compar binari observ larg enterpris network sampl featur space limit goal increas express ness network maintain tractabl size network train singl ama zon node layer neural network sign remain design choic meant address overfit improv efficaci backpropag algorithm prevent overfit dropout demonstr simpl effici approach prevent overfit deep neural network standard weight regular base norm push weight expect prior distribut dropout seek weight node complementari weight node dropout solut resili imperfect dirti data common extract featur malwar compil pack softwar discourag adapt creat multipl path correct classif network view implicit bag neural network model speed learn rectifi linear unit relu speedup net work train tradit sigmoid activ func tion tanh avoid cay gradient descent converg rate ini tial set iter slowdown saturat ing linear sigmoid function edg relu activ function lead bad perform input valu low prelu activ function namic adjust order avoid issu yield ing improv converg rate initi weight train sig nific impact converg backpropaga tion algorithm goal good initializa tion avoid multipl impact weight aggr gation multipl layer backpropag approach gaussian distribut normal base size input output layer suggest ini tializ transform featur valu appli base logarithm featur practic improv train perform stantial formal descript layer network incom valu layer featur valu output valu layer weight layer linear transform input valu output val bias associ activ vector function equat network pointwis elementwis vector product independ sampl bernoulli distri bution paramet valu resampl batch updat train correspond fraction node batch layer input layer output layer layer activ function prelu function addit paramet fit train final layer activ function sigmoid function produc output model loss size batch sampl evalu sum cross entropi neural predict true label logi log output model batch sam ples output sampl true label sampl repres benign ware malwar neural network train backpropaga tion adam gradient base optim observ converg faster standard stochast gradient descent bayesian calibr simpli detect malwar binari sens system seek provid user accur probabl file malwar bayesian model calibr approach combin empir belief riski custom network repres belief ratio malwar benignwar cus network empir neural error profil test data describ specif approach adjust clas probabl score reflect true threat score qualit assum ratio malwar benignwar score classi fier reflect degre classifi believ observ binari malwar complet benign malwar goal translat number threat score will user measur observ binari malwar intuit defin threat score probabl file will malwar score categori will capit probabl repres probabl densiti function pdf breviti drop equal sign assum pdfs benign mal ware score classifi will describ deriv pdfs observ test data base rate ratio malwar benignwar will deriv comput threat score will step express problem term expect pdf benign malwar predict demonstr practic comput pdfs threat score bay rule rewrit sum probabl label final constraint probabl add final threat score term pdfs probabl observ malwar malwar base rate probabl densiti function estim definit threat score deriv pdfs proach common parametr proach assum distribut pdfs fit paramet distribut base observ sampl parametr approach kernel densiti estim kde approx imat pdf weight averag neighborhood reason expect output classifi follow standard distribut kde epanechnikov kernel test better valid score standard gaussian kernel pdfs valu mirror sampl left comput estim pdf specif point window size set empir better approxim tail distribut sampl dens evalu evalu system way hous databas malici benign nari conduct set cross valid experi test well system perform indi vidual featur set describ agglom ation featur set describ second live feed binari invincea custom net work conjunct live feed malici bina rie jotti subscript threat intellig feed measur accuraci system deploy context featur set experi amazon instanc ram cuda core graphic process unit softwar kera deep learn librari implement neural network model describ featur extract written cython python heavili reli scipi numpi librari featur tract singl thread process describ evalu detail start scription evalu dataset move descript methodolog dataset benign malwar binari drawn comput system cus tomer network malici binari jotti commerci malwar feed privat malwar databas final dataset virustot filter binari label benignwar mal ware fig count top malwar fami lie identifi kasperski anti virus engin malwar dataset fig histogram compil timestamp malici benign binari dataset malwar binari discov secu riti communiti share public threat intellig feed distribut malwar bina rie specif enterpris network experi differ dataset critic accur distri bution benign file reflect real usag will drive critic fpr estim primari sourc benign data direct client accu rate represent true distribut evalu valid confirm roc curv fpr estim match close live stream fpr assumpt endpoint stream malwar cross valid experi conduct separ fold cross valid experi experi random split data equal size partit partit train three partit test fourth set cross valid experi mea sure individu accuraci featur type describ experi reduc size neural network input layer train network fals posit rate fals posit rate fals posit rate figur experi show accuraci approach combin featur type experi set solid line roc individu cross valid fold dot averag roc curv featur type import featur byte entropi featur metadata featur string featur featur train sampl compil timestamp juli test sampl compil timestamp juli exclud sampl blatant forg compil timestamp epoch train error fall fold experi conduct includ featur neuron input layer valid fig summa rize tabl valid variat featur set perform featur produc best averag malici binari train detect fals posit rate area roc auc fig roc improv number epoch suffer overfit full dataset take second train epoch singl gpu full model effect train minut term independ featur set meta data featur perform best close mal ware binari unseen train detect fals posit rate string featur perform tabl estim tpr fpr auc correspond plot fig featur tpr auc import byte entropi metadata string time split well unseen malwar detect fals posit rate byte entropi featur import featur perform well meta data string featur boost accu raci string metadata featur provid count saliti vbkrypt trojan codecpack net allapl virut vilsel trojan kykymb trojan fraudrop trojan agent krap genom agent trojan onlinegam jorik fakeav trojan agent vbna buzus figur count top malwar famili experiment dataset year liz figur normal histogram compil timestamp malwar left red nignwar teal dataset base portabl execut compil timestamp field expect deploy perform question classifi ploy relat cross valid roc expect perform enterpris set estim expect perform observ number pre viousli unseen binari detect tire set custom span day expect averag execut binari endpoint day fpr result fals posit day endpoint assum roc curv accur estim actual perform confirm result direct run sensor incom data endpoint binari jotti stream day yield perform timat interest top fals posit train epoch figur plot show perform full featur model function train epoch split cross valid experi anti virus instal dubious tool product develop team time split experi shortcom standard cross valid periment separ abil tect modifi malwar abil detect malwar toolkit version exist mal ware toolkit uniqu malwar nari defin cryptograph checksum automat generat copi metamorph malwar design help evad signatur base tection test abil detect gen uin malwar toolkit malwar version time split experi better estim abil detect malwar toolkit version exist malwar toolkit tract compil timestamp field binari execut dataset exclud binari compil timestamp juli experi binari compil timestamp januari malwar sampl author blatant tam pere malwar binari compil timestamp file corrupt final split test data set set binari compil timestamp juli set binari juli train neural network ing featur describ earlier dataset test dataset complet trust malwar author modifi compil timestamp binari motiv distribut date match dataset sourc support hypothesi experi fig demonstr system perform wors test detect malwar fpr approach detect rate fpr substanti degrad perform surpris difficulti detect gen uin novel malwar program versus detect mal ware sampl instanc mali cious platform toolkit result suggest classifi updat data order main classif accuraci rapid cheapli neural network classifi work malwar detect evolv sev eral year increas grow threat pose malwar larg corpor government agenc tradit major approach malwar detect rough split base proach analyz malwar static dynam analysi review static anali sis malwar file set file direct alyz binari form addit unpack decompil assembl represent dynam analysi binari file execut action record hook access inter nal virtual environ principl dynam detect provid direct observ malwar action vulner fuscat harder recycl exist malwar practic autom execut softwar difficult malwar detect run sandbox prevent perform ing malici behavior arm race dynam behavior detector sandbox malwar number case malwar simpli execut proper miss depend unexpect system config urat issu difficult collect larg clean dataset malwar behavior static analysi hand vulnera ble obfusc requir elabor expen sive setup collect larg dataset creat simpli aggreg binari file curat label comput file anti virus aggreg site virustot static analysi amen chine learn approach perform bet ter data size increas machin learn appli malwar detect numer approach review chine learn consist part featur engi neer author transform input binari set featur learn algorithm build classifi featur numer static featur propos extract featur binari printabl string import tabl byte gram opcod format entropi assort featur suggest kaggl microsoft mal ware classif challeng opcod age decompil assembl featur aggr gate statist awar pub lish method break file subsampl slide window creat histogram subsampl base properti individu subsampl featur space larg case method local sensit hash featur hash aka hash trick random project malwar detect larg number featur dimen sional reduct scalabl issu machin learn algorithm exampl linear svm kernel requir multipl dur ing iter optim num ber sampl nearest neighbor quir find closest neighbor larg databas high dimension data predict requir comput storag label sampl popular altern ensembl tree boost tree bag tree scale fair effici subsampl featur space dur ing iter decis tree adapt well data type resili heterogen scale valu featur vector exhibit good perform type data standard izat standard implement typic allow increment learn fit full dataset larg number featur requir expens hardwar neural network emerg scal altern standard machin learn proach advanc train algo rithm neural network malwar detect clear compar dataset differ ent addit pre filter sampl evalu conclus paper introduc deep learn base malwar detect approach achiev detect rate fals posit rate experiment dataset softwar binari addit approach requir modest comput perform featur extract achiev good accuraci corpus singl gpu modest timefram layer approach deep neural network dimension histogram featur provid implicit categor binari type low direct train binari separ base intern featur packer type neural network properti good candid malwar detect allow increment learn train batch train effici hour daili basi train data collect second allow combin label unlabel data pre train individu layer third classi fier compact predict low amount memori attest approach system proven crucial malwar detect prevent product deploy cloud secur analyt platform current perform detect file stream ing thousand custom endpoint softwar data featur extract code data matrix label vector neural network code https konstantinberlin malwar detect dimension binari program featur acknowledg aaron liu invincea provid crucial engin support cours invincea lab data scienc team includ alex long david slater giacomo bergamo jame gentil matt john son robert gove feedback work progress refer anubi https kaggl microsoft malwar classif challeng https malwar classif virustot hhttps abou assaleh cercon swei dan gram base detect malici code comput softwar applic confer compsac proceed annual inter nation volum ieee banko brill scale larg corpora natur languag disambigu pro ceed annual meet associ comput linguist associa tion comput linguist bayer comparetti hlauschek kruegel kirda scalabl behavior base malwar cluster ing ndss volum cites benchea gavrilut combin restrict boltzmann machin side perceptron malwar detect graph base represent reason ing springer bengio lecun scale learn algorithm larg scale kernel machin breiman random forest machin learn dahl stoke deng larg scale malwar classif random project neural network acoust speech signal process icassp ieee intern confer enc ieee egel scholt kirda kruegel survey autom dynam malwar analysi techniqu tool acm comput survey epanechnikov parametr estim multivari probabl densiti theori probabl applic fleck tokhtabayev alarif stavrou nykodym pytrigg system trigger extract user activ malwar behavior proceed intern confer avail reliabil iti secur ieee fradkin madigan experi dom project machin learn proceed ninth acm sigkdd intern confer knowledg discoveri data mine acm friedman hasti tibshirani element statist learn volum springer seri statist springer berlin gandotra bansal sofat malwar anali sis classif survey journal secur glorot bengio understand difficulti train deep feedforward neural network interna tional confer artifici intellig statist zhang ren sun delv deep rectifi surpass human level perform agenet classif arxiv preprint arxiv hinton osindero teh fast learn ing algorithm deep belief net neural comput indyk motwani approxim nearest neigh bor remov curs dimension proceed thirtieth annual acm symposium theori comput acm jang brumley venkataraman bitshr featur hash malwar scalabl triag semant analysi proceed acm confer comput communic secur acm johnson lindenstrauss extens lip schitz map hilbert space contemporari mathemat kephart sorkin arnold chess tesauro white watson biolog inspir defens comput virus ijcai kingma adam method stochast optim arxiv preprint arxiv krizhevski sutskev hinton imagenet classif deep convolut neural network advanc neural process system lecun bengio hinton deep learn natur maa hannun rectifi linear improv neural network acoust model proc icml volum moser kruegel kirda limit static analysi malwar detect proceed comput secur applic confer schultz eskin zadok stolfo data mine method detect malici ecut secur privaci proceed ieee symposium ieee srivastava hinton krizhevski sutskev salakhutdinov dropout simpl pre vent neural network overfit journal machin learn weber schmid schatz geyer toolkit detect analyz malici softwar comput secur applic confer proceed annual ieee weinberg dasgupta langford smola attenberg featur hash larg scale multitask learn proceed annual interna tional confer machin learn acm woz niak alma cristea leblebici engbersen review advanc neural network neural design technolog stack proceed elm volum springer 