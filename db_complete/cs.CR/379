indirect file leak mobil applic daoyuan rocki chang depart comput hong kong polytechn univers hung hom kowloon hong kong csdwu csrchang abstract today sensit store insid mobil applic app brows histori chat log safeguard privaci file modern mobil system notabl android sandbox isol app file zone paper privat file leak indirect exploit compon trust victim app devis indirect file leak ifl attack exploit browser interfac command interpret embed app server leak data popular app evernot previous attack demonstr ifl affect android ifl method allow adversari launch attack remot implant malici app smartphon final compar impact type ifl attack android propos mitig method introduct mobil applic app gain popular mobil cloud comput era sensit user store insid mobil app mobil devic facebook authent token chrome brows histori whatsapp chat log safeguard privaci file modern mobil system notabl android sandbox isol app file zone adversari steal privat app file indirect manner exploit compon trust victim app refer class attack indirect file leak ifl fig illustr high level ifl model initi adversari direct access privat file formul adversari send craft input insid victim app input trigger deputi send privat file adversari adversari indirect steal privat file process achiev goal caus ifl paper devis ifl attack exploit browser interfac command interpret embed app server leak file popular app evernot tencent prior work local ifl attack android demonstr three ifl attack affect android summar attack sopifl attack bypass origin polici sop enforc protect resourc origin borrow term classic confus deputi problem repres trust compon victim app victim app deputi compon privat file trust parti adversari fig high level ifl model origin combin scheme main port steal privat file brows inter face deputi prior work demon strate attack android exploit numer android browser sop flaw file scheme extend paper number vulner app popular evernot tencent confirm latest fail enforc appropri sop file analysi root case attack legaci web sop inadequ local scheme file erad problem call enhanc sop aimifl attack leverag brows interfac deputi violat sop inject execut unauthor javascript direct target file requir malici file bypass sop access target file sopifl attack popular android browser baidu yan dex browser easili compromis allow privat file cooki brow ing histori stolen high profil mobil safe baidu search exploit android app uncov vulner app myvault cmdifl attack exploit command interpret deputi insid victim app execut unauthor command file leak demonstr top command app android termin emul ssh droid stealthili exploit execut arbitrari command root privileg will jeopard file command histori privat configur file sensit user photo store card app privat file serverifl attack send unauthor file extract request embed app server deputi insid victim app privat file test popular server app wifi file transfer android simpl transfer vulner attack worth note cmdifl serverifl attack unexplor deputi command interpret embed app server launch ifl attack time mobil platform cross platform vulner ifl method allow adversari launch attack remot implant malici app phone prior work ifl attack launch local phone remot intranet internet tabl highlight identifi ifl vulner major attack channel local ifl attack browser baidu yandex browser remot exploit entic victim access web email app social app compromis victim open malici attach file transmit remot adversari remot attack adversari scan intranet locat open port exploit vulner server app instal victim phone analyz differ android term impact ifl attack differ caus system architectur app design practic android analysi common app practic lead power pervas sopifl attack android hand three system characterist help lessen impact three ifl attack find help develop provid build secur app mobil system ethic consider vulner test conduct mobil devic test account test affect data secur real user ifl attack mobil app client side vulner affect server side integr real impact report identi fie vulner vendor respons process report remain vulner contact vendor acknowledg report exampl evernot list secur hall fame baidu rank report valuabl vulner report second quarter qihoo issu highest award mobil bug bounti program histori offer suggest vendor identifi vulner contribut summar three contribut devis ifl attack time affect android exploit local remot iii identifi number day ifl vulner popular android app uncov serious sop tabl ifl vulner attack channel attack channel remot local sopifl evernot tencent browser cloud aimifl baidu yandex browser mobil safe baidu search myvault cmdifl sshdroid termin emul serverifl wifi file transfer simpl transfer issu latest system analyz differ android term ifl attack impact propos method mitig attack background sandbox base app isol android sandbox base app isol build trustworthi mobil environ app resid sandbox code data isol app isol enforc kernel level exampl android unix uid base protect isol app app treat independ user run separ process uniqu uid sensit file store system provid isol privat file zone app activ leak file direct file leak app access protect file deploy seandroid mac system thwart risk incur direct file leak ifl occur presenc sandbox base isol mac actual exe cuter file access legal victim app file request initi craft adversari encrypt base defens encrypt privat app file face limit mac sum ifl remain serious unsolv threat motiv studi terminolog tabl summar term paper tabl term descript term descript privat file file store app isol file zone nonloc iflattack includ file card user photo target file privat file adversari steal ifl attack permiss form privileg represent exampl internetpermiss android contact permiss root superus privileg exampl root phone phonethat enabl superus privileg app brows brows compon compon brows capabili interfac built webview uiwebview command app compon interpret execut app server server compon embed app iii ifl attack describ adversari model detail type ifl attack introduc tion adversari model consid three type adversari ifl attack local adversari launch local attack intranet internet adversari remot ifl attack local adversari attack app instal smartphon victim app requir permiss exhibit typic malici app behavior root privileg attack app consid screenshot attack requir strong assumpt intranet adversari resid intranet mobil devic send network request node intranet sniff nearbi wireless traffic retriev unencrypt content assum launch effect arp spoof attack network administr detect anomal event internet adversari locat host internet remot compromis victim entic victim brows web control send victim malici file email chat app social network bypass sop brows interfac sopifl attack bypass sop steal privat file brows interfac deputi attack brows interfac render engin sop enforc flaw prevent malici javascript code access privat file app brows ponent potenti victim file scheme ideal medium launch sopifl attack part sop enforc file exploit steal local privat file adversari cross origin web domain access local file content cross scheme sop enforc http file label broken altern adversari leverag local malici html file path steal target file path case file sop enforc file origin bell bypass failur enforc rare modern render engin focus sopifl attack will bypass studi android effec tive enforc contribut sopifl attack lie contrari expect attack higher impact ecosystem test iphon reveal latest proper enforc guarante polici identifi common practic app lead pervas power sopifl attack android root problem legaci sop adequ cover local scheme file typic web sop principl legaci sop allow file file access file file origin share scheme domain localhost port practic legal behavior fail meet secur requir ment file mobil environ enhanc sop local scheme path element current three element sop tupl need erad vulner report find appl januari suggest enhanc file sop system engin level unauthor javascript execut target file aimifl attack regard advanc variant sopifl attack attack brows interfac deputi aimifl attack violat sop inject execut unauthor javascript direct target file requir malici file bypass sop access target file sopifl attack aimifl attack consist step unau thoriz javascript code inject target file achiev way depend type target file exampl target cooki file javascript code inject cooki field target file load render inject javascript execut steal current file content html document object model variabl javascript access current document attack violat sop set attack apart sopifl attack worth note step perform simultan knowledg victim privat file will stolen brows web control paper focus design remot aimifl attack conduct local identifi type remot aimifl attack illus trate fig type web load target file local scheme file content file load file link html ifram link base load requir extra user click ifram base load automat requir user action load target cooki file web inject malici javascript code script alert script web cooki field cooki file load javascript insid steal cooki content will popular mobil safe baidu yandex browser vulner type aimifl attack second type aimifl attack activ load render target file exploit victim app abil load content target file render user interfac webview widget exampl browser app load brows histori brows load cooki file tab link html ifram http set cooki script alert document script tab ifram file content script alert docum script file attack activ load target file render bookmark set titl url script alert document script histori googl script alert html script https http script alert docu tml script attack exploit victim app file load featur fig remot aimifl attack histori file render app load featur adversari simpli inject javascript target file exampl illustr fig adversari inject unauthor javascript histori file titl url field web user switch render histori log malici titl url display embed javascript execut steal histori file passiv load file render local domain file adversari combin aimifl attack sopifl attack steal privat file load victim app will detail app unauthor command execut command inter preter cmdifl attack exploit command interpret deputi insid victim app execut file oper command ifl attack consid explicit embed command interpret command termin app remot code execut vulner contain host app scope app vulner cmdifl attack inject unauthor command leak privat file inject command set readabl file permiss invok chmod command export file public card command iii send file remot server command scp victim app root permiss command steal privat file sensit app discov exploit cmdifl vulner adver sari identifi channel confus command interpret accept unauthor command cross app compon communic channel android launch local cmdifl attack command interpret compon expos adversari exploit url scheme achiev better attack impact general remot cmdifl attack command interpret accept remot command request addit victim app configu ration store public storag chang indirect inject command access servic misus mimic user command cmdifl attack launch gui attack file manag app adversari forc app perform unauthor base file oper leak file content real threat file oper conduct victim user easili notic smarter adversari wait user open sensit file launch screenshot attack sniff content exclud scenario treat model requir adversari close monitor activ unauthor file extract embed app server confus deputi app server embed victim app adversari send unauthor file extrac tion request exploit vulner embed app server obtain privat file app server file server support http ftp request provid user file transmiss servic tween phone desktop command server mention type candid server app support multi function server popular airdroid app instal serverifl attack conduct three way local attack launch app instal smartphon victim app scan local host port send packet port listen victim app second adversari node phone laptop intranet attack victim app devic intranet easi adversari identifi port open victim app third remot serverifl attack attack vector deliv desktop browser brows malici web success serverifl attack bypass authent set protect victim app authent code user password confirm action click confirm button evalu current authent server app broken app weak authent random number channel transmit authent code subs quent session token unencrypt intranet adversari easili sniff secret bypass authent step tabl iii app vulner sopifl attack categori vulner app attack channel browser mercuri localbaidu sogou browser cloud drive cloud local webbaidu cloud cloud note read evernot reader local web email remot social tencent remot util foxit reader oliveoffic local uncov ifl vulner android app sopifl vulner uncov number vulner app summar tabl iii evalu iphon latest ipad evalu percent devic enforc engin level app default web engin current solut mitig sopifl vulner applic level launch sopifl attack platform licious html file deliv victim app identifi three channel local adversari design stealthi app jekyl app launch local sopifl attack app accept extern html file app open android browser expos brows interfac notic local attack conduct remot leverag app remot channel exampl adversari send html file popular wechat app instal victim devic wechat will open type file will user open file app find browser cloud drive app local attack web adversari deliv attack vector web servic interfac mobil app exampl cloud drive note app support file share web adversari share html file victim web interfac remot remot sopifl attack app attach mechan email app ideal channel launch target remot sopifl attack exampl user open attach html file adversari email adversari steal privat file remot simi lar file send mechan social app popular tencent exploit html file anticip type file launch sopifl attack exampl common pdf flash file format execut embed javascript code desktop environ current mobil system limit support flash basic open demo implement dropbox wechat http tabl app vulner aimifl attack attack vulner app aimifl file baidu browser road aimifl content mobil safe aimifl intent yandex browsersbaidu search baidu browser aimifl android internet browser smart browser shadi browser zirco browser aimifl myvault automat steal file webview default provid featur web titl test script alert document locat scri inject histori tabl open long press fig aimifl attack exploit baidu browser javascript pdf file system improv expect attack vector will bypass exist protect exampl wechat immun current sopifl attack disabl open html file allow open pdf file open exploit futur sopifl attack aimifl vulner summar aimifl vulner tabl discuss iii vulner classifi type aimifl aimifl aimifl attack attempt aimifl attack file android app baidu browser road find difficult direct load file content html ifram web android altern method ask user click file link embed web method exploit road app render file link clickabl desktop browser file link baidu browser clickabl find adversari entic victim long press link allow baidu browser pop dialog user click target file render content stolen automat attack procedur illustr fig find content scheme android exploit aimifl attack scheme retriev content data correspond content provid compon surpris find web load local file content scheme associ content provid implement openfil uri uri string mode api launch aimifl attack content easier file launch attack remot exploit mobil safe serious exploit issu highest award mobil bug bounti program histori terada point intent scheme remot attack local android compon idea independ identifi popular browser baidu search app exploit aimifl attack intent victim app satisfi follow ing three condit exploit intercept intent uri generat intent structur intent invok compon victim privat compon expos app adversari design craft intent uri deliv attack vector target compon includ compon import extern intent paramet string url adversari control compon render arbitrari uri victim compon step allow file access javascript execut victim fore render target file file execut embed javascript code aimifl attack discuss affect android app will explain hard launch aimifl attack aimifl attack launch aimifl attack suc cess requir condit victim app load content target file webview base gadget adversari inject unauthor javascript target file condit facilit search vulner focus android browser webview base app inspect screenshot choos app instal test webview loaddatawithbaseurl api locat vul nerabl android browser develop invok api load local content associ asset api paramet start file search android browser code identifi vulner open sourc zirco browser interest vul nerabl zirco design browser clude browser android user app myvault exploit aimifl attack app allow user store privat photo bookmark password bookmark store entri point malici bookmark inject steal bookmark wors enforc sop well file adversari steal sensit content craft bookmark tabl cmdifl vulner app vulner attack ofchannel instal termin command compon expos local emul sshdroid command server local weak protect intranet activ alia runscript remoteinterfac intent filter action categori intent filter activ alia permiss danger activ remoteinterfac true intent filter action categori intent filter activ fig manifest excerpt termin emul cmdifl vulner tabl list identifi cmdifl vulner select command termin server app googl play app command interpret normal app evalu top app termin emul sshdroid instal user requir exampl termin emul android instal top termin app instal test command app vulner cmdifl attack local attack app execut arbitrari command ident termin emul export privat file command histori privat configur file public card root vulner expos termin command compon invok local app arbitrari command paramet interest find termin emul protect command compon danger level permiss fig rational design command invoc action appropri author permiss mechan adversari touch protect command proxi compon runscript direct invok under command compo nent remoteinterfac fig default expos intent filter mechan consequ craft input forc remoteinterfac compon execut command report issu demo attack code termin github help open sourc communiti patch app top command server app sshdroid vulner local intranet cmdifl attack app work tabl serverifl secur weak top server app app app transmiss immun effect instal platform protocol port encrypt authent file upload connectioncsrf alert android airdroid http set user confirm wifi file transfer http set set xender http number wifi file explor http set ftp simpl transfer http set rate photo transfer wifi http byte rate wifi photo transfer http set rate usb flash drive http rate air transfer http set rate app instal number count novemb rate number estim popular app ssh server listen default port prevent unauthor connector adversari fingerprint sshdroid sshdroid connector sshdroid user choic user normal case root root phone default admin password user chang set adversari pre knowledg exploit app steal privat file alarm sshdroid work root exploit root phone adversari execut root command steal privat file instal app serverifl vulner test top ten server app googl play appl app store evalu serverifl vulner tabl summar statist secur metric test app secur weak exploit launch serverifl attack surpris app provid encrypt tran mission file request user desktop browser file server test app percent app implement secur guarante serious consequ wireless set assum app user model app provid function enabl default find app ssl encrypt manual enabl set accept sign certif secur warn client side browser hurt user experi authent app weak ten test app enforc authent includ popular server app simpl transfer intranet adversari easili send unauthor file extract request app conduct authent guarante secur aforement lack encrypt transmiss adversari sniff wireless traffic secret authent cooki post authent transmiss secret authent general strong number verif code app charact password app brute forc attack practic exampl crack authent adversari time remot serverifl attack propos improv file upload csrf cross site request forgeri attack purpos adversari upload html pdf file malici javascript code file upload csrf victim open upload file desktop browser embed javascript run domain target file steal arbitrari file content describ test app suffer file upload csrf make remot serverifl attack app support file upload function aliti make immun file upload csrf paid version app support file upload app allow upload photo file make vulner app support view upload file attack vector embed javascript execut desktop browser app airdroid emb secret token post request url csrf token app safe launch stealthi serverifl attack requir victim app effect mechan detect illeg connect evalu reveal app detect capabl airdroid alert user confirm reject incom connect break connect mechan effect prevent stealthi connect hard local attack app disabl envelop airdroid alert simpl transfer display connect accept connect implement multipl connect detect warn weak allow adversari stealthili connect victim app victim establish initi connect legal user browser launch effect serverifl attack attack fingerprint common server app advanc tabl protocol test app indistinguish basic http open port suffici variabl identifi app app port number adversari leverag http respons distinguish adversari construct databas fingerprint launch target serverifl attack app android evalu reveal major differ droid term impact ifl attack discuss implic implic common practic app open untrust file app domain lead pervas power sopifl attack android compar file open behavior android version repres app categori choos file type html pdf abil carri attack vector find test app open html file contrast correspond android version choos dedic app browser handl html file pdf file open untrust file domain common practic app android app general dedic app open file googl drive wechat requir explicit user action open html file app app open pdf file intern common practic produc attack surfac app android version dedic app handl untrust file secur design potenti attack vector privat file test android app general prac tice immun sopifl attack sopifl attack android local attack forc file open expos brows interfac browser app careless app contrast case pervas span multipl app categori power local web remot attack requir local expos compon reason design lack flexibl data share reason respons app open file data share involv lightweight process export import lack public card content uri mechan support android implic random app data directori difficult conduct aimifl attack aimifl attack requir knowledg full file path assign random directori data zone difficult remot attack construct full path target file random perform stallat directori app reinstal phone will instal exampl random app directori unifi path prefix privat var mobil applic privat var mobil contain bundl applic comparison android name app data directori app packag adversari easili construct app directori pattern data data packagenam app general random directori straightforward full file path find except firefox random path strategi android app design exampl full file path data data file mozilla random directori underlin random app directori thwart aimifl attack recommend android develop practic app design implic strict app review prevent app execut bash command adversari find target launch cmdifl attack state appl strict regul review app submit app store app review guidelin describ scenario lead app reject rule state app instal launch execut code will reject rule impli run interpret code bash script forbidden appl locat app command interpret condit launch cmdifl attack app ipash claim provid command execut mimic output nativ command receiv custom review fake command sum restrict imposs launch cmdifl attack suitabl app target app store implic general allow background server behavior reduc chanc serverifl attack success launch serverifl attack depend adversari attack victim app phone screen lock victim app support background server attack time window short ene reduc chanc success serverifl attack evalu indic server app work foreground top server app air transfer attack screen contrast top android app support background server behavior exploit phone set find easi develop implement background server behavior requir advanc trick worri violat appl app review polici develop app server background uncommon mitig method applic specif defens requir mitig exist ing ifl risk develop refer avoid flaw exist vulner app system flaw android sop flaw mention iii time fix implic will improv app system secur level exampl prudent app open untrust file app domain dedic app handl offer suggest noj authaccess mitig ifl attack noj disabl javascript execut local scheme safeguard sopifl aimifl attack serverifl attack base file upload csrf stop open upload file plain text authaccess restrict command network request access app privat file zone access explicit author user cmdifl serverifl attack mitig vendor hoc fix central mitig solut desir extend exist seandroid mac system leverag fine grain context differenti ifl attack request normal request prior work collect enforc process context tackl local permiss leak attack local ifl attack handl challeng context base enforc mitig remot ifl attack remot entiti control context easili address problem propos user driven content base access control will investig leverag develop enhanc context base mac system ifl attack mitig futur work vii work file leak mobil app compar ifl studi paper direct file leak straightforward type file leak leak caus set insecur readabl permiss privat file app exampl opera lookout error hand victim app write sensit file public storag card system debug log outlook evernot user risk seandroid mac system defend direct leak ifl unsolv threat direct case local leak android propos multipl form remot file leak android ifl attack instanc studi focus specif problem exampl zhou studi attack expos android con tent provid confus deputi issu unauthor databas queri compon adversari steal victim app databas file attack kind local ifl attack exist android exampl previous filecross attack belong sopifl attack discuss iii local sopifl attack android demonstr sopifl issu exist number app remot exploit worth note blog post report local sopifl issu dropbox googl drive app year ago mention deliv attack vector blog post system test problem issu widespread current ecosystem identifi fundament legaci web sop adequ cover local scheme compar isol ifl studi systemat studi local remot ifl attack android confus deputi problem mobil ifl attack class general confus deputi problem number previous work studi permiss confus deputi problem android call permiss leak privileg escal propos detect sys tem base control data flow analysi includ droid woodpeck chex droidcheck epicc sefa android app analysi framework flowdroid amandroid extend detect problem difficult static tool analyz ifl vulner ifl attack explicit vulner code pattern dynam analysi tool construct automat ifl detector desir leav futur work aforement studi identifi confus deputi problem ifl attack equal develop detect tool mobil browser secur sopifl aimifl attack mobil browser secur work studi threat android webview secur risk base mobil librari app unauthor origin cross popular android app differ focus file leak vulner browser compon aforement work share goal studi addit prior work inject unauthor javascript base app techniqu aimifl attack goal compromis victim onlin credenti goal steal local file overcom chal leng launch local file stolen attack web origin sop restrict aimifl attack appli mobil app browser compon base app viii conclus paper systemat studi indirect file leak ifl mobil applic devis ifl attack exploit browser interfac command interpret embed app server leak privat file popular app previous attack work android demonstr ifl three affect android vulner app includ evernot baidu browser mobil safe termin emul android ifl attack launch remot implant malici app smartphon remot attack capabl increas pact ifl attack final analyz differ android term ifl attack impact propos method mitig attack acknowledg three anonym viewer help comment work partial support grant innov technolog fund hong kong addit materi will provid supplementari terial detail vulner report link https html refer appl peopl stop upgrad http market share stagnat app store review guidelin https app store review guidelin app overtaken web popular latest statist http sciencetech articl app overtaken web popular latest statist app app popular mobil web data http technolog appsblog apr app popular mobil web data cve http cgi bin cve evernot patch vulner android app http trendlab secur intellig evernot patch vulner android app fix issu android termin emul https jackpal android termin emul commit upload arbitrari file content cross domain http net upload arbitrari file app creat phonegap http app background applic network access http question background applic network access habit die hard cross zone script dropbox googl drive mobil app http wfblog habit die opera mobil android insecur file permiss cach poison vulner http bid discuss outlook android app store email plain text mobil http wordpress digit outlook app leak pull request android termin emul https jackpal android termin emul pull technic note network multitask https develop librari technot vulner https acker nikiforaki desmet joosen piessen flashov autom discoveri cross site script vulner rich internet applic proc acm asiacc arzt rasthof fritz bodden bartel klein traon octeau mcdaniel flowdroid precis context flow field object sensit lifecycl awar taint analysi android app acm pldi bhoraskar han jeon azim chen jung nath wang wetheral brahmastra drive app test secur third parti compon proc usenix secur bugiel davi dmitrienko fischer sadeghi shas tame privileg escal attack android proc isoc ndss bugiel heuser sadeghi flexibl fine grain mandatori access control android divers secur privaci polici proc usenix secur chan hui yiu droidcheck analyz android applic capabl leak proc acm wisec chin felt greenwood wagner analyz inter applic communic android proc acm mobisi chin wagner bifoc analyz webview vulner android applic proc springer wisa davi dmitrienko sadeghi winandi privileg escal attack android proc springer isc dietz shekhar pisetski shu wallach quir lightweight proven smart phone oper system proc usenix secur enck gilbert chun cox jung mcdaniel sheth taintdroid flow track system realtim privaci monitor smartphon proc usenix osdi felt wang moshchuk hanna chin permiss deleg attack defens proc usenix secur georgiev jana shmatikov break fix origin base access control hybrid web mobil applic framework proc isoc ndss grace zhou wang jiang systemat detect capabl leak stock android smartphon proc isoc ndss hardi confus deputi capabl invent acm sigpo oper system review jang song chung wang lee attack exploit access oper system proc acm ccs jin ying yin peri code inject attack base mobil app character detect mitig proc acm ccs lin zhou wang screenmilk milk android screen secret proc isoc ndss lee jiang chex static vet android app compon hijack vulner proc acm ccs luo hao wang yin attack webview android system proc acm acsac moshchuk wang liu content base isol rethink isol polici design client system proc acm ccs nadkarni tendulkar enck nativewrap hoc smart phone applic creation user proc acm wisec octeau mcdaniel jha bartel bodden klein traon effect inter compon communic map android epicc essenti step holist secur analysi proc usenix secur roesner kohno moshchuk parno wang cowan user driven access control rethink permiss grant modern oper system proc ieee symposium secur privaci smalley craig secur enhanc android bring flexibl mac android proc isoc ndss sounthiraraj sah greenwood lin khan smv hunter larg scale autom detect ssl tls man middl vulner android app proc isoc ndss terada attack android browser intent scheme url http whitepap wang xing wang chen unauthor origin cross mobil platform threat mitig proc acm ccs wang chung lee jekyl benign app evil proc usenix secur wei roy robbi amandroid precis general inter compon data flow analysi framework secur vet android app proc acm ccs chang analyz android browser app file vulner proc springer secur confer isc grace zhou jiang impact vendor custom android secur proc acm ccs yan yin droidscop seamless reconstruct dalvik semant view dynam android malwar analysi proc usenix secur zhou jiang dissect android malwar character evolut proc ieee symposium secur privaci zhou jiang detect passiv content leak pollut android applic proc isoc ndss 