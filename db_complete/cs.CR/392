secur access encrypt cloud storag multipl author devic sandeep tamrakar long nguyen praveen kumar pendyala andrew paverd asokan ahmad reza sadeghi aalto univers finland aalto univers univers helsinki finland asokan technisch universit√§t darmstadt germani abstract cloud storag servic dropbox googl drive onedr increas popular major reason success cloud storag servic abil synchron store data multipl client devic possibl share subset data peopl privaci cloud data grow concern encrypt data client side upload cloud storag server effect ensur privaci data order allow user access data multipl devic current solut resort deriv encrypt key sole user chosen password low entropi omnishar scheme allow client side encrypt high entropi key whilst provid intuit key distribut mechan enabl data access multipl client devic allow user author devic access encrypt storag band channel distribut relev key author devic omnishar cloud storag communic channel devic ensur user action need author minim consist omnishar allow possibl share select encrypt file peopl omnishar open sourc current android window platform develop introduct mobil devic smartphon tablet central daili live multipl devic simultan switch devic norm access data devic share data peopl cloud storag servic dropbox googl drive allow backup share manag synchron data multipl devic internet time concern data privaci promin major cloud storag provid secur channel transfer data client devic storag server routin encrypt data store persist storag user data clear cloud storag server access server legitim will read modifi user data detect encrypt data client side upload cloud storag server effect ensur privaci data ensur data devic state art data encrypt tool design cloud storag address problem encrypt data key deriv sole client password easi peopl access encrypt data cloud storag devic problemat secur perspect well problem password peopl tend pick password easi guess tend reus password multipl servic consequ key deriv sole password tend low entropi omnishar scheme allow client side encrypt high entropi key whilst provid intuit key distribut mechan enabl data access multipl client devic omnishar standard encryp tion algorithm high entropi key generat local board secur hardwar client devic encrypt data upload cloud storag omnishar allow user author person devic omnishar domain devic belong domain access key encrypt file domain author devic omnishar automat select suitabl secur band oob channel devic author devic base hardwar capabl devic secur oob channel well cloud storag perform secur author protocol key hierarchi key directori omnishar pos sibl synchron subset directori devic separ encrypt key file omnishar allow user select share file user omnishar design user interact requir author process minim consist platform author mechan generic secur intuit defin domain devic omnishar authent access control applic secur cloud storag omnishar open sourc softwar apach licens current window android version project omnishar requir defin adversari model identifi relev secur function usabl requir adversari model assum adversari access add modifi file cloud storag attempt protect denial servic delet file cloud storag assum adversari collud user includ primari user choos share file adversari observ interfer local interact devic user claim reason assumpt network orient natur adversari secur requir file encrypt high entropi key gen erat client devic upload cloud author devic access actual content file function requir key hierarchi allow synchron subset directori devic facilit share directori user file encrypt separ key allow select share individu file user devic author omnishar domain access relev file interact devic domain omnishar limit specif cloud storag provid usabl requir user action devic author min imal consist platform mechan iii architectur omnishar design applic run client devic user link cloud storag applic start time devic devic assum devic keypair protect board secur hardwar omnishar creat devic specif authent key author devic user initi omnishar devic applic creat omnishar domain user add devic author devic domain cre ation domain involv creat omnishar directori cloud storag domain descriptor file directori root key domain omnishar directori contain store encrypt file cloud storag user store encrypt file cloud storag servic omnishar folder domain descriptor file organ author devic omnishar domain domain descriptor file metadata author devic includ devic uniqu identifi hardwar capabl devic public key root key encrypt devic specif omnishar domain descriptor encrypt encrypt encrypt encrypt encrypt encrypt pka devic fig exampl key hierarchi omnishar public key messag authent code mac hardwar capabl list auxiliari hardwar compon user input output camera input display output nfc input output keyboard input file encrypt key structur file creat omnishar generat filekey encrypt file encrypt file separ allow omnishar select share individu file user requir omnishar establish maintain key hierarchi level correspond subdirectori omnishar directori key level encrypt key level root key top level directori lock box data struc ture limit root key access author devic omnishar encrypt root key separ public key author devic requir author devic protect correspond privat key board secur hardwar key hierarchi allow user synchron subset file devic author devic subdirectori key root key requir symmetri key process author devic level hierarchi clariti explan process describ respect root key remaind figur depict exampl key hierarchi omnishar domain lock box allow devic access root key omnishar encrypt public key pka maintain encrypt domain descriptor file devic metadata key hierarchi correspond directori structur encrypt storag encrypt directori key directori encrypt directori key subdirectori encrypt filekey encrypt file encrypt store encrypt file directori store separ encrypt file correspond directori author devic devic devic band oob channel base match devic code passcod cloud storag encrypt file encrypt key cloud storag omnishar domain share secret devic share secret fig overview devic author omnishar cloud storag servic store data key hierarchi ensur client devic key distribut process involv grant access root key thoriz devic subsequ access filekey interact devic requir encrypt file upload cloud storag quirement omnishar download decrypt file client devic present content user implement synchron layer autom encrypt decrypt file well updat encrypt file chang file content devic author author process add devic omnishar domain secur distribut root key figur depict author devic omnishar present user interfac dialog box select suitabl author devic domain facilit author process author devic select omnishar match hardwar capabl devic establish band oob channel consist user experi multipl devic platform requir requir user transfer select output capabl select best match input capabl base select pair capabl support type oob channel scan code copi enter exampl display capabl camera choos scan code channel display author protocol messag dimension quick respons code user scan camera camera unavail copi enter channel display numer passcod user type keyboard minim user interact requir cloud storag communic channel code ksauth scan code channel pka verifi pka enc pka hmac ksauth verifi ksauth dec ska hash pka ksauth rand local channel cloud storag channel devic author devic fig devic author protocol code devic continu author protocol devic exchang protocol messag file involv user select oob channel enabl particip devic verifi communic cloud storag channel devic user intend separ devic author protocol key distribut code scan code channel passcod copi enter channel protocol ensur root key distribut intend devic explain code figur outlin devic autho rizat protocol devic select author devic protocol display cryptograph hash devic public key pka fresh generat random session thentic key ksauth code user scan code camera deliv pka cloud storag iii verifi pka verif function verifi pka encrypt root key pka generat mac encrypt messag hmac hash base messag authent code algorithm ksauth key receiv cloud storag veri fie authent verif function verifi ksauth verifi decrypt privat key ska scan code channel replac oob channel allow deliv ksauth current work mechan achiev ultrason communic channel passcod devic author protocol quir user enter passcod display password authent key agreement protocol pake generat strong share session key share passcod session key secur distribut cloud storag figur outlin devic author protocol protocol display digit passcod user type input keyboard passcod copi enter channel devic author devic enca kses deca kses password authen cate key agreement protocol pake kses kses local channel cloud storag channel fig devic author protocol passcod devic pake protocol cloud storag deriv share session key kses iii encrypt authent encrypt gorithm enca kses kses deliv encrypt messag cloud storag decrypt correspond decrypt algo rithm deca kses kses extract devic author devic passcod copi enter channel kses verifi kses kses secur remot protocol srp local channel cloud storag channel kgx kses kses verifi kses dae kses eae kses fig devic author protocol passcod secur remot password srp protocol pake protocol deriv kses srp client server protocol client regist server set password server generat random salt store cryptograph hash client salt password authent client provid provid ident server request respect salt valu figur outlin devic author protocol passcod srp client srp server devic digit numer passcod srp password omit registr phase srp messag send ident nishar client server author srp finit field comput larg prime generat devic protocol generat random number calcul public transfer generat random number random salt calcul cryptograph hash receiv calcul public transfer iii calcul cryptograph hash calcul common kgx devic hash deriv session key kses calcul kses calcul session key authent messag kses deliv verifi verifi kses send session key authent messag kses complet srp protocol kses secur deliv explain author omnishar client add omnishar domain perform task encrypt root key public key devic calcul hmac devic metadata encrypt root key devic specif authent key hmac encrypt root key devic metadata domain descriptor file share file omnishar support share select file directo rie user involv three main task peer share receiv option task store peer user share file direc tori key exchang protocol oob channel nfc bluetooth agre share peer key peer establish persist context peer consist share key peer directori control file devic send public link control file peer devic maintain list peer pointer control file share user share file directori receiv omnishar copi encrypt file peer directori receiv add record control file peer context file directori key encrypt peer key public link encrypt file directori receiv receiv scan control file peer detect newli share file peer receiv public link fetch encrypt file fetch encrypt key control file correspond peer key receiv recov file content receiv file receiv add acknowleg entri ident file control file acknowledg sender store option task share process receiv import share file cloud storag key hierarchi omnishar domain implement implement omnishar window droid support dropbox target cloud storag servic window implement net framework version architectur android implement target android higher api level platform bounci castl crypto api bounci castl window spongi castl android port higher progress implement omnishar dropbox architectur limit provid requir support provid straightforward provid offer interfac third parti applic file encrypt key structur dirkey hash directori path mac fig format file encrypt directori key authent encrypt encrypt file key key hierarchi galoi counter mode gcm bit key bit initi vector bit mac directori key encrypt byte tag indic key type constant dirkey hash full directori path order mitig key substitut attack key hierarchi encrypt directori key store file correspond directori figur format file prepend encrypt directori key mac append encrypt key encrypt file key includ byte key type tag filekey hash encrypt correspond file figur format encrypt file key prepend encrypt file key mac append encrypt encrypt file key prepend encrypt correspond file note pure conveni provid secur properti adversari model encrypt file format key prepend mac append encrypt encrypt file includ addit includ encrypt key window implement separ direc tori encrypt file link cloud storag whilst decrypt content access user file synchron provid fsp framework synchron file updat filekey hash encrypt mac fig format encrypt file key android dropbox sync api access store file initi omnishar display list file metadata download file content user access file omnishar fetch file decrypt present user user upload file encrypt file upload cloud storag implement delta file encrypt option synchron updat larg file naiv updat encrypt file requir encrypt entir file expens term process band width larg file omnishar encrypt chang separ delta file synchron client devic client devic decrypt delta file appli chang origin file local delta file includ integr protect modifi timestamp verifi user prevent rollback attack delta file enabl dedupl cloud store singl copi file maintain differ delta file devic author scan code channel author calcul hash devic public key bit rsa public key sha algorithm encod hash bit random authent key code open sourc zxing zebra cross librari android window generat decod pixel rsa public key encrypt encrypt root key hmac random authent key calcul mac copi enter channel secur remot password srp protocol version pake protocol deriv strong bit session key digit random passcod authent encrypt session key distribut root key protocol messag exchang file cloud storag messag file assign univers uniqu identifi uuid filenam json object protocol messag uuid filenam expect file respons receiv encapsul respons indic file filenam initi author protocol messag ident select author devic timestamp identifi devic respond messag name convent pure conveni devic authent fresh messag establish cryptograph author protocol devic poll initi protocol messag file second authent protocol execut participat ing devic poll protocol messag file second minim author time bit devic specif key comput mac devic data metadata encrypt root key domain descriptor file store json object share file capabl share file android nfc bluetooth api establish bidirect communic pair peer ellipt curv diffi hellman ecdh key exchang protocol deriv bit share key peer reli dropbox api generat public link control file share file current implement support share directori select synchron directori featur develop analysi omnishar maintain devic metadata author devic json object domain descriptor file json object includ hmac devic meta data encrypt root key author devic store devic specif authent key local allow detect anomali devic metadata domain descriptor file manipul devic capabl file encrypt key structur omnishar standard algorithm crypto graphic oper authent encrypt crypt file key key hierarchi ensur confidenti integr encrypt file cloud storag requir protect root key essenti protect key hierarchi encrypt root key author devic devic public key lock box data structur author devic store privat key local requir protect key improv dedic secur hardwar devic trust platform modul tpm window arm trustzon mobil devic platform key hierarchi omnishar select synchron directori devic requir devic author omnishar oob channel cloud stor age minim user interact author process consist user experi user transfer code passcod devic authent devic requir oob channel kainda secur failur rank usabl scan code channel lower oob channel gain popular year oob channel locat limit channel integr authent exchang singl oob messag secur distribut root key devic grant access encrypt storag requir involv oob channel establish trust devic continu author process cloud storag author protocol ensur level secur adversari incent influenc choic oob channel manipul devic capabl author protocol assur origin authent root key devic receiv key select author devic time assur destin authent root key author devic deliv key legitim devic scyther protocol analysi tool formal model author protocol verifi claim appendix omnishar warn user protect confidenti oob channel oob channel visibl proxim adversari access cloud storag user visual proxim oob channel interact devic forc accept root key control adversari type adversari data way shoulder surf password perform evalu microsoft surfac pro run window core ghz cpu samsung galaxi run android quad core ghz cortex quad core ghz cortex cpu measur valu averag execut round measur tabl measuremet devic author protocol exe cution time dropbox author protocol averag time second code window android android android srp window android android window window window android android tabl execut time devic author protocol tabl window android indic devic window select autho rize devic android phone measur includ messag generat exchang time cloud storag includ time user interact oob channel tabl author protocol code fast passcod fewer messag exchang averag take millisecond perform request respons oper devic dropbox sync api time reduc dropbox core api requir custom file synchron mechan time requir cryptograph oper low tabl time requir generat devic rsa measur cryptograph oper oper averag time millisecond window bit rsa keygen rsa encrypt byte rsa decrypt byte file encrypt file decrypt android bit rsa keygen rsa encrypt byte rsa decrypt byte file encrypt file decrypt key pair encrypt decrypt bit root key rsa symmetr encrypt decrypt file gcm oper generat bit key encrypt filekey millisecond platform share file omnishar encrypt key file facilit share individu file user reveal filekey receiv collud adversari modifi file integr protect includ encrypt filekey header figur share file peer affect secur guarante file share accomplish share public link encrypt file control file peer key generat peer protect filekey public link allow user share file user cloud storag platform work solut spideroak wuala discon tinu tresorit offer secur cloud storag client side file encrypt key deriv password encrypt file hand tool viivo boxcryptor sookasa allow encrypt client generat key allow user choos prefer cloud storag addit server manag distribut file encrypt key devic contrast secur omnishar depend server panbox closest solut compar nishar addit client side encrypt oob channel bluetooth distribut key client devic requir multipl user interact tablish oob channel exampl bluetooth user requir manual establish bluetooth connec tion devic scan code display author devic devic complet key distribut base key distribut requir user connect devic wireless network panbox appear limit german user contrast omnishar deliv minim consist user interact freeli vii conclus data privaci major concern respect cloud storag omnishar address problem combin client side encrypt intuit key distribu tion mechan key hierarchi individu file key facilit select synchron directori well share file directori user omnishar open sourc softwar current android window platform develop generic mechan construct author devic domain omnishar will applic secur cloud storag exampl suppos onlin bank applic trust hardwar mobil devic protect user credenti onlin bank access allow credenti multipl devic belong user applic allow user defin author domain devic omnishar protect bank credenti domain root key acknowledg work partial support academi finland project cloud secur servic close grant number intel institut collabor search secur comput icri jan erik ekberg brian mcgillion jian liu feedback earlier version manuscript refer facebook busi find simplic multi devic https busi news find simplic multi devic march soghoian caught cloud privaci encrypt govern door web era telecomm high tech kallahalla plutus scalabl secur file share untrust storag proceed usenix confer file storag technolog srp improv refin secur remot password protocol submiss ieee work group legion bounci castl bounci castl crypto api onlin http zxing zebra cross onlin https zxing zxing srp authent key exchang system rfc septemb onlin https rfc txt kainda usabl secur band channel secur devic pair protocol proceed symposium usabl privaci secur balfanz talk stranger authent hoc wireless network symposium network distribut system secur ndss februari cremer scyther tool automat verif secur protocol comput aid verif cav spideroak onlin https laci wuala onlin https tresorit onlin https pkware viivo onlin https secomba gmbh boxcryptor secur cloud onlin https sookasa onlin https sirrix secur technolog panbox transparent datei und ordner verschl√ºsselung f√ºr cloud und storag onlin content scyther spdl author protocol code list key distribut code role script scyther hashfunct scyther assum agent access built public key protocol pre establish public key infrastructur pki defin addit asymmetr key pair model key distribut protocol const function function public key default secret function correspond secret key function inversekey map allow encrypt decrypt protocol usingqr role fresh keysauth nonc random session authent key var nonc root key var mac ticket fresh nonc nonc interpret asymmetr key scyther simul oob channel communic default symmetr key function scyther keysauth macro mac verif integr encrypt root key match mac keysauth claim secret secret keysauth secret nisynch reachabl role var hash ticket var keysauth nonc fresh nonc var nonc simul oob channel communic default symmetr key function scyther keysauth hash oob messag verfic match hash send encrypt rootkey hmac integr protect macro keysauth claim secret keysauth secret nisynch reachabl appendix scyther spdl author protocol passcod list key distribut srp role script scyther hashfunct function support protocol simul modular exponenti equival protocol exponenti role simul var ticket recv_ send_ support protocol simul equal role var alpha beta ticket recv_ alpha beta send_ alpha beta support protocol simul equal role var alpha beta ticket macro keysesa macro keysesb macro alpha beta keysesa macro alpha beta keysesb macro alpha keysesa macro alpha keysesb recv_ keysesb send_ keysesa author protocol passcod base srp protocol usingpasscod role fresh nonc var beta ticket macro macro keys beta beta macro beta keys macro keys beta match send_ send recv_ keys receiv support protocol role reachabl secret secret secret keys secret nisynch role fresh nonc var alpha macro macro keys alpha macro alpha keys macro alpha keys alpha recv_ receiv support function role send_ keys send reachabl secret secret secret keys secret nisynch 