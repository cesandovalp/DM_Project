network trace system respons opaqu emul softwar servic miao steve versteeg jean guy schneider john grundi jun han school softwar electr engin swinburn univers technolog hawthorn victoria australia email miaodu jschneider jgrundi jhan technolog melbourn victoria australia email abstract enterpris softwar system complex interac tion servic environ develop test product condit challeng task prior approach includ emul depend servic explicit model record replay approach model requir deep knowledg target servic record replay limit accuraci techniqu improv accuraci record replay approach requir prior knowledg servic approach multipl sequenc align deriv messag prototyp record system interact scheme match incom request messag messag prototyp generat respons messag introduc modifi needleman wunsch algorithm distanc calcul messag match wildcard messag prototyp high variabl section entropi base weight distanc calcul increas accuraci combin approach greater accuraci evalu enterpris system messag protocol introduct softwar system increas inter connect servic emul support develop test softwar system independ system depend typic deploy scenario enterpris system interact system mainfram directori server databas type softwar servic order check enterpris system will function correct term interact servic test realist environ prior actual deploy access actual product environ test risk disrupt larg organ isat test environ close replic product environ pensiv test environ high demand softwar develop will limit access enabl develop continu access product condit test applic develop oper devop popular approach develop test depend system instal system virtual machin vmware virtual machin time consum configur maintain configur system run virtual machin product environ altern gain traction servic emul model servic emul thousand servic instanc provid realist scale complic configur exist approach servic emul reli system expert explicit model target servic requir detail knowledg messag protocol structur infeas requir knowledg unavail wide rang servic legaci servic real deploy environ time consum error prone aim develop autom approach servic emul explicit knowledg servic messag protocol structur simul high degre accuraci scale realist enterpris system deploy environ achiev autom accur effici robust method servic emul deriv servic respons collect actual network trace enterpris system servic focus paper previous work reli search collect messag trace automat generat servic respons limit text base protocol ineffici larg messag trace method employ sensit mismatch payload versus oper type robust subsequ work cluster improv effici decreas accuraci aim describ paper achiev higher accuraci effici scriptiv robust messag prototyp appli binari text protocol approach multipl sequenc align algorithm deriv mes sage prototyp wildcard messag prototyp section high variabl modifi needleman wunsch algorithm messag distanc calcul entropi base weight distanc calcul increas accuraci set experi enterpris system messag protocol includ binari textual ldap binari mainfram protocol textual json twitter soap servic experi greater accuraci generat respons messag protocol test addit effici perform generat emul servic respons enabl scale emul deploy environ motiv work consid exampl enterpris softwar system integr system product environ oper system call servic includ legaci mainfram program directori server web servic behaviour exampl enterpris soft ware system depend respons receiv depend servic directori server proprietari protocol document oper type add search modifi delet payload respons messag oper type encod singl charact small sampl set request respons messag transact librari directori servic tabl messag trace captur network monitor tool wireshark proxi section sampl transact librari illustr method work transact librari fiction protocol similar ldap protocol simplifi run exampl easier follow enterpris system test interact servic search user ident regist ident regist ident system environ share servic complex deploy environ extens test enterpris system protocol conform robust scale common approach provid test environ ment enterpris system messag protocol virtual machin implement servic deploy virtual machin communic system test major challeng approach includ configur complex maintain instanc servic type multipl configu ration cloud base test environ emerg mitig issu emul test environ enterpris system lie servic model approach messag enterpris system test respond approxim real servic respons messag kaluta propos provis emul test environ ment challeng approach includ develop model lack precis model complex protocol ensur robust model divers load condit assist develop reusabl servic model approach revers engin messag structur discov pro cess build behavior model allow engin develop precis model autom interact enterpris system test emul depend servic record replay messag trace altern approach involv record request messag enterpris system test real servic respons messag servic mes sage trace mimic real servic respons messag emul environ approach combin record replay revers engin servic model servic virtual commerci softwar tool emul behaviour servic tool assum knowledg protocol messag structur model servic mimic interact automat iii approach network oper type cluster consensus prototyp offlin process match function runtim emul system test ing request simrespons messag trace transform fig system overview goal produc emul environ enterpris system test messag trace record collect priori produc respons behalf servic invok system test runtim general approach cluster trace record group messag formul sin gle represent request messag cluster acceler runtim perform enabl incom request system test compar cluster represent entir transact librari previous work select cluster request repres accuraci decreas format request cluster discard current aim improv accuraci preserv effici generat prototyp captur common featur rang request cluster centroid transact minimis total distanc transact cluster request respons mobil mobil mobil mobil mobil mobil postcod tabl directori servic interact librari exampl approach generat prototyp depict figur step collect messag trace communic client real target servic store transact librari transact request respons pair cluster transact librari goal group transact oper type consid state servic request issu lower accuraci case discuss deriv request consensus prototyp messag pattern oper type cluster align request messag cluster reveal common featur oper type insert gap charact extract consensus charact sequenc align request messag request messag prototyp select delet charact charact posit calcul posit weight prioritis dif ferent section request consensus proto type runtim incom request messag match distanc calcul techniqu select nearest match request consensus prototyp perform dynam substitut chosen respons messag identifi oper type cluster generat final respons messag enterpris system test step perform offlin prepar request consensus prototyp step perform runtim generat live respons system test messag needleman wunsch needleman wunsch algorithm step offlin runtim process dynam program algorithm find global optim align sequenc symbol time length sequenc needleman wunsch progress score function increment score pair symbol align score will depend symbol ident gap insert collect cluster interact messag step record real messag exchang client previous version system test servic aim emul transact request respons pair communic servic respond respons messag request messag client record request respons network level tool wireshark record byte tcp packet payload assumpt messag format servic applic record transact librari step group transact oper type assum knowledg messag format achiev distanc function base cluster techniqu previous work consid multipl cluster distanc function respons similar measur edit distanc calcul needleman wunsch algorithm effect method group transact oper type techniqu work group transact similar respons messag cluster algorithm vat altern effect previous work appli cluster techniqu exampl transac tion librari yield cluster tabl iii correspond search oper add oper align request messag formul repres cluster prototyp align request messag cluster determin mon featur request messag extract common featur accommod variat align request messag cluster adopt multipl sequenc align msa techniqu origin biolog msa align three biolog sequenc reveal structur common msa reveal common interact messag offer num ber advantag techniqu gram first effect handl messag protocol singl byte oper field binari ldap protocol well multi byte oper field second reason techniqu revers engin protocol messag structur request respons mobil mobil mobil mobil mobil tabl cluster search oper request respons mobil postalcod tabl iii cluster add oper requir predetermin match sequenc width gram adopt clustalw heuri tic techniqu msa memori effici produc high accuraci align polynomi comput time empir dataset contrast origin complet msa techniqu clustalw progress msa algorithm pairwis sequenc align iter integr multipl sequenc align result overview clustalw algorithm pair sequenc align calcul similar ratio needleman wunsch algorithm number sequenc distanc matrix built captur distanc calcul guid tree construct distanc matrix appli neighbour join cluster algorithm guid tree tree data structur organis similar sequenc guid tree guid progress align sequenc leav root tree figur multipl sequenc align appli clustalw algorithm exampl cluster tabl iii msa profil gap insert align process denot symbol note common sequenc request cluster align formul request consensus prototyp deriv msa profil request messag cluster step extract common featur msa profil singl charact sequenc call request consensus prototyp facilit effici runtim comparison incom request messag system test align request messag cluster deriv byte charact occurr count tabl figur graphi calli depict byte frequenc posit exampl align figur column repres posit align result frequenc byte versteeg han cluster align ider bil postalcod cluster align fig msa request tabl iii occur posit display stack bar graph base byte occurr tabl formul request consensus prototyp extend concept consensus sequenc common summaris msa profil consensus sequenc view sequenc consensus symbol consensus symbol common occur byte posit extens request consensus prototyp calcul iter byte posit msa profil calcul prototyp symbol posit equat denot relat frequenc posit consensus symbol relat frequenc threshold denot gap wildcard symbol repres truncat calcul prototyp symbol posit truncat symbol delet request consensus prototyp introduc wildcard truncat messag prototyp allow distinguish gap consensus relat frequenc threshold insert consensus symbol posit fig charact frequenc align result search request prototyp consensus symbol gap relat frequenc threshold insert wildcard consensus symbol gap major leav posit empti delet wildcard allow encod high variabl section messag experiment truncat consensus sequenc artifici long tend gap truncat gap length prototyp typic length messag cluster consensus prototyp cluster request messag differenti stabl posit variant posit identifi consensus symbol utilis match appli request consensus prototyp method frequenc threshold exampl cluster tabl iii yield consensus prototyp search request cluster consensus prototyp add request cluster note add prototyp coinciden talli align mobil will postalcod deriv entropi base posit weight final step offlin analysi calcul weight ing byte posit consensus prototyp support runtim distanc match process request messag servic emul generat respons messag correct oper type critic content messag payload higher weight section messag relat oper type observ structur oper type stabl payload entropi measur variabl basi calcul weight byte posit consensus prototyp msa profil cluster iii calcul entropi column shannon equat qij log qij shannon ith column qij relat frequenc jth charact charact set column total number charact charact set high weight stabl part messag column invert entropi appli scale function form equat bei weight ith column entropi ith column posit constant higher valu higher entropi column deweight experi best allow structur domin match process payload similar tie breaker column correspond gap remov con sensus prototyp drop weight array tabl exampl weight array search request consensus prototyp entropi weight runtim match request messag runtim formul request consensus prototyp match incom request system test extend needleman wunsch algorithm calcu late match distanc incom request request consensus prototyp oper type cluster modifi needleman wunsch score function equat special score align wildcard charact multipli score correspond posit entropi weight equat wim wid wix ith charact consensus prototyp jth charact incom request weight ith column constant denot needleman wunsch ident score differ penalti wildcard match constant experi valu modifi score equat appli needleman wunsch align consensus prototyp incom request calcul absolut align score relat distanc denot drel calcul absolut align score normalis consensus proto type length entropi weight differ tabl exampl weight search consensus prototyp calcul msa profil figur equat constant ent number wildcard relat distanc rang inclus signifi best match consensus repres furthest distanc calcul equat drel smin smax smax maximum align score consensus prototyp smin minimum align score consensus prototyp calcul equat smax smin special symbol charact consensus prototyp consensus prototyp distanc incom messag select match prototyp identifi match transact cluster exampl suppos receiv incom add request byte sequenc align request search consensus prototyp yield request durand prototyp equat weight relat distanc calcul comparison add consensus prototyp produc align relat distanc request prototyp consequ add prototyp closest match caus add cluster select respons generat dynam substitut final step approach send customis spons incom request perform dynam substitut respons messag match cluster symmetr field techniqu describ charact sequenc occur request respons messag chosen transact substitut correspond charact live request generat respons respons centroid transact select cluster appli symmetr field substitut exampl centroid transact add cluster symmetr field box request mobil respons ddrsp perform symmetr field substitut final generat respons implement implement propos system java step previous section architectur figur commerci agreement unabl releas sourc code implement evalu want assess three key characterist proach accuraci effici robust aim answer question accuraci request consensus proto type formul pre process stage approach generat accur protocol conform respons runtim posit weight base match improv accuraci approach generat respons effici techniqu effici generat time respons larg transact librari robust homogen cluster messag oper type differ ent major messag techniqu robust generat accur respons order answer question appli techniqu messag trace dataset case studi protocol techniqu dataset assess accuraci effici robust compar previous techniqu case studi protocol trace protocol binari text field transact binari fix length ldap binari length encod ldap text text delimit ldap text text delimit soap text delimit twitter rest text delimit tabl experi messag trace dataset appli techniqu real protocol binari mainfram protocol ldap binari directori servic protocol soap textual protocol enterpris resourc plan erp system messag system servic rest twitter json protocol twitter social media servic messag trace dataset protocol addit ldap extra dataset dataset textual represent convert binari dataset denot ldap text textual dataset prior work ldap text chose protocol enterpris environ ldap text soap evalu prior work iii repres good mix text base protocol soap rest twitter binari protocol ldap fix length length encod delimit structur protocol messag includ divers number oper type indic column number request respons interact test case column transact tabl messag trace dataset download websit fold cross valid approach evalu criteria cross valid popular model valid method assess accur predict model will perform practic purpos evalu appli common fold cross valid approach case studi dataset random partit origin interact dataset group group group consid evalu group test approach remain group constitut train set process repeat time number group group will evalu group run experi trace dataset appli approach request messag evalu group refer incom request generat emul respons record time approach generat respons incom request evalu runtim effici consensus weight approach compar approach generat respons incom request utilis criteria determin accuraci evalu abil approach generat protocol conform respons criteria explain exampl tabl consid come request associ respons transact librari emul respons consid ident charact sequenc ident record expect respons exampl tabl protocol messag length field delimit convert structur sequenc byte transmit wire length field number byte length field delimit byte byte sequenc indic field expect generat expect generat iii expect generat expect generat expect generat tabl exampl accuraci criteria ident consist iii protocol conform well form malform consist expect oper type critic field payload replic exampl tabl ident payload differ protocol conform oper type correspond expect respons differ payload exampl iii tabl result tag differ well form structur correct correspond valid respons messag wrong oper type exampl tabl generat respons valid structur oper type match expect oper type malform meet criteria exampl tabl oper type generat respons invalid consid generat respons valid meet three criteria ident consist protocol conform generat respons consid invalid compar techniqu knowledg work generat applic layer respons direct trace messag comparison prior work includ librari cluster centroid approach incom request librari approach search entir transact librari closest match request synthes respons approach effect produc accur respons experiment reveal generat respons valid defin criteria general slow real time cluster centroid approach reduc number search number transact librari cluster fore generat respons real time accuraci approach baselin evalu techniqu evalu accuraci accuraci evalu conduct assess capabl approach generat accur protocol method accuraci ratio valid invalidident consist conform well form malform binari librari cluster centroid consensus consensus weight ldap binari librari cluster centroid consensus consensus weight ldap text text librari cluster centroid consensus consensus weight ldap text text librari cluster centroid consensus consensus weight soap text librari cluster centroid consensus consensus weight twitter rest text librari cluster centroid consensus consensus weight tabl vii evalu appli consensus sequenc prototyp respons discuss iii approach featur aim enhanc respons accuraci request consensus prototyp combin entropi weight distanc calcul runtim measur impact techniqu separ set experi refer consensus consensus weight addit set experi test best pre defin frequenc threshold three valu tabl vii summaris evalu consensus consensus weight prior work librari cluster centroid experi test dataset accuraci ratio column calcul vide number valid generat respons total number interact test column detail breakdown categori valid invalid respons generat tabl vii combin consensus weight approach achiev highest accuraci dataset test combin approach achiev accuraci dataset remain ldap binari twitter twitter case librari approach margin better respect impact frequenc threshold allow toler illustr equat pre defin frequenc threshold requir calcul consensus sequenc prototyp bioinformat number investig identifi best threshold experi select popular valu wholelibrari cluster centroid consensus weight real system ldap ldap text ldap text soap twitter averag total respons generat time librari cluster centroid consensus ldap ldap text ldap text soap twitter averag match time averag substitut time repres match time repres substitut time tabl viii approach effici evalu multipl sequenc align yield better ldap binari dataset threshold produc higher accuraci dataset threshold impact accuraci general conclus appear sensit threshold scenario interest result consensus weight proach higher accuraci librari approach data point trace librari three dataset consensus weight accur accuraci lower reason higher accuraci consensus weight abstract messag payload section wildcard suscept match request wrong oper type payload librari approach suscept type error note well form invalid respons librari approach tabl vii impact entropi weight observ ldap binari dataset test weight improv accuraci dataset impact weight observ consensus sequenc prototyp consensus produc accuraci effici tabl viiia compar averag spons generat time consensus weight approach librari cluster centroid approach test intel xeon cpus main memori time repres averag respons generat time request dataset tabl viiia list averag respons time real servic origin trace record order better insight runtim perform approach separ measur match time substitut time present tabl viiib consensus weight approach effici generat respons faster real servic emul respons generat time compar cluster centroid approach faster dataset slower approach order magnitud faster librari approach cluster centroid approach trade accuraci speed consen sus weight high accuraci speed compar match time versus substitut time tabl viiib observ librari approach consum time match pro cess needleman wunsch align request transact librari consensus weight cluster centroid great reduc match time twitter unusu long substitut time fast approach time spent perform substitut twitter respons long caus symmetr field identif common substr search time consum consensus weight generat respons faster real servic emul crucial support test enterpris system test realist perform condit delay slow emul respons major limit librari approach generat respons time match real servic fast servic ldap robust final test evalu consensus prototyp approach robust generat accur respons cluster process tion iii imperfect test deliber inject nois cluster creat cluster fraction interact messag oper type nois ratio test repeat experi frequenc threshold tabl summaris experiment frequenc threshold big impact preserv accuraci cluster noisi threshold best accuraci threshold accuraci stay dataset nois ratio nois ratio increas accuraci decreas binari ldap stay high dataset good result approach work best cluster produc clean toler small amount nois nois ratio consid high actual cluster process produc perfect separ nois interact messag oper type dataset test nois nois nois consensus weight consensus weight consensus weight ldap ldap text ldap text soap twitter rest tabl respons accuraci cluster noisi data industri valid propos servic emul techniqu int grate technolog commerci product servic virtual earlier version techniqu releas featur name opaqu data process version product sold custom opaqu data process custom site emul servic protocol support product emul protocol includ proprietari extens onc rpc protocol techniqu backlog futur version threat valid identifi threat valid consider generalis experiment evalu perform dataset protocol great divers messag protocol test perform messag protocol dataset random generat client request servic protocol real system interact complic dataset test real system interact warrant discuss futur work develop approach automat generat ing servic respons messag trace requir prior knowledg messag structur decod messag schema approach multipl sequenc align automat generat consensus prototyp purpos match request messag accur effici robust wildcard prototyp allow stabl unstabl part request messag oper type separ prototyp direct strict match regular express calcul match distanc modifi needleman wunsch align algorithm closest match prototyp method robust prototyp imperfect process match request prototyp length prototyp allow system handl request case direct observ trace record weight section prototyp base entropi improv match accuraci experiment messag trace dataset demonstr approach automat generat accur respons real time case approach generat accur respons imperfect messag cluster small number messag oper type limit current approach lack divers respons generat work approach identifi common pattern respons cluster solut appli multipl sequenc align respons messag distinguish stabl posi tion variabl posit variabl part respons stochast generat improv robust approach noisi cluster will utilis outlier detect techniqu remov outlier cluster appli align method approach consid servic state histori formul respons practic stateless model suffici case exampl emul target servic stateless test scenario equival request requir state respons iii test scenario requir high accur respons perform test address limit avenu futur explor process mine oper sequenc discov state model conclus develop techniqu automat generat realist respons messag network trace enterpris system emul environ outper form current approach bioinformat inspir multipl sequenc align algorithm deriv messag prototyp wildcard high variabl section messag modifi needleman wunsch algorithm calcul messag distanc entropi weight distanc calcul increas accuraci techniqu automat separ payload structur complex enterpris system messag make high robust set experi enterpris system messag protocol greater accuraci protocol test addit effici emul servic respons perform enabl scale emul deploy environ refer rutherford carzaniga wolf evalu test suit adequaci criteria simul base model distribut system ieee transact softwar engin erich amrit daneva report devop literatur review univers twent tech rep onlin http bms iebi staff amrit bass weber zhu devop softwar perspec tive addison wesley profession sugerman venkitachalam lim virtual devic vmware host virtual machin monitor proceed ing general track usenix annual technic confer usenix boston massachusett usa hine schneider han versteeg scalabl emul enterpris system proceed australian softwar engin confer aswec gold coast australia ghosh mathur issu test distribut compon base system proceed intern ics workshop test distribut compon base system ics los angel california usa schneider hine grundi versteeg generat servic model trace subsequ substitut proceed intern acm sigsoft confer qualiti softwar architectur qosa vancouv british columbia canada versteeg schneider han grundi teract trace mine effici system respons generat proceed intern workshop softwar mine softmin palo alto usa comb wireshark http sermersheim lightweight directori access protocol ldap protocol rfc select virtual solut experi vmware virtualbox journal comput scienc colleg godefroid micro execut proceed inter nation confer softwar engin ics hyderabad india grundi cai liu softarch mte generat distribut system test bed high level softwar architectur descript autom softwar engin jan onlin http aus banzai koizumi kanbayashi imada hanawa sato cloud design softwar test environ reliabl distribut system cloud comput technolog proceed ieee acm intern confer cluster cloud grid comput ccgrid melbourn australia bertolino ang frantzen polini model base generat testb web servic test softwar communic system hine emul enterpris softwar environ phd thesi swinburn univers technolog faculti munic technolog sun mannisto evalu simul server system test proceed ieee comput softwar applic confer compsac izmir turkey wondracek comparetti kruegel kirda anna automat network protocol analysi proceed network distribut system secur symposium ndss california usa cui kannan wang discover automat protocol revers engin network trace proceed usenix secur symposium secur boston usa wang yun shafiq wang liu zhang yao zhang guo semant awar approach autom revers engin unknown protocol network protocol icnp ieee intern confer ieee weerdt vanthienen baesen activ trace cluster improv process discoveri ieee transact knowledg data engin jagadeesh chandra bose van der aalst process agnost trace align opportun issu challeng system mariani pezz automat steer behavior model infer proceed joint meet euro pean softwar engin confer acm sigsoft interna tional symposium foundat softwar engin esec fse amsterdam netherland cui paxson weaver katz protocol independ adapt replay applic dialog proceed annual network distribut system secur symposium ndss san diego california usa michelsen key capabl servic virtual solut octob white paper technolog onlin http media file whitepap svcapabl aspx needleman wunsch general method applic search similar amino acid sequenc protein journal molecular biolog bezdek hathaway vat tool visual assess cluster tendenc proceed intern joint confer neural network ijcnn honolulu hawaii usa durbin biolog sequenc analysi probabilist model protein nucleic acid cambridg univers press comparetti wondracek kruegel kirda prospex protocol specif extract proceed ieee symposium secur privaci oakland usa beddo protocol informat project toorcon wang yun shafiq wang liu zhang yao zhang guo semant awar approach autom revers engin unknown protocol proceed ieee intern confer network protocol icnp austin usa thompson higgin gibson clustal improv sensit progress multipl sequenc align sequenc weight posit specif gap penalti weight matrix choic nucleic acid wang jiang complex multipl sequenc align journal comput biolog day mcmorri critic comparison consensus method molecular sequenc nucleic acid shannon mathemat theori communic bell system technic journal versteeg interact messag trace applic layer protocol onlin http doc messag long harrington hain nichol primer ibm intern technic support organis onlin http redbook pdfs pdf box ehnebusk kakivaya layman mendelsohn nielsen thatt winer simpl object access protocol soap note onlin http org note soap twitter twitter rest api onlin https doc api devijv kittler pattern recognit statist approach prentic hall intern mclachlan ambrois analyz microarray gene express data wiley intersci muller odp moot question support protocol onlin https communiti devtest communiti blog odp moot question support protocol swan swinburn technolog virtualis breakthrough australian decemb onlin http busi latest swinburn technolog virtualis breakthrough stori hodg austin survey outlier detect methodolog artifici intellig review 