secur data exchang defin unpars context sensit encod context free grammar lar hermerschmidt stephan kugelmann bernhard rump softwar engin rwth aachen univers germani hermerschmidt rump rwth http abstract exchang complex data structur distribut system document written context free languag exchang communic parti unpars document correct pars correct error unpars result inject vulner cross site script xss sql inject inject attack limit web program input produc document context free languag vulner class attack languag html javascript approach prevent inject attack context sensit encod approach tie languag aim paper deriv context sensit encod context free grammar provid correct unpars malici craft input data context free languag present solut integr encod definit context free grammar generat context sensit encod decod pars unpars process document input data influenc structur document chang intend semant defin encod languag definit develop languag provid clean interfac write read document written languag care secur relev encod introduct system constant exchang complex format requir thought design agreement communic parti order defin format good idea context free grammar parser languag construct classic kind automata recogn languag recogn base parser avoid hard undecid problem inher typic hoc parser analog send work pars unpars intern represent document develop aim easi solut implement low effort grammar parser strong data type choic build softwar read write document conform context free languag simplic creat document treat kind valu string substitut templat lure develop trend notabl xml base format negat actual structur aspect xml simplif system work fine case long secur consid critic success factor secur viewpoint simplif pars introduc develop vulner input data process exploit control behavior system case unpars influenc creat document intend develop well instanc input base vulner buffer overflow sql inject cross site script xss inject attack limit web program input data produc document context free languag vulner class attack correct emb input data document encod call sanit unpars escap filter data keyword control token languag develop intend semant document chang malici craft input data complex languag html multipl context context requir encod input data encod unpars context unknown advanc develop unstructur string substitut templat assembl document manual determin context document appli correct context specif encod prevent input inject empir analysi saxena well countless input base vulner classifi san owasp method process error prone approach eas process formal languag long histori start generat parser grammar automat format document lead general concept unpars effort prevent inject attack languag html javascript solv cross site script hermerschmidt kugelmann rump secur data exchang defin unpars context sensit encod context free grammar proceed ieee secur privaci workshop san jose usa ieee comput societi public introduc context sensit encod encod languag html well input base secur vulner identifi car industri control system system eas develop correct context sensit encod custom languag aim deriv context sensit encod decod context free grammar integr pars process provid correct unpars malici craft input data context free languag approach present paper integr encod definit context free grammar generat deriv unpars context sensit encod parser well context sensit decod generat languag process tool provid interfac read write document enforc input data influenc structur document chang intend semant develop generat tool care secur relev encod inject attack prevent integr encod languag definit approach shift problem correct encod applic develop languag develop awar specialti introduc languag case applic develop decid bigger part output document control input data enter field languag develop remaind paper structur review work iii analyz issu correct unpars encod malici craft input data approach problem present includ composit languag featur reduct input data evalu approach exampl html javascript draw outlook conclus work pars unpars field long histori unpars call pretti printer produc pretti document pretti printer generat context free grammar vice versa avoid redund inconsist languag workbench exist support develop languag develop process rascal meta program languag pars analyz transform unpars sourc code addit support grammar output document ensur syntact correct unpars pars tree rascal offer help tool implement approach languag workbench monticor approach defin languag work eclips base xtext context free grammar languag definit generat languag process tool eclips ide help develop implement secur system open web applic secur project owasp aim rais awar web applic secur educ develop librari correct process user input web applic framework exist automat prevent xss weinberg studi framework sanit input data html javascript css uri context analyz popular open sourc web applic context html languag emphas demand context sensit encod order cross site script exist applic minim modif xss guard instrument applic send request applic time actual user input second time safe dummi input subsequ xss detect work compar respons search dom differ xss guard assum user allow insert html respons construct prevent inject attack wrap languag sql strong type api produc document languag sql dom java prepar statement bravenbo general approach stringborg generat type api arbitrari guest languag sql grammar chosen host languag java addit stringborg emb syntax guest languag host languag provid develop fluent integr languag time requir complet grammar guest host languag formal approach samuel propos implement type system templat languag web applic type system determin html context user input insert templat subsequ sensit engin call correct context sensit encod input data approach unpars field danielsson propos unpars enforc correct data type unpars document present approach share fundament notion exist work languag theoret secur langsec shotgun parser will solv input valid problem addit perceiv input handl pars challeng produc output well appli formal approach propos unpars promis blitzableit felix lindner strict pars safe recogn swf format unpars swf document correct pars content subsequ pass vulner flash player strict pars blitzableit valid entir swf structur mitig vulner flash player exploit malici craft swf content blitzableit approach share idea valid data ast consequ produc correct format data summari librari framework correct process input data html appli manual correct context automat detect context languag workbench eas develop languag generat parser unpars approach type system unpars templat propos approach deriv context sensit encod context free grammar iii problem correct unpars encod analyz core problem inject attack sql inject xss document written languag communic distribut system languag communic defin context free grammar document formal recogn accept member languag reject receiv document system parser read contain document pars tree tree refin abstract syntax tree ast system develop program logic access document send analog work unpars data provid develop ast document follow definit danielsson arnoldus correct pars round trip pars process languag correct round trip ast hold pars unpars extend properti program logic common pass input system languag exampl data http request pass sql statement direct html respons adversari send special craft document system exploit inject vulner compon process logic ast output document malici craft input data data ast consid malici pars hold inject vulner context adversari produc document languag intend develop parser unpars correct round trip ast malici craft data prevent class vulner correct encod data ast document safe pars document parsedecod unparseencod properti correct pars round trip explicit assum data token ast malici craft data danielsson arnoldus assum ast valid pars data data token contrast formal unpars process develop lightweight mechan templat string substitut concaten produc document mechan requir formal definit produc languag front approach easier fall short malici craft input data insert templat data control token languag insert document pars document will result ast exploit inject vulner unpars process correct common solut implement encod function remov control token data encod escap sequenc context languag control token context individu encod exampl javascript requir encod html script tag context onclick attribut context input data templat develop correct identifi context data written appli correspond encod encod context encod control charact coincid fail encod repres inject vulner exist countless input base vulner empir analysi saxena emphas develop help solv problem consider effort spent develop encod librari framework wide spread languag html sql reus languag communic press issu domain secur emerg concern car industri manufactur prevent inject attack softwar develop develop defin languag document communic system develop will complex task languag definit process simpl write string file approach eas languag definit pars develop will help prevent inject vulner well defin correct unpars encod approach produc document unpars consid context free grammar definit languag ast document written program logic develop ast interfac document written store input data data token place input data output document malici craft input data aim inject control token store data token well util regular express defin data token grammar unpars valid data token compli definit token prevent inject vulner unpars simpli unpars document approach prevent inject token regular express formul sharp ultim prevent control token legal input data book publish work sql queri packag grammar contain option nostr nomlcom noslcom noident lexer lookahead bodi lcur element rcur element tag lcur tagstoken rcur token lcur token rcur encodet tagstoken subpars token tagstoken list monticor grammar exampl integr encod parser definit bypass limit escap sequenc encod control token data token mention escap sequenc context specif context correspond token grammar approach allow languag develop add encod tabl token defin grammar tabl defin context specif encod token encod rule translat control token escap sequenc data token encod tabl token tagstoken exampl grammar list integr encod tabl definit grammar defin encod rule crucial step languag definit control token miss encod tabl encod control token lead inject vulner unpars deriv encod tabl critic task easier default encod tabl encod control token allow data token appreci prevent error encod definit unpars context sensit encod data token transform ast document parser decod data token read document enabl correct parser round trip packag grammar tag option nostr nomlcom noslcom noident tag tag comma tag tag text token token token comma token text encodet text list monticor grammar exampl integr encod definit languag composit document kind structur behavior common written compos languag composit html javascript compos super languag languag replac nontermin grammar start symbol grammar parser construct compos grammar accept document compos languag unpars compos languag order encod defin languag appli critic achiev correct pars round trip encod applic start nest languag unpars string ast data token outer languag embed unpars appli encod defin tabl token data token encod encod tabl defin encod process appli languag deepli nest outmost applic order encod token languag encod defin encod tabl string unpars languag encod fit data token super languag essenc languag token encod encod encod data token super languag languag imbed list exampl compos languag keyword subpars mark token languag cours order encod appli correspond order decod appli pars compos languag pars super languag decod token decod pars languag decod chang escap sequenc control token super languag influenc pars inner languag control token super languag encod represent languag parser super languag influenc languag allow exampl easili emb languag data token correct defin encod tabl token reduc languag featur focus inject modifi structur document inject inject control token inject context modifi mean statement break context exampl develop intend user creat output document allow html forum wiki user input pars valid remov token user inject output document firewal configur filter unwant network traffic filter unwant token need option solv problem grammar output document reduc allow subset origin languag appropri nasti featur output languag user develop kind reduct help case develop will languag featur point grammar rewritten reduc languag token html tag name specif achiev chang grammar product encod tabl languag encod token allow user input rewrit output grammar base properti token eleg easi solut altern defin grammar reduc languag recogn valid input pars independ unpars output document valid input copi input ast output ast approach reduc input languag prevent inject reduc output languag prevent inject usabl trade reduc output grammar safe emb input data output document input matter correct unpars output document handi reduc grammar filter input system input direct output modif approach appear suitabl contrast system complex process logic chang input enrich data multipl sourc reduc output grammar inevit process logic insert data unpars assum valid fact forbidden part output languag issu fix valid input enter system valid consid context input output document implement feasibl approach implement monticor framework framework generat parser unpars encod decod context free monticor grammar defin token languag list encod tabl list text token compact represent encod tabl monticor grammar develop format encod librari exist encod written compact program code case implement allow replac generat encod specif token encod function defin java code limit error encod tabl definit encod implement librari encod data token valid regular express defin token check prevent inject token definit strict defin allow control token issu develop approach creat ast program code tedious improv applic approach templat list defin basic structur output ast templat valid document languag generat parser creat ast variabl templat data token ast replac input data provid develop add control data token ast develop alter ast unpars evalu evalu solut exampl html javascript xss promin problem tool test applic xss languag develop grammar compos defin combin languag html context javascript embed encod way definit languag complex symbol encod html bodi script bodi result html grammar context token defin bodi depend script tag bodi html tag bodi xml version encod utf doctyp html html xmlns http org xhtml head titl exampl titl head bodi form method action actionurl label input_nam label input type text input_nam input type submit regist form div button onclick alert quot quot button button onclick alert button input type text input script var script div bodi html list html javascript templat marker actionurl thing wors html inconsist context html javascript allow attribut symbol well quotat mark encod attribut javascript onclick attribut charact encod attribut alert quot open pop messag quot script bodi messag quotat mark onclick attribut comparison work onclick attribut script bodi implement special case encod tabl util generat parser decod encod unpars develop web applic html form input field produc html output document includ input data context templat list set ast data token mark replac input data setup enabl manual autom penetr test standard approach find input valid vulner web applic test generat encod decod zed attack proxi zap intercept proxi test web applic reflect cross site script vulner step activ scan automat find vulner send xss string web applic configur cross site script refelect crlf inject paramet tamper option threshold notif low set strength insan configur zap attack string rais alert alarm rais input alert output test applic list button onclick alert quot alert quot test button button onclick alert apo alert apo test button list zap alart activ scan fals posit valu correct encod javascript string liter enclos html attribut second step xss attack string fuzzdb integr zap manual test applic group attack string attack chose string group subset eleven string string submit output context mark list check correct present browser test string fuzzdb encod correct browser display execut javascript conclus futur work softwar consum input input produc document written formal languag face problem prevent input inject document well widespread vulner input inject typic name languag document sql inject cross site script xss case html javascript name mask common natur vulner prevent input inject input data encod control token document case document multipl context input data encod differ data encod input pars appli document creation depend context output document paper work problem correct unpars encod malici craft user data document languag defin context free grammar addit examin part output document defin input data subset output languag featur present approach defin encod decod grammar monticor framework implement generat deriv context sensit encod decod definit correct encod malici craft data document creation safe definit part document input data discuss approach reduc output languag valid input advantag disadvantag evalu generat encod decod exampl html javascript penetr test tool zap fuzzdb context cross site script present approach allow develop prevent input base attack xss context free languag output languag encod rule defin clear assum ideal unpars parser generat grammar consid differ parser implement add dimens problem correct unpars encod present approach plan evalu implement framework custom format defin develop studi framework softwar develop project addit plan support default encod tabl search way improv audit input data process acknowledg author sergey bratus anonym review detail comment great improv present work well benedikt westermann find xss vulner earli version encod tabl html grammar work fund excel initi german feder state govern humtec project hous rwth aachen univers refer bratus darley locasto patterson shapiro shubina plant bug trust trust input process frontier secur privaci ieee jan zaytsev bagg pars broad sens model driven engin languag system ser lncs dingel schult ramo abraho insfran springer intern publish saxena molnar livshit scriptgard automat context sensit sanit larg scale legaci web applic proceed acm confer comput communic secur ser ccs york usa acm wicher owasp communiti owasp top ten project https owasp top martin brown paller kirbi christey cwe san top danger softwar error https cwe https softwar error aho compil principl techniqu tool pearson educ india hugh design pretti print librari advanc function program ser lncs jeur meijer springer berlin heidelberg wadler prettier printer journal function program palgrav macmillan weinberg saxena akhaw finift shin song systemat analysi xss sanit web applic framework comput secur esor ser lncs springer berlin heidelberg samuel saxena song context sensit auto sanit web templat languag type qualifi proceed acm confer comput communic secur ser ccs york usa acm van den brand visser generat formatt context free languag acm tran softw eng methodol jan matsuda wang flippr prettier invert print system program languag system ser lncs felleisen gardner springer berlin heidelberg rendel ostermann invert syntax descript unifi pars pretti print proceed third acm haskel symposium haskel ser haskel york usa acm erdweg van der storm vlter boersma bosman cook gerritsen hulshout kelli loh konat molina palatnik pohjonen schindler schindler solmi vergu visser van der vlist wachsmuth van der wone state art languag workbench softwar languag engin ser lncs erwig paig van wyk springer intern publish klint van der storm vinju easi meta program rascal generat transform techniqu softwar engin iii ser lncs fernand lmmel visser saraiva springer berlin heidelberg krahn rump lkel monticor framework composit develop domain specif languag intern journal softwar tool technolog transfer sttt septemb eysholdt behren xtext implement languag faster quick dirti proceed acm intern confer companion object orient program system languag applic companion ser oopsla york usa acm van der stock owasp communiti owasp guid project https owasp guid project ichnowski manico long owasp java encod project https owasp java encod project bisht venkatakrishnan xss guard precis dynam prevent cross site script attack detect intrus malwar vulner assess ser lncs zamboni springer berlin heidelberg mcclure kruger sql dom compil time check dynam sql statement softwar engin ics proceed intern confer bravenbo dolstra visser prevent inject attack syntax embed proceed intern confer generat program compon engin ser gpce york usa acm danielsson correct construct pretti print proceed acm sigplan workshop depend type program ser dtp york usa acm sassaman patterson bratus shubina halt problem network stack insecur login bratus patterson hirsch shotgun parser secur stack nov sassaman patterson bratus locasto secur applic formal languag theori system journal ieee sept felix lindner recur lab blitzableit https github rtezli blitzableit arnoldus van den brand serebrenik unpars complet metalanguag templat engin sigplan oct bagg hasu pretti good format pipelin softwar languag engin ser lncs erwig paig van wyk springer intern publish owasp communiti inject theori https inject theori bennett owasp communiti owasp zed attack proxi project https owasp zed attack proxi project 