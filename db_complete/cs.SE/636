reason flow secur separ kernel channel base communic yongwang david sana fuyuan yang school comput engin nanyang technolog univers singapor school comput scienc engin beihang univers beij china abstract assur flow secur formal method man date secur certif separ kernel industri standard separ kernel arinc compli mainstream separ kernel secur function defin arinc develop certif separ kernel paper present effort formal verifi separ kernel arinc channel base communic provid reusabl formal specif secur proof separ kernel isabell hol reason flow secur find secur flaw arinc stan dard leakag specif valid exist secur flaw open sourc arinc compliant separ kernel introduct separ kernel creat secur environ provid tempor spatial separ applic ensur unintend channel infor mation flow partit explicit provid separ kernel decoupl verif applic partit verif ker nel small straightforward allow formal verif correct assur flow secur formal method mandat separ kernel protect profil skpp certifi ing separ kernel highest common criteria evalu level eal accomplish formal verifi flow secur tradit secur safeti critic system assur certifi kind separ kernel vxwork safeti critic system vxwork mil secur critic system trend field integr safe secur function separ kernel stanc pikeo lynxsecur open sourc xtratum design port safeti critic secur critic solut industri standard safeti critic separ kernel arinc aim improv safeti certifi cation process safeti critic system compli main stream separ kernel pikeo vxwork xtratum order develop arinc compliant secur separ kernel assur secur function defin arinc secur verifi spec ific mechan check proof arinc develop certif separ kernel separ kernel inter partit communic ipc major mechan implement control flow mechan well design ipc covert channel leak applic arinc defin function servic channel base communica tion mechan ipc formal specif verif flow secur separ kernel studi academia industri flow secur separ ker nel arinc channel base communic studi best knowledg paper effort topic paper formal specif secur separ kernel arinc channel base communic isabell hol detail technic contribut work provid mechan check formal specif compris generic execut model separ kernel event specif arinc introduc secur domain schedul messag transmitt secur polici characterist schedul ipc sep arat kernel event specif model ipc servic defin arinc defin set flow secur properti infer framework sketch implic secur properti provid secur proof indic flow secur specif find secur flaw covert channel leak arinc standard prove origin specif complet compliant arinc redesign specif vali exist secur flaw open sourc arinc compliant separ kernel xtratum pok cost work total person month challeng approach overview introduc challeng work overview approach challeng challeng work high complex arinc standard standard specifi system func tional separ kernel inform descript standard servic core channel base communic ipc take defin compli cate communic mechan includ queu sampl mode channel buffer port control enorm effort need formal verif flow secur sort hyperproperti difficult automat verifi flow secur separ kernel formal verif exhaust fort exist sort flow secur relationship arinc separ kernel clarifi secur assur certif reduc verif effort complet specif proof http ywzhao transmitt schedul partitionn channel channel arinc servic transmit msgs src port schedul schedul schedul applic arinc servic hypercal applic arinc servic hypercal applic arinc servic hypercal applic arinc servic hypercal applic hypercal dest port fig architectur target system analysi target system order address challeng concern basic function separ kernel reduc compon format flow secur hardwar interfac arinc arinc inter partit flow polici communic port channel sociat partit process partit access port configur partit hypervisor base separ kernel xtra tum manag partit process partit invis kernel omit concept process intra partit communic process arinc formal specif target system formal verifi illustr fig latest version arinc target singl core process viron work consid singl core separ kernel assum kernel concurr separ kernel implement allow block partit invok partit manag hyper call prohibit block partit communic event analysi flow secur tradit languag base flow secur handl level domain high low data pro gram assign high low label secur variat high level data variat low level data verifi infor mation flow secur separ kernel set configur partit local configur partit set event hypercal partit invok concret privat data partit classifi data high low inter partit flow polici arinc intransit polici address tradit languag base flow secur problem solv noninterfer defin state event base approach consid intransit order clarifi definit separ ker nel formal languag base flow secur state event style reason relationship tradit formul state event base approach flow curiti assum static map action domain domain tion determin sole action separ kernel map dynam hypercal occur kernel consult kernel schedul determin partit current run current run partit domain hypercal specif defin schedul curiti domain kernel schedul interf domain ensur schedul secur domain leak schedul decis arinc defin channel base communic servic port leav implement messag transmiss channel der separ kernel defin messag transmitt secur domain messag transmiss transmitt decoupl messag transmiss schedul ensur schedul interf partit analysi specif verif approach separ kernel support deploy partit unknown advanc well suit logic reason induct formal verif success experi appli isabell hol pikeo isabell hol work infer framework kernel execut model kernel event specif flow secur properti concret unwind condit event satisfi satisfi impli fig verif overview verif overview work fig order simplifi verif decompos specif part execut model separ ker nel channel base communic event specif arinc execu tion model defin basic compon state machin separ kernel event spec ific isabell hol function defin state chang event occur concret function invok execut model decomposit lead step proof flow secur defin set flow secur properti provid infer frame work execut model second step defin set concret unwind condit concret function satisfact concret unwind condit impli event satisfi classic unwind condit flow secur specif decomposit specifi cation proof improv reusabl subsequ specif refin develop implement reduc verif effort formal specif introduc kernel execut model includ basic compo nent state base kernel execut event specif nalli discuss correct formal specif basic compon fig basic compon includ secur domain secur polici communic compon compon static configur arinc compliant separ kernel domain polici illustr bold underlin fig secur domain schedul transmitt defin partit order discuss flow polici assum reflex relat specifi allow flow domain channel partit partit transmitt transmitt transmitt messag intermedi schedul schedul domain defin secur polici schedul domain noninterfer relat complement relat assert flow communic compon illustr fig ipc conduct messag channel defin abstract type messag partit access channel port endpoint channel channel link partit logic link sourc port destin port specifi mode transfer messag queu sampl mode datatyp channel_typ port_typ defin compon system configur characterist arinc compliant separa tion kernel partit polici communic compon static configur built time specif record sys_config defin system configur fix sysconf sys_config constant specif state base kernel execut event state consid type event hypercal system event excep tion action partit hypercal cover ipc servic arinc sys tem event action kernel includ kernel initi schedul ing messag transmiss type abstract event fine concret specif event illustr fig dot arrow ital kernel concurr event execut atom event enabl state function event enabl indic event execut state function exec event execut event state chang state enabl event specif defin function implement concret communic schedul messag transmiss exec event function invok concret function state defin record state consist cur rent run partit partit state communic state creat port current local variabl domain state state sequenc event execut denot final state reach execut domain event event execut domain domain sys tem event static domain event schedul schedul domain messag transmiss transmitt hand domain hypercal dynam depend current state kernel defin domain_of_ev hyperc current current return current run parti tion state reachabl event enabl state state type state reachabl initi state reachabl execut denot state reachabl initi state definit reachabl execut reachabl lemma lemma reachabl execut reachabl state equival key concept flow secur state iden tical secur domain defin equival relat state domain state ident domain state indistinguish domain set domain defin partit vpeq vpeq_part vpeq_var domv sysconf partit partit vpeq_part_comm state equival partit valu local variabl partit state communic abil state exampl communic abil destin queu port empti state partit abil abil receiv messag state equival communic abil defin partit set port number messag destin port state state equival schedul valu local vari abl schedul current run partit state equival state transmitt requir port state port valu local variabl event specif event specif defin concret function implement execut event function separ kernel paper includ kernel initializa tion schedul messag transmiss hypercal kernel initi consid initi kernel state specif defin process consid partit schedul level schedul parti tion process level arinc execut messag transmiss control schedul defin abstract partit schedul determinist choos partit transmitt current execut domain subsect discuss channel base communic servic messag transmiss event descript event specif tabl channel base communic servic arinc specifi behavior port communic servic port detail program partit ipc invok servic arinc defin eleven servic sampl queu port tabl communic architectur illustr fig event specif descript event specif hypercal creat sampl port creat sampl port identifi assign kernel return write sampl messag write messag sampl port messag overwrit pre vious read sampl messag read messag sampl port sampl portid return sampl port identifi correspond sampl port sampl portstatus return current status sampl port creat queu port creat queu port identifi assign kernel return send queu messag send messag queu port suffici space queu port accept messag messag insert port buffer insuffici space messag lost receiv queu messag receiv messag queu port queu port empti messag port buffer remov return queu port empti return queu portid return queu port identifi correspond queu port queu portstatus return current status queu port clear queu port discard messag messag buffer destin port system event schedul set partit transmitt current run domain transfer sampl messag copi messag sourc sampl port destin sampl port sampl channel port channel creat transfer queu messag copi messag sourc queu port destin queu port queu channel remov messag sourc port port channel creat sourc port empti destin port full messag lost init initi kernel state system configur stage work design event specif complet base servic behavior arinc prove unwind condi tion event find covert channel detail chang ser vice specif defin arinc avoid covert channel mccullough three way avoid covert channel unbound buffer process block messag loss discuss allow partit block communic servic unbound buffer lead bigger problem denial servic dos feasibl specif allow messag loss order avoid covert channel allow messag loss send messag queu port transmit messag queu channel set function implement servic instanc send queu messag servic implement function send queu messag maylost set function invok function definit send_queuing_message_maylost sys_config state port_id messag state bool send_queuing_message_maylost is_a_queuingport is_source_port is_a_port_of_partit fals is_full_portqueu true true send queu messag servic arinc send messag queu port fail port exist sourc port current partit port full call process block block consid paper discard messag program receiv write sourc queu port channel send read destin queu port sourc sampl port destin sampl port read trans_sampling_msgtrans_queuing_msg fig channel base communic arinc messag transmiss channel arinc defin function messag transmiss leav implement under separ kernel design basic specif messag transmiss paper messag transmiss channel fig arinc mode channel base communic sampl queu mode multicast messag singl sourc destin support sampl mode queu mode support unicast messag sampl mode messag transmiss channel copi messag sourc sampl port channel buffer destin sampl port channel whilst queu mode messag transmiss channel copi messag buffer sourc queu port remov buffer store messag buffer destin queu port channel buffer destin queu port full messag discard instanc messag transmiss queu mode defin sourc destin port creat messag buffer sourc port messag buffer remov insert buffer destin port buffer destin port full messag discard primrec transf_queuing_msg_maylost sys_config state channel_typ state transf_queuing_msg_maylost channel_queu get_portid_by_nam get_portid_by_nam has_msg_inportqueu remove_msg_from_queuingport is_full_portqueu fst fst snd transf_queuing_msg_maylost channel_sampl correct formal specif assur correct specif manual valid inspect ing isabell hol specif prove function ser correct arinc inform descript lemma event invari atom event execut correct event prove pre post condit event hoar logic isabell function implement event pre post condit execut event termin specif total correct specif termin ensur primrec definit isabell hol defin function specif prove automat isabell hol instanc correct ness lemma event creat sampl port pre condit port name configur creat port current run partit pre condit execut create_sampl _port return pair state assign identifi creat port post condit ensur identifi snd store port state port comm fst lemma correct creat sampl port get_samplingport_conf sysconf get_portid_by_nam get_partition_cfg_ports_byid sysconf current create_sampling_port sysconf port comm fst snd function correct requir prove invari data structur defin state invari safeti properti defin state predic preserv reachabl state prove invari theorem reachabl typic invari predic port consist set store creat port port state messag current port defin port port_id port_typ port belong partit defin part_port port_id partition_id port consist requir creat port set domain partial function reachabl state invari theorem prove lemma lemma execut flow secur proof present set flow secur properti defin execut model includ origin definit noninterfer leakag noninflu variant nonleakag languag base flow secur noninflu combin noninterfer nonleakag overview proof structur proof includ infer framework properti secur proof event specif formal noninterfer intransit polici channel control polici consid intransit noninterfer paper essenc noninterfer separ kernel partit distinguish final state exe cute sequenc event execut purg sequenc initi state purg sequenc event partit allow pass direct indirect remov order express allow flow intransit polici employ function sourc take sequenc event target domain yield set domain allow pass occur depend event domain state sourc function specif depend current state sourc function defin classic purg function ipurg term secur properti formul ipurg yield sequenc event event allow pass direct indirect execut remov abbrevi observ equiva lenc denot ident final state execut execut execut tradit equival defin project function output return observ state domain paper combin output state equival present subsect allow avoid unwind condit output consist defin classic nontransit noninterfer execut model noninterfer ipurg definit noninterfer ipurg function delet unsuit event strong version noninterfer introduc handl arbitrari insert delet secret event oheimb strong noninterf enc origin equival determinist case defin strong version noninterfer execut model weak_noninterfer noninterfer impli weak noninterfer execut model definit noninterfer base initi state sepa ration kernel support warm cold start start execut initi state defin general version noninterfer fol low base reachabl function general noninterfer requir system start reachabl state secur obvious noninterfer impli classic noninterfer lemma reachabl noninterference_r reachabl ipurg formal nonleakag noninflu languag base flow secur general arbitrari multi domain poli cie notion nonleakag nonleakag noninterfer bine notion noninflu murray extend origin definit nonleakag noninflu defin general form erat system base schedul definit defin execut model nonleakag reachabl reachabl schedul sysconf sourc secur proof event specif infer framework flow secur general unwind condit strong_noninflu nonleakag noninterfer noninterference_r weak_noninterfer weak_noninterference_r noninflu strong noninterfer rushbi classic noninterfer general version reachabl state general version reachabl state murray nonleakag murray noninflu variant oheimb noninflu weak_step_consist murray confidenti local_respect murray integr weak_step_consist schedul local_respect schedul concret unwind condit schedul weak_step_consist clear_queuing_port local_respect clear_queuing_port concret unwind condit clear_queuing_port event fig proof structur noninflu reachabl reachabl sourc schedul sysconf ipurg ipurg intuit mean nonleakag secret data leak initi secret data leak execut sequenc event separ kernel preserv nonleakag pair reachabl state observ domain equival domain direct indirect interfer sourc domain current run state schedul sysconf observ equival execut definit noninflu weak propos strong noninflu extend schedul state reachabl strong_noninflu reachabl reachabl sourc schedul sysconf ipurg proof structur discuss proof flow secur specif prise part infer framework flow secur properti execut model secur proof event specif proof structur work fig arrow implic properti subsect discuss part proof turn infer framework flow secur order clarifi properti flow secur specif provid infer framework execut model lower fig proven implic relat properti ecut model properti strong noninflu strongest properti satisfi properti standard proof flow secur properti discharg prove set unwind condit examin individu execut step sys tem work approach order prove strong noninflu fine general unwind condit weak step consist local respect output function specif defin classic unwind condit output consist weak_step_consist reachabl reachabl schedul sysconf domain_of_ev domain_of_ev exec_ev exec_ev local_respect reachabl domain_of_ev exec_ev weak step consist pair reachabl state observ domain state execut event indistinguish exec_ev exec_ev indistinguish domain current run domain event state interfer indi tinguish domain event weak step consist confidenti propos local respect integr event execut state affect domain domain execut event allow send secur proof event specif second step proof secur event specif definit general unwind condit order prove sati faction condit specif induct type event separ kernel prove concret event satisfi condit defin set concret unwind condit event satisfact concret unwind condit event impli event satisfi general unwind condit instanc lemma concret unwind ing condit event creat queu port lemma local respect creat queu port reachabl is_a_partit sysconf current current fst create_queuing_port sysconf pname lemma weak step consist creat queu port is_a_partit sysconf current reachabl reachabl schedul sysconf current current fst create_queuing_port sysconf pname fst create_queuing_port sysconf pname final conclud satisfact strong noninflu specifica tion flow secur properti infer frame work tabl specif proof statist specif proof item function definit loc item lemma theorem lop execut model infer framework specif correct total total discuss evalu isabell hol specif verif system sep arat kernel proof flow secur specif con duct structur proof languag isar isabell allow proof text natu ralli understand human comput deriv proof pass isabell proof kernel statist effort size specif proof tabl function definit line code loc abell hol execut model event specif lemma theorem isabell hol prove line proof lop isar ensur format flow secur specif work carri total effort rough person month valid fix covert channel arinc prove satisfac tion unwind condit event find secur flaw covert channel leak arinc covert channel queu mode channel base communic queu ing mode channel partit channel exist cure transmitt transmitt transmitt transmitt fact secur polici violat arinc first send messag invok send queu messag servic arinc servic return time buffer full return error buffer full full empti status buffer port chang messag transmiss execut transmitt local respect properti preserv send queu messag servic transmitt violat second messag loss requir transmitt transmit messag channel destin queu port full full status destin port chang receiv queu messag servic execut partit local respect properti preserv event messag transmiss transmitt violat avoid covert channel allow messag loss send messag queu port transmit messag queu mode chan nel covert channel creat sampl port creat queu port servic potenti covert channel depend concret implement avoid care design arinc servic creat sampl port creat queu port creat port return uniqu identifi assign kernel port initi specif natur number maintain identifi number initi assign increas port creation find design number covert channel flow partit event preserv weak step consist properti covert channel avoid assign port identifi port system initi system configur valid fix covert channel open sourc implement manual valid covert channel open sourc separ kernel xtratum pok covert channel valid impl mentat version xtratum valid sparc architectur buffer queu port arinc xtratum share buffer sourc port destin port queu mode channel transmitt buffer full hypercal sendqueuingport insert messag buffer notifi receiv whilst buffer full sendqueuingport return allow hypercal receivequeuingport design covert channel exist xtratum avoid secur flaw redesign hypercal sendqueuingport lose messag return buffer full version pok valid latest releas xtratum pok transmitt transfer messag sourc port destin port channel pok block process wait resourc buffer full syscal pok port queue send insert messag buffer whilst buffer full timeout return pok errno full pok port transfer respond transmit messag sourc port destin return pok errno size destin port space store messag covert channel exist pok avoid secur flaw allow messag loss block call process port buffer full syscal pok port queue send creat port xtratum pok port port array identifi covert channel discuss reusabl formal specif proof allevi enorm effort need enforc flow secur separ kernel formal specif refin concret specif separa tion kernel concret specif variabl event introduc event paper refin state equival specif suffici abstract concret specif channel base commu nicat variabl concret specif chang definit state equival variabl event manipul variabl break flow secur concret specif flow secur properti paper preserv refin event channel base communic conclus reusabl formal specif infer framework secur proof work reusabl concret specif work conclus flow secur flow secur attract effort year state event base noninterfer chosen ver ifi general purpos oper system separ kernel languag base flow secur general arbitrari multi domain polici state event base notion nonleakag oheimb combin classic noninterfer nonleakag notion noninflu properti instanti oper system formal verifi work properti variant defin specif propos infer framework clarifi implic properti formal specif verif separ kernel formal method appli separ kernel year overview isabell hol specif generic separa tion kernel publish euro mil project provid abstract specif control interrupt separ kernel cisk instanti separ kernel model appli pikeo separ kernel isabell hol specif extend separ kernel specifica tion formal specif work detail model arinc channel base communic cover work concret communic action specif ipc syscal pikeo arinc channel base commu nicat formal verif arinc formal verif consid year formal specif arinc architectur model arinc model driven develop ima applic verif applic softwar top arinc system function servic requir arinc formal event inconsist standard work aim safeti separ kernel applic work conduct formal secur analysi arinc standard conclus futur work long term goal project verifi secur separ kernel sourc code level paper present case studi pli isabell hol formal verifi separ kernel arinc channel base communic provid formal specif mechan check proof total free covert channel provid informa tion flow secur high assur system reveal covert channel arinc valid exist xtratum pok specif reusabl subsequ specif refin develop implement proof work allevi verif effort flow secur step will develop formal specif separ kernel support multi core specif paper will revis kernel concurr tween core will find feasibl verifi multi core separ kernel refer lynxsecur separ kernel hypervisor http product hypervisor cess sysgo pikeo hypervisor https product pikeo rtos virtual concept access wind river vxwork platform http product vxwork certif profil access wind river vxwork mil platform http product vxwork certif profil access aeronaut radio arinc specif avion applic softwar stan dard interfac requir servic novemb clarkson schneider hyperproperti journal comput secur cmara castro gallardo merino verif support arinc base avion softwar softwar test verif reliabl craig formal refin oper system kernel chap springer dam guancial khakpour nemati schwarz formal verif flow secur simpl arm base separ kernel proceed acm confer comput communic secur ccs acm york usa delang lec pok compliant oper system releas bsd licens proceed real time linux workshop delang pautet kordon model valid architectur proceed embed real time softwar system confer ert freita mcdermott formal method secur xenon hypervisor interna tional journal softwar tool technolog transfer heitmey archer leonard mclean appli formal method certifi secur softwar system ieee transact softwar engin hoar axiomat basi comput program communic acm levin irvin weissman nguyen analysi three multilevel secur architectur proceed acm workshop comput secur architec ture csa acm masmano ripol crespo metg xtratum hypervisor safeti critic embed system proceed real time linux workshop mccullough noninterfer compos secur properti proceed ing ieee symposium secur privaci ieee comput societi millen year covert channel model analysi proceed ieee sym posium secur privaci ieee murray matichuk brassil gammi bourk seefri lewi gao klein general purpos proof flow enforc proceed ieee symposium secur privaci murray matichuk brassil gammi klein noninterfer oper system kernel certifi program proof springer nation secur agenc govern protect profil separ kernel environ requir high robust nipkow wenzel paulson isabell hol proof assist higher order logic springer verlag berlin heidelberg von oheimb flow control revisit noninflu noninterfer leakag proceed european symposium comput secur esor springer oliveira gome formal specif arinc architectur circus thesi univers york richard model secur analysi commerci real time oper system kernel design verif microprocessor system high assur applica tion springer rushbi design verif secur system acm sigop oper system review rushbi noninterfer transit channel control secur polici tech rep sri intern comput scienc laboratori sabelfeld myer languag base flow secur ieee journal lect area communic sana butterfield hinchey separ kernel verif xtratum case studi verifi softwar theori tool experi springer velyki freita formal model separ kernel compon proceed intern colloquium theoret aspect comput ictac springer verbeek tverdyshev formal specif generic separ kernel archiv formal proof verbeek havl schmaltz tverdyshev blasum langenstein stephan wolff nemouchi formal api specif pikeo separ kernel nasa formal method springer wild greve richard hardin formal verif partit manag microprocessor design verif microprocessor system high assur applic springer zhao formal specif verif separ kernel overview arxiv print http zhao yang sanan liu event base formal safeti critic oper system standard experi report arinc event proceed ieee intern symposium softwar reliabl engin issr ieee comput societi 