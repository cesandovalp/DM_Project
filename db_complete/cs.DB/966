decid equival aggreg count distinct queri babak bagheri harari val tannen comput scienc depart univers pennsylvania abstract address problem equival count distinct gregat queri prove problem decid decid third level polynomi hierarchi introduc notion core conjunct queri comparison extens classic notion rela tional queri prove exist isomorph core queri suffici condit equival conjunct queri comparison sim ilar classic relat set condit equival count distinct queri introduc relax condit base notion queri equival initi queri introduc captur behavior count distinct oper introduct problem decid equival conjunct gregat count distinct queri investig start late problem decid aggreg oper includ sum averag count count distinct queri suffici condit propos open problem decid paper studi problem equal count distinct conjunct queri provid suffici condit problem introduc notion core conjunct queri comparison classic relat conjunct queri exist isomorph core conjunct queri comparison suffici nec essari condit equal condit suffici condit equal conjunct queri easi exist iso morphism condit equival count distinct queri suffici condi tion relax condit base newli introduc notion flip queri flip count distinct queri count distinct queri equal origin queri flip direct comparison variabl queri queri compar equal queri flip isomorph second queri flip comput core queri flip upper bound complex suggest algorithm preliminari consid order dens domain countabl infinit set variabl term constant variabl relat set term ari relat subset cartesian product simpli term relat ariti implicit relev ident relat set denot biject relat map term binari relat denot dom domain set element defin denot set element function map binari relat term function biject set function exact exact partial biject set biject subset subset biject invers denot function pair binari relat set restrict denot relat restrict domain element function extend function function databas assum countabl infinit set lation name relat assign ariti ariti greater equal relat schema finit set relat name ariti finit subset relat instanc set finit subset iariti relat schema relat instanc set instanc databas instanc activ domain adom subset adom occur assign assign partial function assign con stant term rela tional instanc assign notat denot instanc appli substitut term formal homomorph isomorph biject relat instanc homomorph map adom adom defin function adom adom extend relat name ariti impli homomorph wrt biject denot case homomorph relat exist refer wit homomor phism notat need emphas wit homomor phism case biject relat simpli refer biject relat relev clear context drop simpli homomorph denot isomorph denot exist biject relat clear context drop simpli isomorph denot wit isomorph clear context drop simpli wit isomorph conjunct queri comparison bor row definit name convent schema set dist distinguish variabl sequenc call summari row summari set nondist distinguish existen tialli quantifi variabl iii set rel distinct conjunct conjunct atom mula form variabl constant dist nondist set comp comparison form dist nondist denot set distin guish distinguish variabl var var dist nondist relat instanc conjunct queri answer denot set signment form nondist adom assign exist assign dist adom follow hold rel comp queri assign notat denot queri appli variabl homomorph isomorph conjunct queri comparison biject queri homomorph map linear comparison homomorph wrt biject denot case homomorph relat exist refer wit homomor phism notat need emphas wit homo morphism case biject relat simpli refer biject rela tion relev clear context drop simpli homomorph denot isomorph denot exist biject relat extend relat name ariti impli relat name ariti impli comparison comparison clear context drop simpli isomorph denot wit isomorph clear context drop simpli wit isomorph extens queri count distinct queri extens denot ext count distinct queri set comparison defin adom exampl assum extens easi extens queri exist homomorph equival origin queri equival count distinct queri address main equival count distinct introduc notion core conjunct queri comparison exi tenc isomorph core queri coincid equal will introduc relax condit notion flip conjunct queri introduc paper captur isomorph count distinct queri equal final will prove count distinct queri equal pair origin queri flip isomorph equival conjunct queri comparison introduc core conjunct queri parion general concept core rela tional conjunct queri will notion core coincid classic definit restrict relat queri classic tion core exist isomorph core queri comparison impli equal queri vice versa definit core conjunct queri comparison core queri homomorph queri homomorph equival inject homomorph inject function ext theorem core count distinct queri uniqu isomorph equival theorem conjunct queri compar ison core exampl consid queri core lemma core conjunct queri comparison comput lemma notion core conjunct queri comparison equival classic notion core conjunct queri relat queri lemma conjunct queri comparison equal core isomorph lemma core count distic queri isomorph equival equival count distinct aggreg queri flip queri isomorph core queri condit equal count distinct queri find suffici condit introduc relax condit introduc notion flip queri count distinct queri exist isomorph queri flip queri flip suffici condit equival order defin flip queri introduc notion equival set variabl queri subset variabl queri initi variabl variabl set homomorph equival comparison definit equal set variabl count distinct queri variabl var potenti equal set set var variabl homo morphic equival queri drop comparison consid queri drop comparison variabl variabl notic variabl potenti equal set equal set variabl subset variabl queri lemma theorem prove variabl uniqu bigest equal set lemma consid satisfi set parison equal follow hold linear exist set term strict exist set term linear strict linear lemma consid count distinct queri variabl var par tial equal set set comparison remov vari abl linear variabl linear proof linear lemma exist chain comparison assum element chain member consid fact variabl path lemma linear final fact definit homomorph equival queri drop comparison variabl lemma consid count distinct queri variabl var equal set variabl exist path exist path comparison variabl proof consid path lemma replac path path comparison variabl consequ path parison variabl theorem exist uniqu maxim equal set variabl count distinct queri partit variabl rest paper refer bigest equal set variabl belong wrt equiv theorem count distinct queri vari equal set subset proof assum equal set variabl belong will set satisfi condit equal set contradict assumpt maxim set satisfi condit equal set consid queri contd queri drop comparison variabl consid variabl homomorph equival wrt follow hold consid queri drop parison variabl definit exist function extend satisfi condit homomorph linear comparison wit momorph differ comparison variabl condit homomorph hold linear comparison assum case prove linear lemma exist chain comparison lemma exist path comparison variabl consequ lemma linear case case homomorph equival wrt consequ homomorph equival case lemma count distinct queri variabl equiv comput polynomi space size queri proof queri guess subset variabl satisfi condit equal set check superset set satisfi condit equal set check homomorph problem readi defin notion flip queri definit flip queri count distinct queri flip denot flip count distinct queri chang direct comparison oper equiv notic definit flip queri will equal queri equiv lemma count distinct queri flip notic lemma equival flip set queri consid count distinct queri flip proof idea definit flip comparison equal set tice equiv equiv con tain variabl variabl equival class equiv exist homomor phism guarante match exact set term group answer databas equiv variabl group variabl purpos equival contain queri check assign match exact number item equival count distinct queri lemma set variabl variabl set comparison variabl set order valu consid dag construct variabl node edg weight edg weight number val assign assign valu variabl satisfi comparison maximum dis tanc variabl parent maximum distanc children dag repres comparison lemma consid set variabl variabl set compar ison variabl consid dag construct variabl node edg weight edg weight denot number assign valu variabl satisfi comparison set valu order domain follow hold exist homomorph dag dag linear parison comparison denot set comparison flip direct exist homo morphism dag dag linear comparison comparison proof direct consequ lemma theorem count distinct queri decid check equival proof idea algorithm check equival count distinct queri consid queri compar comput core core comput flip core equal equal isomorph core flip core queri suffici condit decid equival lemma equal equal lemma impli equal equal result isomorph infer equal conclus paper discuss problem equival count distinct queri comparison prove cidabl problem introduc tion core queri comparison flip dens order domain open will happen discret domain address problem equal iti check isomorph legitim open question will happen problem contain count distinct queri refer cohen contain aggreg queri sigmod record cohen nutt sagiv decid equival conjunct aggreg queri journal acm cohen sagiv nutt equival aggreg queri negat acm transact comput logic klug conjunct queri inequ journal acm nutt sagiv shurin decid equival aggreg queri proceed seventeenth acm sigact sigmod sigart symposium principl databas system pod 