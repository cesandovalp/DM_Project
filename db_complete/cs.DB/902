evolv nosql databas downtim karla saur intel lab tudor dumitra michael hick univers maryland colleg park tdumitra mwh abstract nosql databas redi cassandra mon godb increas popular flexibl lightweight easi work applic databas will evolv time necessit prefer chang format organ data problem address paper support evolut high avail applic nosql data onlin excess delay interrupt presenc backward incompat data format chang kvolv extens popular redi nosql databas solut problem kvolv permit develop submit upgrad specif defin transform exist data newest version tran format appli lazili applic interact databas avoid long paus time demonstr kvolv express support substanti practic updat includ format chang redisf redi back file system impos essenti overhead general minim paus time updat introduct nosql databas redi cassandra mongodb increas choic store persist data domin tradit sql base databas manag system nosql databas ganiz key store provid simpl key base lookup updat servic sql databas typic lack formal schema specif applic attach mean format key valu store databas key typic structur string valu store object repres format protocol buffer protobuf thrift avro json object databas schema chang frequent applic support featur busi exampl multipl schema chang appli week adword databas applic nosql data base evolv data format time requir modifi object add delet field split object map multipl key singl key renam key field chang compat version applic straightforward deploy field shut run applic migrat object databas format format start version applic high avail applic prefer avoid downtim shutdown restart upgrad evolv work perform univers maryland databas challeng thrift protobuf avro provid support format chang allow alter ation data encod track version schema task updat object databas iter key larg amount data creat unaccept long paus extrem exampl wikipedia lock edit upgrad mediawiki schema convert version hour develop avoid shut applic make format backward compat format impos constraint futur evolut applic grant applic read access databas migrat take place applic occasion write will suffer general approach evolv databas onlin migrat data lazili updat applic access object format object convert format fli long paus migrat data amort updat execut caus slower queri updat full stoppag current task implement lazi data migrat fall develop applic rewritten expect data format migrat format encount approach code mix applic format mainten logic guarante data will ultim migrat migrat code expand format chang confus harder maintain address problem paper present kvolv nosql databas automat support upgrad lazi data migrat kvolv present logic view applic data newest version format convert data key valu convert access applic pleasant kvolv requir chang applic code simpli indic data version expect connect databas permit proceed expect version logic version match data upgrad instal applic incompat version updat simpl restart stand key store evolut applic version dynam softwar updat dsu concurr applic switch parallel appengin avoid lost applic state shorten paus time kvolv trigger convers automat data cess track progress kvolv attach version identifi entri convert key valu convers written develop kvolv ensur updat instal atom support fault toler kvolv automati calli ensur convers place atom trigger databas action kvolv avoid race clobber concurr access kvolv requir conver sion function access correspond key key valu allow violat logic consist depend order convers trigger support lazi transform key revers unambigu examin open sourc softwar histori experi suggest realist convers typic satisfi restrict describ proof concept implement kvolv extens popular redi key store evalu implement extens micro benchmark standard redi perform benchmark macro benchmark featur rich applic redisf amico experi kvolv impos essen tialli overhead normal oper complex applic upgrad downtim partic ular upgrad redisf kvolv upgrad filesystem data kitsun program updat framework dynam updat redisf driver result seamless maintain file system mount point upgrad downtim summari three contribut identifi challeng evolv nosql databas downtim knowledg propos general purpos automat solut problem iii describ proof concept implement extens redi key store evalu implement extens combin kvolv dynam program updat tool downtim upgrad problem upgrad detail problem updat nosql databas drawback prior solut approach kvolv detail section nosql dbs store nosql databas distinguish tradit relat databas manag system rdbmss port simpl lightweight interfac focus nosql variant refer key store impli focus map key valu core oper return customerid foo sushi order orderid uxw orderd orderitem product cooki price orderitem product cooki fullpric discountedpric origin format updat format fig json object updat map databas set add overwrit map databas exampl store includ redi popular target proof concept implement project voldemort berkeley store place format requir valu treat bytearray applic typic store valu adher format json avro protobuf store expect specif format cassandra defin type row tabl mongodb employ document likewis key format unstructur string structur system notion prefix namespac exampl applic updat exampl adapt sadalag fowler consid store track purchas order applic store order store key form uniqu invoic number valu format json record describ purchas custom order key order prefix assist key group encod tabl exampl json record figur suppos upgrad applic support differenti price necessit chang data format store key remain valu chang renam field price fullpric insert field name discountedpric reduct origin price updat orderitem array element json object figur approach data upgrad eager data upgrad approach implement data upgrad describ simpli halt client applic script convert defin primit type number string boolean null defin contain type array order list valu json type object unord collect valu json type field label json exampl format support kvolv upd upd spec val val upd vali valyupd redi kvolv clienti valx clientx clientu instal close fig kvolv architectur data store data updat client restart exampl convers script purchas order modifi store updat result exist purchas order script replac exist element orderitem array element price field renam fullpric discountedpric field initi price simpl downsid deploy strategi disrupt servic databas upgrad experi modest size databas hundr thousand key disrupt order minut larger scale twitter deploy instanc redi data center instanc heap updat data size will time consum manual lazi data upgrad paus servic databas eager upgrad sadalag fowler programm modifi code handl format migrat data lazili encount exampl applic access fullpric field purchas orderitem array field applic updat describ approach work add greater burden programm add version check code code upgrad valu upgrad impli involv addit set updat format explain subsec tion oper result data corrupt race condit wors version check updat code will grow time mention will complex applic expand deal varieti data valu result mainten headach iii kvolv kvolv aim solv upgrad problem enjoy best featur lazi eager data upgrad kvolv migrat data lazili access applic elimin long disrupt paus kvolv present logic consist view applic provid appear data instant upgrad version result programm add version manag code applic simpli write applic assum data version lazi migrat handl kvolv ensur error concurr interact kvolv design approach character three techniqu version data associ logic version identifi databas content global data version track separ version data associ key prefix data map key separ version space data map key version tag store data item indic actual version earlier logic data item migrat version tag invis applic access databas applic connect databas indic version key prefix will kvolv compar logic version prefix match kvolv accept connect updat specif state transform function databas upgrad oper instal specif describ mechan specif defin logic prefix version state transform function upgrad valu transform function associ key prefix key form map will updat map kvolv handl key format chang discuss demand lazi transform updat speci ficat instal applic connect databas disconnect will reconnect code version mirror situat eager upgrad oner applic discuss applic version start run will submit set kvolv handl access kvolv updat stale item appropri transform function data item version transform function will compos appli automat illustr three techniqu figur clientx initi connect version access map safe clientu updat databas version includ state transform function prefix function concaten string upd exist updat clientx disconnect version inconsist logic version final clienti connect databas version perform key key map stale version kvolv remap key produc run transform function return updat clienti ensur logic consist goal provid logic consist view applic sequenc command issu client produc interact fulli eager updat databas data migrat lazili access goal impos three requir implement state transform occur atom oper induc second transform function refer version updat key key chang restrict third updat specif persist instal logic consist maintain recoveri fault atom upgrad data atom ensur client access data concurr lazi transform will anomali occur eager upgrad normal oper anomali introduc consid trace client set client suppos map databas transform function oper produc eager updat updat execut schedul client retriev client set client set case return case final databas map lazi updat transform invok return implement convert client command deal set set updat return transform client case client set schedul client set result return set set overwrit final state eager case effect improp implement lazi updat client oper fail silent notifi failur anomali violat logic consist contrast schedul client read updat atom benefit hand modif code support lazi migrat ensur atom automat limit domain transform function kvolv restrict transform function way transform oper version key updat item databas second transform chang key arbitrarili support unambigu biject prefix restrict ensur run will oper key valu updat instal key stale will updat ensur logic consist view hand allow access data item easi logic consist broken exampl suppos function updat key examin version code execut set prior read second restrict ensur lazi key updat implement safe effici updat initi applic version will issu command key exampl suppos updat chang prefix key updat applic will submit command key sure version key transform transform map key prefix databas version hand key kvolv version key case updat kvolv will transform backward produc limit transform key prefix help backward transform effici kvolv match key version prefix direct restrict transform function concep tualli limit practic analyz activ project github redi store program data program contain chang depend chang key chang limit prefix chang fault toler store provid fault toler guarante checkpoint databas recov crash databas crash lazi upgrad implemen tation ensur logic view retain recoveri kvolv ensur store data version tag databas persist store updat specif logic version databas atom updat instal databas crash updat fulli instal recoveri databas will appear correct version updat fulli instal databas identifi logic version lazi migrat pick left recov failur implement describ implement kvolv modular extens popular redi key store kvolv implement overview kvolv implement separ librari compil redi work preprocess command come client pass redi depict figur step client issu command set val step kvprocesscmd hook call preprocess command dash green box set my_val redi kvolv void processinputbuff rediscli processinlinebuff kvprocesscmd processcmd kvprocesscmd robj arg ver robj type string ptr my_val encod ver processcmd cmd proc addrepli procset robj arg robj arg setkey repli fig workflow redi kvolv kvolv librari kvolv preprocess complet involv chang content version field control return normal redi step processcmd function call function pointer blue depend choic command procset client request set add object databas includ chang version field set process final step redi respond request acknowledg client execut set command sure atom redi singl thread process command receiv entireti move redi command multi execut group command atomi calli design work concert command basic interceptor architectur work multi thread store implement employ appropri synchron describ instal updat updat consist transform function will convert version key version programm compil transform function share object file direct kvolv instal repurpos redi command instal complet share object metadata store persist redi kind updat key updat key updat exampl figur transform exampl figur key string binari data pass refer function will updat version refer case bodi function jansson librari implement chang purchas order exampl figur describ line updat key chang write code bit tedious prior work easili implement domain specif languag simplifi process void test fun updval char key void size val len json root json load json arr json json root order orderitem iter product price array entri json array size arr set discountedpric price set fullpric price delet price json dump root set updat val len strlen set updat val length fig exampl pseudocod transform function json transform function updat specifica tion function invok share object load updat function consist seri call instal transform function exampl instal call kvolv upd spec order order test fun updval call indic order prefix chang version version test fun updval call key prefix order key prefix chang requir transform function exampl amico program describ tion key renam prefix prefix describ updat initi function includ call kvolv upd spec version number final indic function manipul kvolv will close connect client version updat prefix disconnect client will allow reconnect upgrad version client updat prefix will kvolv process connect kvolv code support disconnect upgrad restart straightforward experi disrupt user exampl custom face client web browser maintain session perman backend server connect kvolv upgrad updat pattern common load balanc stateless server kvolv store updat specif indefinit find transform function small amount space relat rest data program updat larg frequent employ background client thread forc updat outdat data updat entri freed essenti hybrid lazi eager approach key lookup updat instal logic version advanc version transform format key kvolv version key set command updat key iii support updat hash tabl uiht tabl map key prefix record prefix pointer record describ previous version prefix exampl key updat foo tabl map prefix foo record pointer record point tabl map prefix kvolv trace current version prefix appli updat record transform function move forward version track client connect prefix version disconnect updat key updat client queri will key mat updat prefix foo client command will refer key kvolv will key exist issu updat version key kvolv uiht record map prefix case kvolv will prefix point prefix foo reissu client command key find updat key return client match will continu follow backpoint uiht prior version consid mean key kvolv return control redi action key previous prefix add addit lookup updat key version case key prefix version will add unnecessari addit lookup time key queri applic frequent queri key prefix chang negat impact perform previous work experi sentinel mark key absent skip step check key previous prefix save lookup time bit extra storag set valu simplest case key map string valu consid case implement current support redi command main redi data structur string set list hash sort set discuss contain subsect focus implement command modifi data major redi command implement impact updat data command network pub function connect client request involv string kvolv prelookup exist robj structur databas version exampl key pair string type string str column figur action retriev pointer robj string type string ptr encod lru refcount ver robj set type set ptr encod lru refcount ver robj set type set ptr encod lru refcount ver val hash hash intset encod length int content dict size iter val key string_str string_hash int_set fig store data type actual object structur store databas modif kvolv object will automat store redi note requir addit databas lookup kvolv top redi will lookup handl client request oper incur excess overhead relat oper kvolv perform version field robj exampl version red string str figur current prefix key key current prefix robj exist key kvolv return control redi process version current current prefix prefix kvolv will updat key perform updat transform function meta data prefix version updat appli store updat hash tabl kvolv appli updat case key prefix chang kvolv updat hash tabl perform key renam leav untouch case chang kvolv call applic user suppli function appli start oldest need updat work forward current version transform function appli kvolv store updat robj pointer actual structur store databas updat version string match current version set field robj action key prefix chang kvolv will perform kvolv return control flow redi redi perform will retriev return newli updat key client set client request involv set string kvolv check request flag prevent set flag set key exist set key exist kvolv lookup databas determin key exist indic will set request key describ prefix chang kvolv will search key prefix exist will set flag kvolv return control redi set command command redi will robj databas redi delet robj replac request kvolv set current version string robj prefix key rememb attempt updat key provid guarante version set occur key prefix chang kvolv delet key ensur deprec key version unnecessarili bloat redi exampl chang redisf present key prefix name skx updat postfix dir key name user set key root updat leav key skx root databas kvolv check exist version key prefix exist delet check prefix previous chang check delet key point kvolv return control redi redi add robj structur databas updat version string retriev set hash list sort set redi data structur contain valu base redi contain robj structur store actual data figur exampl column three robj hash string set integ kvolv store version contain contain valu avoid pervas chang redi updat contain happen process set contain element string type describ updat element updat redi provid iter experiment consid perform impact kvolv normal oper updat experi mental summar standard benchmark includ redi kvolv add essenti overhead normal oper determin store version updat redi add overhead space updat redisf file system includ renam ing key compress data store key oper overhead nois tabl max resid set size rss program max rss redi empti redi byte valu kvolv empti kvolv prefix byte valu paus time close oppos second offlin data migrat updat amico social network system overhead paus time close oppos second offlin data migrat experi perform comput processor intel xeon cpu ram gcc red hat enterpris linux server releas test report median trial communic localhost latenc steadi state overhead report steadi state overhead kvolv port includ benchmark redi bench redi bench act client repeat issu command redi default set redi bench client repetit singl oper time request round trip singl key set singl key multipl time redi bench allow configur longer benchmark increas number oper oper realist benchmark perform oper key leav rest default set experi localhost latenc chose three type oper string set pop list pop three type set oper string set set add list push default benchmark oper test suit tabl steadi state overhead experi unmodifi redi column comparison broke overhead separ categori kvolv prefix updat declar caus kvolv return key column kvolv singl prefix declar caus hash lookup version check key column kvolv previous prefix declar previous key prefix caus hash lookup version check string concaten exist previous key column column tabl total time test siqr semi interquartil rang varianc overhead comparison unmodifi redi benchmark time configur multipl key prefix track fewer key fewer client overhead vari general consist pattern test repeat test exact setup number present tabl negat posit overhead reflect variat notic siqr number varianc high high tabl redi bench redi kvolv time second median trial redi kvolv kvolv prev kvolv time siqr time siqr time siqr time siqr singl string instruct string set list pop list push string pipelin string set instruct list pop list push eager kvolv lazi upd second rie lazi pda tes cond creat file access file fig lazi eager updat redisf set string kvolv prefix fourth row column bottom half tabl modif origin overhead experi pipelin feed instruct round trip redi bench localhost reduc overhead put emphasi kvolv oper number bit overhead allow bound overhead subsequ pipelin instruct test demonstr overhead kvolv pipelin version common scenario tabl overhead buri low test program describ amico pipelin instruct round trip redisf pipelin addit time overhead kvolv incur addit memori overhead track version tabl maximum resid set size report empti redi kvolv amount size memori key map byte valu separ prefix declar kvolv take memori unmodifi redi includ extra version field byte structur amount space take store version lookup hash tabl extra pad automat addit structur redisf redisf redi backend fuse file system inod directori file system data store redi startup fuse mount directori redi backend user perform normal oper file system data silent store redi redisf releas line code redisf releas march file data store redi binari string compress directori key format skx path todir redisf releas march file data compress zlib directori key format path todir note redisf contain error retract version chang imposs view directori file redisf file creat redisf version inod data store redi key meta modif time file size data file system repres redisf prefix skx prefix directori updat redisf prefix inod updat add compress redisf path directori track intern structur updat redisf compat kvolv line code version consist addit call redi start declar prefix version addit line error handl sure prefix proper set perform updat redisf redisf migrat key offlin refer eager version kvolv automat renam directori key access add compress file access addit updat redisf kvolv kitsun program updat softwar allow dynam updat redisf data user experi downtim switchov complet seamless kill red isf restart redisf mount point unmount remount caus user switch mount directori remount kitsun mount point disrupt switchov file system benchmark postmark generat workload redisf creat initi file rang byte subdirectori root directori total directori postmark root directori mount point access file full path avoid chang directori restart eager kvolv kitsun version second lazi pda tes cond rie eager kvolv lazi upd fig lazi eager updat amico figur redisf experi second postmark switch creat file read append exist file left axi kvolv eager version averag queri second qps display solid fine dash line second kill redisf kvolv kitsun dynam updat redisf paus maintain mount point benchmark lost access file directori structur kvolv continu process queri updat eager version halt traffic redi migrat data perform renam compress updat key need updat directori key need renam data key need compress databas contain total key updat key search databas paus time offlin updat process second tabl iii addit show qps line green dash figur number lazi updat second kvolv correspond axi updat number burst key second trail key lazili updat kvolv renam directori key updat version key prefix compress data key prefix contain file data impact updat experienc redisf minim qps dip updat return full speed second mark experi updat qps slower kvolv redisf file compress decompress access amico amico map relationship style social network defin set user relationship amico api allow queri data set user user number user amico back redi ver sion creat written line rubi code amico version releas feb tabl iii offlin updat paus time paus updat event amico renam redisf compress renam total key databas store relationship type redi key prefix ver sion releas feb consecut version develop concept scope graph store redi prefix separ school network network default scope default key prefix exampl chang databas creat amico incompat amico amico work kvolv chang line code version declar prefix amico connect redi experi livejourn data set snap librari livejourn data set node direct edg defin order node number shuffl separ file read random order creat workload start program call amico program read random file add node amico network program read second random file perform queri node network queri user user queri number follow user let program second minut redi databas file key node edg data second mark figur stop amico program eager case fine dash updat key renam default scope prefix key name migrat second tabl iii addit paus eager case continu disrupt second mark migrat complet start writer reader program time amico kvolv case solid start amico program updat key lazili migrat updat point drop qps left axi spike return origin rate dash green correspond axi number lazi updat place second larg data set key access full advantag lazi lazi updat continu rate second second mark impact queri second solid maintain qps updat work realm relat databas evolut schema character chang creat tabl statement instanti schema subsequ version applic practic complex schema chang requir applic offlin lock databas tabl updat wikipedia held write lock hour prior propos support block schema chang accept copi databas object implement chang fli trigger log redo addit profession tool perform alter tabl oper block manner tool focus databas chang implement backward compat avoid break applic logic avoid limit imago system propos instal version parallel univers dedic applic server databas allow perform upgrad atom achiev practic deploy parallel appengin applic multipl version approach duplic resourc expos version live workload data migrat complet contrast databas googl implement asynchron protocol remov tabl column index allow server distribut databas system access updat data schema chang transit schema time achiev stateless databas server tempor schema leas identifi schema chang oper inconsist break sequenc schema chang preserv databas consist long server schema version spanner distribut key store backend support chang key format valu regist schema chang transact specif time futur util global synchron clock coordin read write transact system address chang format protobuf store column spanner valu inconsist caus interact state client schema schema evolut nosql databas well derstood databas provid data defini tion languag schema applic attach mean format key valu store databas format evolv time valu correspond data structur serial json binari format thrift protobuf avro format schema awar parser includ support schema chang skip unknown field attempt translat data writer schema reader schema orchestr actual chang data applic logic entir programm approach defin schema chang defin declar ativ schema evolut languag nosql databas languag allow comprehens schema chang enabl automat generat databas queri migrat eager schema paper mention possibl perform migrat lazi manner need avoid downtim design implement detail provid approach domain specif languag dsl scribe data schema migrat python haskel datatyp approach focus problem synthes transform code migrat schema version transform typic appli offlin increment onlin paper focus appli transform halt servic synthes transform code practic develop advis handl schema chang custom code applic logic modifi data databas approach burden programm complex code mix applic schema mainten logic provid mechan reason correct schema chang perform concurr live workload work bodi dynam softwar updat aim modifi run program fli caus downtim except posit paper approach focus chang code data structur load memori chang format persist data store databas vii conclus futur work paper present kvolv general approach evolv nosql databas downtim kvolv adapt redi migrat data access reduc downtim result data upgrad minim requir chang applic find kvolv impos essenti overhead perform updat minim overhead perform updat futur expand kvolv work redi cluster distribut implement redi add direct support programm backward compat updat support continu oper restart client final streamlin write transform function dsl simplifi updat plan process plan releas code freeli refer redi http apach apach cassandra project http mongodb mongodb http guid market guid memori dbms http asay nosql databas eat relat databas market http articl nosql databas eat relat databas market medina nosql success secret ask question nosql emereo pti limit googl protocol buffer https protocol buffer apach apach thrift http apach avro http intern json data interchang format http public file ecma ecma pdf rae rollin shute sodhi vingralek onlin asynchron schema chang vldb sadalag fowler nosql distil guid emerg polyglot persist pearson educ kleppmann schema evolut avro protocol buffer thrift http schema evolut avro protocol buffer project voldemort voldemort support avro schema evolut http voldemort avro schema sanfilippo final redi collect iter http news wikimedia mediawiki upgrad http wiki mediawiki upgrad bellot painless data migrat schema nosql data store redi https servicestack wiki migrationsusingschemalessnosql rethan manag schema chang mongodb http manag schema tool schema migrat nosql databas http question tool schema migrat nosql databas hayden saur smith hick foster kitsun effici general purpos dynam softwar updat acm tran program lang syst giuffrida iorgulescu tanenbaum mutabl checkpoint restart autom live updat generic server program pro ceed intern middlewar confer bordeaux franc decemb veill acm chen chen zang yew polus power live updat system proceed intern confer softwar engin ser ics washington usa ieee comput societi onlin http ics pina veiga hick rubah dsu java stock jvm proceed acm intern confer object orient program system languag applic oopsla splash portland usa octob black millstein acm googl googl app engin platform servic https appengin doc project voldemort http berkeley http technetwork databas databas technolog berkeleydb overview engin http rank key store scale redi twitter https watch aug san francisco redi meetup lehtinen jansson htp jansson saur collard foster guha vanbev hick safe flexibl control upgrad sdns proceed symposium sdn sosr mar saur dumitra hick evolv nosql databas downtim version corr onlin http oracl session session persist https webapp kemp redisf http softwar redisf szeredi fuse http katcher postmark network applianc tech rep agora game relationship friendship back redi https agoragam amico leskovec krevl snap dataset stanford larg network dataset collect https data soc html jun stonebrak aoki litwin pfeffer sah sidel staelin mariposa wide area distribut databas system vldb onlin http ronstro schema updat telecom databas icd onlin http icd løland hvasshovd onlin block relat schema chang advanc databas technolog edbt intern confer extend databas technolog munich germani march proceed ser lectur note comput scienc ioannidi scholl schmidt matth hatzopoulo kemper grust springer onlin http noach openark kit https openarkkit callaghan onlin schema chang mysql https note mysql facebook onlin schema chang mysql percona onlin schema chang http doc percona toolkit onlin schema soundcloud larg hadron migrat https soundcloud lhm serious busi freel ravi olson tablemigr https freel tabl migrat dumitra narasimhan upgrad fail depend onlin upgrad enterpris system proceed acm ifip usenix intern confer middlewar ser middlewar york usa springer verlag york corbett dean epstein fike frost furman ghemawat gubarev heiser hochschild spanner global distribut databas acm transact comput system toc dumitra narasimhan tilevich upgrad upgrad impact onlin upgrad multipl administr domain proceed acm intern confer object orient program system languag applic reno taho oct scherzing klettk sto manag schema evolut nosql data store proceed intern symposium databas program languag dbpl gundri cope chang data schema migrat haskel http cope chang data schema migrat rahm larg scale schema ontolog match schema match map bellahsen bonifati rahm heidelberg springer curino moon deutsch zaniolo autom databas schema evolut process vldb journal velegraki miller popa map adapt evolv schema proceed intern confer larg data base volum ser vldb vldb endow topaloglou semant web ontolog databas vldb workshop swdb odbi vienna austria septemb revis select paper christophid collard gutierrez berlin heidelberg springer verlag main tain semant map databas schema ontolog deshpand hick schema evolut system present high perform transact system workshop septemb 