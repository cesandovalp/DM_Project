handl skew multiway join parallel process foto afrati jeffrey ullman angelo vasilakopoulo nation technic univers athen stanford univers afrati avasilako ullman abstract handl skew major challeng queri process distribut comput environ ment mapreduc uneven distribut data server desir domin measur optim distribut environ munic cost mapreduc job amount data transfer mapper reduc paper will introduc novel techniqu han dling skew comput multiway join mapreduc round minimum communic cost techniqu adapt share algo rithm introduct system pig hive implement sql lation algebra mapreduc mechan deal join skew valu join attribut appear frequent system round algorithm round identifi heavi hitter valu join attribut occur frac tion tupl second round tupl heavi hitter join attribut handl malli key associ join attribut key heavi hitter reduc handl small fraction tupl will problem skew tupl heavi hitter key creat handl key normal heavi hitter singl job key system creat simpl techniqu exampl paper term reduc appli cation reduc function key associ list valu confus reduc task typic execut reduc function key associ valu exampl comput join number reduc suppos attribut identifi heavi hitter suppos tupl tupl suppos conveni distribut bucket reduc earlier approach partit data relat bucket bucket reduc send data relat reduc cours sens choos relat partit valu attribut hash bucket hash function tupl relat reduc correspond bucket argument tupl hash tupl reduc number tupl transfer mapper reduc approach describ appear pig hive date work look convent parallel implement join mapreduc implement optim strategi choos side partit side replic techniqu opti mal respect communic cost number input transfer mapper reduc contribut exampl better standard techniqu ampl rest paper idea exampl extend appli multiway join number heavi hitter adapt share algorithm find solut minim communic cost case heavi hitter exampl join partit tupl group partit tupl group reduc pair group group partit tupl hash function partit send tupl reduc form group tupl belong rang group send tupl reduc form group tupl belong rang group tupl reduc tupl reduc communic cost minim constraint achiev communic cost equal exam ple proof easi second order poli nomial wrto unknown posit observ improv optim communic cost grow grow linear work lot work decad handl skew process queri will limit work consid join mapreduc discuss share algorithm proven high probabl share algorithm distribut tupl even uniform databas defin precis databas resembl case random data general enhanc describ share algorithm behav skew data algorithm silient skew upper bound skew databas resili appli ordinari join attribut relat allow tupl heavi hitter distribut reduc case join exampl share algorithm algorithm base schema distribut data number reduc reduc defin vector compon vector correspond attribut algorithm number independ chosen random hash function attribut tupl num ber reduc depend spe cific attribut tupl tupl tupl reduc valu exampl suppos join exampl reduc defin vector tupl number reduc ducer tupl replic number time reduc number bucket hash valu attribut hash function hash valu attribut bucket share communic cost calcul relat size relat time replic need tupl relat replic calcul product share attribut appear relat order number reduc equal calcul share product equal exampl communic cost denot size relat explain lagrangean method find share minim communic cost multiway join observ proven attribut domin attribut join appear relat appear attribut domin share share equal set comput join exampl tupl join set key set key present exampl send tupl number reduc order comput join tupl set key send tupl num ber reduc order comput join tupl second set form exact share algorithm conveni set key correspond join call residu join differ subset data appli appli origin join data appli origin join data method present exampl base share algorithm equival thought replac tupl relat ple distinct fresh valu tupl relat valu appli share algorithm find share distribut tupl reduc problem plan output will empti chosen bis distinct problem easi solut replac conceptu level creat free join appli share algorithm comput share optim transfer tupl reduc transfer origin ples produc desir output explain conceptu structur set reduc comput residu join assum residu join reduc constraint residu join comput communic cost express object function minim sum cost express residu join constraint residu join product attribut share equal aim paper systemat appli idea explain join multiway join number structur rest paper decompos residu join partit data subset view residu join origin join appli subset explain form free residu join comput communic cost express residu join cost express residu join written simpl effect decomposit wrto definit attribut defin set lxi type valu heavi hitter lxi compris type call ordinari type valu heavi hitter lxi compris type type heavi hitter ordinari type combin type element cartesian product set lxi defin residu join queri exampl consid resid ual join type combin type combin defin residu join join comput subset data attribut ordinari type current exclud tupl exclud relat tupl attribut type exclud relat tupl exampl run exampl join suppos attribut hhs attribut attribut three type attribut type rest attribut singl type residu join combin denot size relat relev residu join number tupl relat contribut residu join list residu join attribut type number tupl relat number tupl relat number tupl relat attribut type typl attribut type typl attribut type typl attribut type type typl attribut type type typl residu join treat share algorithm separ join set key defin hash tupl tupl relat reduc combinatrion valu tupl satisfi constraint concern valu exampl continu exampl ple number reduc key creat residu join will provid detail paper tupl relat reduc type repres valu attribut heavi hitter reduc creat item exampl reduc creat item reduc creat item write cost express will explain form free residu join comput communic cost express residu join structur conceptu sake show write cost express practic materi auxiliari relat definit will short will explain exampl exampl consid residu join join exampl rewrit order will equival imagin comput join raux databas popul number tupl origi nal tupl add tupl replac place tupl relat raux cartesian product observ databas heavi hitter appli origin share algorithm introduct auxiliari attribut relat complic thing databas relat databas sume qualifi conveni identifi tupl argument tupl second argument auxiliari relat raux residu join comput heavi hitter appli origin share algorithm comput cost express ignor communic cost auxiliari relat communic cost residu join express exampl conceptu structur general case combin type comput free residu join cost express written igonor tupl auxiliari relat imagin recreat reduc attribut ordinari type introduc number auxiliari attribut auxiliari attribut relat attribut appear denot auxiliari attribut rela tion schema relat appear replac attribut form residu join orig inal join relat relat rxiaux attribut ordinari type schema relat consist attribut attribut write communic cost express share algorithm care communic cost express clude term auxiliari relat size relat cost express number tupl valu argument heavi hitter specif combin type will discuss subsect simplifi cost express inclu share variabl auxiliari attribut domin relat role sim plifi cost express properti domin relat allow write cost express residu join simpl manner theorem theorem share auxiliari attribut equal optimum solut proof auxiliari attribut appear relat origin join auxiliari relat add term cost express auxiliari relat imagin write cost express join residu join auxiliari relat auxiliari attribut appear relat domin ordinari residu join attribut except attribut relat auxiliari attribut case tupl relat residu join attribut relat share establish cost express residu join rive cost express origin join domin rule simplif make share auxiliari attribut equal tupl hash reduc valu attribut tupl exampl continu exampl rememb denot share attribut tie relat attribut appear case break tie declar auxiliari attribut domin denot size relat relev residu join number tupl relat contribut residu join start cost express origin join rcde sad tabe simplifi list cost express residu join order exampl attribut ordinari simplifli lation observ domin domin express ordinari attribut remain attribut domin express size relat will set rde sad tae rde sad tae size relat will refer afrati balazinska sarma howe salihoglu ullman design good algorithm mapreduc socc afrati sarma salihoglu ullman upper lower bound cost map reduc comput pvldb afrati ullman optim multiway join map reduc environ ieee tran knowl data eng beam koutri suciu communic step parallel queri process proceed acm sigmod sigact sigart symposium principl databas system pod york usa june beam koutri suciu skew parallel queri process proceed acm sigmod sigact sigart symposium principl databas system pod snowbird usa june gate natkovich chopra kamath narayanam olston reed srinivasan srivastava build highlevel dataflow system top mapreduc pig experi pvldb olston reed srivastava kumar tomkin pig latin foreign languag data process sigmod confer thusoo sarma jain shao chakka zhang anthoni liu murthi hive petabyt scale data warehous hadoop icd wolf dia parallel sort merg join algorithm manag data skew ieee tran parallel distrib syst 