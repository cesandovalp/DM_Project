dsl base design space explor tempor spatial parallel custom stream comput kentaro sano graduat school scienc tohoku univers aramaki aza aoba sendai japan email kentah abstract stream comput approach suitabl fpga base custom comput high throughput capabl brought pipelin regular memori access increas perform iter stream comput exploit tempor spatial parallel deepen duplic pipelin perform constrain factor includ hardwar sourc fpga extern memori bandwidth util pipelin stage find best mix parallel achiev highest perform power paper domain specif languag dsl base design space explor tempor spatial parallel stream comput fpga defin dsl easili design hierarch structur parallel stream comput abstract descript comput iter stream comput fluid dynam simul design hardwar structur mix tempor spatial parallel measur perform power consumpt find best introduct fpga base custom comput attract ing lot applic develop big data supercomput field perform power consumpt difficult increas clock frequenc general purpos microprocessor core acceler gpus consid promis solut higher comput perform achiev perform limit power budget entir system power effici consid key larg scale comput hand custom comput fpgas expect provid compar perform lower power consumpt custom circuit effect achiev high perform exploit spatial tempor parallel comput problem low clock frequenc advanc fpgas fabric cut edg semiconductor technolog bring high potenti effici high perform comput chip integr hard macro block ram high speed block dsp block emerg state art fpga devic capabl high perform numer comput low power hard float point dsp block stream comput promis approach effici comput custom hardwar deep pipelin increas number oper perform memori access regular access stream data fulli util precious bandwidth extern memori addit dedic hardwar design bring effi cient util resourc fpgas adapt mix oper function includ adder multipli divid squar root function research report success high perform stream comput fpgas product remain big issu design custom hardwar explor design space best perform power case stream comput exploit type parallel spatial tempor duplic pipelin exploit spatial parallel increas oper perform cycl higher perfor manc hardwar resourc consum increas bandwidth requir extern memori scalabl limit bandwidth hand deepen pipelin exploit tempor parallel increas oper memori access higher perform memori bandwidth long pipelin suffer low util prologu epilogu effect pipelin best mix parallel depend constraint find optim individu applic paper domain specif languag dsl base approach easili explor design space spatial tempor parallel stream comput fpga dsl call stream process descript spd allow intuit describ formula submodul call comput structur custom hardwar softwar abstract level design explor design parallel configur spd compil spd compil find best evalu perform power consumpt work implement fpga languag propos stream process ing includ streamit parallel studi present stream comput compil target fpgas commerci commerci dsl design compact intuit descript hierarch modular connect hardwar modul explicit parallel studi appli design space explor high perform custom comput scientif numer simul contribut work dsl call spd custom stream comput framework dsl base design space explor case studi fpga base fluid dynam simul spd compil work extend version previous publish extens copyright held author owner internationalworkshop fpgas softwar programm fsp london unit kingdom septemb input stream output stream stream comput function ztj buffer pipelin singl pipelin buffer pipe pipe pipelin cascad pes fig definit stream comput fig process element spatial parallel tempor parallel essenti hierarch modular descript capabl paper organ describ parallel iter stream comput spd sign stream comput hardwar iii design applic exampl evalu final conclus futur work dsl base design space explor stream comput defin stream comput target domain specif languag dsl stream comput input data stream output data stream element xit xit zjt zjt input output stream scalar element incom outcom order time fig model stream comput function output stream zjt xit output stream time comput function input element offset exampl stencil comput singl variabl star stencil grid stream spatial tempor parallel focus iter stream comput time march simul repeat perform stream comput time integr iter stream comput exploit spatial tempor parallel process element pes multipl pipelin assum updat entir data singl time step stream fig process element stream comput intern buffer offset refer stream data case singl singl pipelin coars grain parallel exploit fine grain parallel oper pipelin duplic pipelin insid fig exploit spatial parallel data parallel speed comput singl time step share buffer pipelin restrict increas buffer size fuse independ buffer singl buffer multipl input output intern memori share depend comput data stream element util spatial parallel increas perform size buffer approach requir memori bandwidth time wider data stream contrari bandwidth requir ment increas perform tempor parallel fig cascad pes longer pipelin speed comput time step cascad pes requir wider bandwidth stream data extern memori memori access top bottom pipelin stream data element pipelin stage take cycl cascad pes cycl singl take cycl comput time step time faster comput achiev cascad pes approach inher drawback total buffer size increas cascad connect independ pes consum time memori intern buffer chip memori resourc limit number pes cascad buffer larg second util pes lower prologu epilogu effect pipelin pipelin perform gain parallel process pipelin stage pes idl pes receiv data element comput pipelin pes finish comput element total effect perform degrad short stream long pipelin appli tempor spatial parallel cascad pes intern pipelin design space combin chip hardwar resourc constrain combin formanc depend factor includ extern memori bandwidth depth pipelin size stream data comput applic fpga board find best perform power consumpt combin stream process descript spd easi task explor design space design implement hardwar structur rtl improv product design space explor propos domain specif languag dsl abstract descript stream comput hardwar dsl stream process descript spd design spd major requir easili intuit describ comput formula softwar code second describ hardwar structur simpl node node node node node node node stream core node core node core node core node b_a b_b dfg stream comput node pipelin connect delay stream comput core construct complet pipelin higher level structur core complex comput fig hierarch pipelin construct stream comput data flow graph dfg core core main_in main_i main stream main_out main_o main stream brch_in brch_i branch input brch_out brch_o branch output param defin paramet equ equ equ equ drct port connect fig stream process descript spd code dfg fig spd format allow intuit describ comput formula pipelin pes connect pes rest exampl stream comput input vector ini output vector vouti temporari variabl constant addit input output stream respec tive stream comput hardwar implement static map data flow graph dfg comput comput descript fig dfg comput correspond node node repres formula direct edg depend formula output node comput formula implement pipelin data path fig pipelin dfg node replac pipelin data path node formula number pipelin stage equal path length insert addit delay fig exampl descript spd dfg fig describ comput line note string treat comment describ common style function field function summar array main_in main_i main_out main_o hdl node_a b_a core b_b hdl node_b b_b core b_a hdl node_c core equ node_d fig stream process descript spd code structur fig tabl function classifi core interfac node connect exampl code fig line name core core main stream input interfac main_i port name main stream output interfac main_o port line branch input brch_i port output brch_o port remain line written node connect param defin paramet cnst constant formula paramet formula static replac valu preprocessor line creat node static singl assign output port variabl calcul formula refer type node equat node simpli equ node function equ uniqu node form port variabl formula formula parenthes oper squar root function sqrt spd variabl bit equ node variabl treat singl precis float point number numer comput output variabl node refer formula node node connect direct edg dfg addit explicit connect port variabl name drct function connect output input branch output interfac hardwar structur descript dfg map hardwar pipelin node consid singl pipelin fig node dfg construct higher level structur connect exist modul core exampl fig core fig three node connect tabl format stream process descript spd categori function field descript core interfac core set core main_in append input port main stream interfac main_out append output port main stream interfac brch_in append input port branch interfac brch_out append output port branch interfac node connect equ node equat append equat node hdl node delay modul call param list append hdl node drct destin port list sourc port list connect port node direct param paramet constant defin paramet constant tabl format spd subfield subfield format equat output port calcul formula input port name exampl sqrt modul call main output port branch output port modul main input port branch input port exampl mymodul node hierarch build hardwar structur low level design data path core high level design core connect approach high product implement configur parallel stream comput pes function hdl creat node exist modul refer type node hdl node pipelin delay hdl node static advanc compil hdl hdl node pipelin delay modul call descript paramet list direct pass paramet verilog hdl modul paramet list tabl modul call style subroutin call softwar multipl output variabl fig exampl multipl output variabl written parenthes hdl node variabl basic treat raw binari data bit actual data type process depend hdl node librari modul hdl node hdl node call modul describ spd code exist mod ule written hdl equ node allow develop easili describ numer comput hdl node extend function spd arbitrari oper control comput provid elementari hdl modul librari stream process write verilog hdl librari version synchron multiplex compar elimin delay stream forward stream backward stencil buffer modul iii design evalu overview benchmark applic dsl base design space explor chose fluid dynam simul base lattic boltzmann method lbm describ stream comput lbm spd hierarch hardwar structur modul comput stage consist modul cascad connect compil spd code stream comput compil extend version hdl code custom comput core base system integr tool altera qsys order build system chip soc common platform consist pci express memori control scatter gather dmas interconnect fpga easili emb core generat spd compil system process complet autom develop linux driver librari softwar data transfer host program fpga board control stream comput fpga compil system embed core altera quartus compil generat bitstream altera stratix fpga verifi fpga base fluid dynam comput teras net board compar comput softwar base comput design lbm core oper mhz bit width memori control oper mhz evalu area activ power fpga board pipelin util sustain perform power design space explor fluid dynam simul base lbm fluid dynam simul base lbm comput propag collis fictiv particl discret lattic mesh viscous fluid flow detail comput comput algorithm lbm three stage collis calcul translat boundari comput wrote spd code separ modul stage note three spd code translat stage parallel pipelin wrote spd code pes pipelin fig spd code pes pipelin fig compil dfgs round rectangl hdl node includ collis calcul node ulbm_calc translat node boundari comput node ulbm_bndri synthes pes pipelin stage final wrote spd code cascad pes fig spd code cascad pes pipelin fig dfgs pes pipelin final implement design main_in sop eop one_tau rho_in rho_out main_out sop eop calcul stage parallel hdl calc one_tau translat stage parallel buffer hdl sop eop sop eop boundari stage parallel hdl boundari rho_in rho_out drct drct fig spd code stream comput lbm pipelin main_in iatr sop eop one_tau rho_in rho_out hdl ulbm_calc oatr sop eop main_out hdl hdl ulbm_bndri fig stream comput lbm pipelin resourc perform tabl iii summar resourc consumpt plement design soc peripher includ pci express memori control consum alm adapt logic modul chip mem ori dsp block remain resourc implement pipelin pes note cascad pes pipelin consum time chip memori pipelin pipelin share buffer larger buffer pipelin case dimension lbm comput size buffer small neglig pipelin total float point oper singl precis tabl nflop denot number oper pipelin cascad pes pipelin perform nmnflop oper cycl pipelin fill peak perform calcul nmnflopsfghz gflop fghz oper frequenc ghz design fghz nflop theoret peak perform gflop evalu util pipelin hardwar counter insert top lbm pute core count number cycl bring valid data comput number stall cycl comput perform calcul util main_in sop eop one_tau rho_in rho_out main_out sop eop calcul stage parallel hdl calc one_tau hdl calc one_tau translat stage parallel buffer hdl sop eop sop eop boundari stage parallel hdl boundari rho_in rho_out hdl boundari rho_in rho_out drct drct drct fig spd code stream comput lbm pipelin main_in sop eop one_tau rho_in rho_out hdl hdl sop eop main_out hdl hdl hdl fig stream comput lbm pipelin tabl iii util pes pipelin pes pipelin util memori fpga board read write support bandwidth requir pipelin multipli util peak perform sustain perform tabl iii design space explor configur best sustain perform gflop close peak note negat util pipelin neglig larg comput grid exampl grid cell evalu perform power measur power consumpt fpga board measur power suppli pci express edg connector hioki power meter highest perform power configur gflop conclus paper present dsl base design space explor find best mix spatial tempor parallel tabl iii resourc consumpt oper frequenc pipelin util perform power devic modul alm reg bram bit dsps freq util perform power perf stratix mhz gflop gflop soc peripher pipelin pes main_in sop eop main_out sop eop append_reg one_tau rho_in rho_out definit constant input hdl sop eop one_tau rho_in rho_out drct drct sop eop fig spd code singl pipelin tabl number float point oper core adder multipli divid total pipelin fpga base iter stream comput allow intuit describ formula submodul call comput structur custom hardwar softwar abstract level propos domain specif languag call spd spd compil complet autom explor allow softwar develop design implement custom hardwar parallel configur easili convent rtl languag evalu configur stream comput core fluid dynam simul base lbm best perform power design depend tempor parallel memori bandwidth requir fpga board futur work will autom process design space explor softwar code target applic acknowledg support grant aid challeng ing exploratori ministri educ cultur sport scienc technolog japan refer altera corp web http david chen georgiadi buckius consist hydrodynam boundari condit lattic boltzmann method physic fluid januari gordon thi amarasingh exploit coars grain task data pipelin parallel stream program pro ceed intern confer architectur support program languag oper system octob hagiescu wong bacon rabbah comput ing origami fold stream fpgas proceed design autom confer juli main_in sop eop main_out sop eop append_reg one_tau rho_in rho_out definit constant input hdl sop eop one_tau rho_in rho_out hdl one_tau rho_in rho_out drct drct sop eop fig spd code cascad pes pipelin main_in iatr sop eop hdl oatr sop eop main_out main_reg one_tau rho_in rho_out main_in iatr sop eop hdl oatr sop eop main_out main_reg one_tau rho_in rho_out hdl fig singl cascad pes pipelin hormati kudlur mahlk bacon rabbah optimus effici realiz stream applic fpgas proceed intern confer compil architectur syn thesi embed system octob kono sano yamamoto scalabl analysi tight coupl fpga cluster lattic boltzmann comput proceed intern confer field programm logic applic august paper langhamm pasca float point dsp block architectur fpgas proceed acm sigda intern symposium field programm gate array februari pell mencer tsoi luk high perform comput fpgas springer york juli august maximum perform comput dataflow engin sano hatsuda yamamoto multi fpga acceler scalabl stencil comput constant memori bandwidth ieee transact parallel distribut system march sano suzuki ito ueno yamamoto stream processor generat hpc embed applic fpga base system platform proceed intern workshop fpgas softwar programm septemb thi karczmarek amarasingh streamit languag stream applic proceed intern confer compil construct april 