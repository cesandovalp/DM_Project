perform evalu spars matrix multipl kernel intel xeon phi erik saul kamer kaya mit atalyu rek ohio state univers depart biomed informat ohio state univers depart electr comput engin email esaul kamer umit februari abstract intel xeon phi releas high perform coprocessor featur core port hardwar thread bit wide simd regist achiev peak theoret perform doubl precis scientif applic involv oper larg spars matric linear solver eigensolv graph mine algorithm core applic involv multipl larg spars matrix dens vector spmv paper investig perform xeon phi coprocessor spmv provid comprehens introduct architectur analyz peak perform number micro bench mark design xeon phi core core modern processor larg number core hyperthread capabl allow applic satur memori bandwidth case cut edg processor formanc studi memori latenc bandwidth creat bottleneck spmv architectur final experi xeon spars kernel perform promis better cut edg general purpos processor gpus introduct larg spars matrix input vector cut edg share memori multi core architectur intel xeon phi interest analyz perform comput parallel comput spars matrix vector multipl spmv variant spars matrix matrix multipl spmm form comput core applic involv linear system eigenvalu linear program larg scale scientif appli cation reason extrem intrigu context high perform comput ing hpc effici share memori parallel kernel well studi area exist techniqu prefetch loop transform vector regist cach tlb block numa optim extens investig optim perfor manc addit compani built support parallel share memori architectur mkl cuspars popular parti spars matrix librari oski poski exist intel xeon phi coprocessor core hardwar thread capabl wide vector regist novel architectur interest hpc communiti texa advanc comput center built stamped cluster equip xeon phi comput center fol low effort push fast mpi implement intel xeon phi releas perform evalu exist literatur eisen lohr investig behavior dens linear algebra factor xeon phi stock propos automat code optim approach tensor contract kernel work work dens regular data previous work author evalu scalabl graph gorithm color breadth search bfs work absolut perform valu best knowledg exist work literatur bfs spmv spmm kernel term synchron memori access load balanc will coprocessor promis perform better exist cut edg cpus acceler handl spars linear algebra acceler coprocessor design specif task achiev good perform reduc energi usag comput gpus success criteria report perform well regular comput irregular sparsiti spmv kernel creat problem architectur paper analyz xeon phi perform popular spars linear algebra kernel spmv spmm studi perform conjug gradient applic spmv studi concern singl matrix applic orient best knowledg analysi perform coprocessor kernel conduct experi matric ufl spars matrix archi tectur baselin measur perform dual intel xeon processor westmer sandi bridg nvidia tesla gpus matric xeon spars matrix perform promis better general purpos cpus gpus experi larg regist extens vector instruct port boost perform candid scientif comput throughput orient server side code spmv spmm base servic product friend recommend core hyperthread capabl help intel xeon phi satur memori bandwidth spmv case cut edg processor analysi memori latenc memori bandwidth bottleneck reason reach peak perform expect observ perform spmv kernel high depend nonzero pattern matrix sparsiti nonzero row align pack cachelin memori perform better investig approach densifi comput order matrix well revers cuthil mckee order rcm chang natur comput regist block paper organ present architectur overview intel xeon phi coprocessor detail read write memori bandwidth micro benchmark describ spars matrix multipl kernel section analyz xeon perform kernel perform comparison cut edg architectur conclud paper intel xeon phi coprocessor work pre releas knc card card memori control execut billion transact second bit channel architectur achiev total bandwidth aggreg memori control core clock core memori interfac bit wide channel total bandwidth core core consum band width core memori control limit ring network connect theoret support core architectur data cach instruct cach cach architectur core base pentium architectur design updat spars matric bit core hold hardwar context time clock cycl instruct singl thread execut hardwar constraint overlap latenc core execut instruct hardwar context consecut program thread half clock cycl wast hardwar context instruct singl thread execut order pentium architectur core concur rent instruct pipelin call pipe pipe allow execut instruct cycl instruct pipelin vector float point instruct execut cycl alu instruct execut cycl perform architectur vector process unit intel xeon core bit simd regist doubl singl precis vector bit valu vector bit valu vector process unit perform basic instruct addit divis mathemat oper sine sqrt allow reach doubl precis oper cycl singl precis unit port fuse multipli add fma oper typic count oper benchmark purpos peak perform card tflop doubl precis tflop singl precis half fma read bandwidth benchmark estim maximum achiev read bandwidth xeon phi benchmark perform simpl oper number core thread core idea perform bottleneck choos array sum kernel comput sum larg array measur amount effect applic bandwidth reach comput sum core alloc data thread read data minim cach reusag thread start array experi present figur aggreg bandwidth report char int data type sum array set bit integ char data type benchmark compil optim flag prevent compil optim undesir effect figur bandwidth peak thread core core bandwidth scale linear number core indic benchmark satur memori bus addit thread core bring perform improv indic full usag comput resourc core plot peak effect bandwidth expect achiev instruct util pipelin denot full pair figur denot pair code compil execut instruct loop figur best achiev perform align well pair indic instruct pair benchmark instruct bound second benchmark perform summat array bit int employ optim flag present figur code instruct loop process time data instruct perform rough scale time perform scale linear number core indic perform bound speed memori interconnect peak bandwidth achiev thread core small differ bandwidth achiev thread impli benchmark instruct bound notic thread achiev peak bandwidth thread hide memori latenc third benchmark consid array set bit integ vector oper load sum time process bit full cachelin present figur bandwidth peak core thread core bench mark memori intens previous thread core hide memori tenci clear figur bandwidth scale linear increa ing number core indic bandwidth closer speed actual memori bus fourth benchmark improv previous remov necess hide mem ori latenc memori prefetch present figur bandwidth peak wid number core thr thr thr thr instr loop instr loop full pair simpl sum char wid number core thr thr thr thr instr loop instr loop full pair simpl sum int wid number core thr thr thr thr core vector wid number core thr thr thr thr corecor ring vector prefetch figur read bandwidth intel xeon phi micro benchmark array sum oper upper bound bandwidth comput core speed instruct requir int instruct includ addit cast requir char theoret upper bound maximum bandwidth max core maximum core ring bandwidth core thread core repres core bandwidth singl thread core wors scale linear number core thread perform longer scale linear core plateau core singl core sustain read bandwidth access memori write bandwidth benchmark read bandwidth investig write bandwidth behav set micro benchmark thread alloc local buffer fill predetermin present figur previous micro benchmark read bandwidth clear vector loop will perform well will instruct bound consid vector case benchmark fill memori craft buffer bit simd regist write full cach simpl store instruct figur core bandwidth achiev thread core configur second benchmark write memori read hint bypass read ownership protocol forc read cachelin overwrit content note protocol case partial cachelin updat benchmark present figur achiev bandwidth scale linear wid number core thr thr thr thr core store wid number core thr thr thr thr core vector read hint wid number core thr thr thr thr corecor ring vector read hint global order figur write bandwidth intel xeon phi three micro benchmark approach memset buffer theoret upper bound maximum bandwidth maximum core ring bandwidth core thread core improv linear number thread indic core stall write oper third benchmark instruct perform memori write regular write oper enforc write commit memori order instruct emit properti crucial ensur coher share memori parallel algorithm instruct benchmark allow write global order read hint benchmark present figur instruct bandwidth previous experi achiev core bandwidth peak core repres core note achiev singl thread core instruct allow stall thread intern buffer architectur full singl thread manag fill singl core sustain write bandwidth access memori spars multipl kernel well spars matrix kernel form spars matrix column vector spmv kernel nonzero access multipli vector entri result vector entri read read write nonzero access spars multipl kernel spars matrix dens matrix multipl spmm dens matric spmm read read write nonzero access read write access pattern kernel figur obtain good perform spmv difficult architectur difficulti aris sparsiti pattern yield regular access memori amount comput nonzero small oper suffer bandwidth limit spars matrix nonzero store compress row column storag format crs ccs format dual paper will crs will describ crs three array cid integ array size store column nonzero row major order rptrs integ array size rptrs locat nonzero ith row cid array element rptrs element rptrs column indic row store cid rptrs cid rptrs val array size val correspond nonzero cid exist spars matrix represent best storag format depend pattern matrix kernel work crs constitut solid baselin spmv spmm figur memori access pattern spmv spmm color blue read red write repres crs straightforward task assign row singl thread parallel execut figur entri output vector comput independ stream matrix row row process row multipl valu read sum multipl written multipli add oper nonzero total number float point oper spmv intel xeon phi experi set matric total properti tabl matric ufl spars matrix collect except mesh correspond point stencil mesh size store matric memori crs represent scalar valu store doubl precis bit float point indic store bit integ experi figur matric number increas number nonzero entri list tabl experi oper time comput averag oper figur tabl cach flush measur perform evalu spmv kernel implement openmp process row parallel test dataset multipl schedul polici figur present highest perform compil case best perform core thread core core thread core dynam schedul polici chunk size typic best compil perform vari notic differ enc perform correl size matrix compil perform rise matric reach total matric set achiev perform interest observ differ perform constant depend trix analyz assembl code generat compil spmv inner loop comput dot product spars row matrix dens input vector insight perform differ dot product implement simpl column nonzero regist nonzero nonzero tabl properti matric experi matric squar max max row nonzero densiti nnz row nnz nnz shallow sphere scircuit mac econ cant webbas hood pwtk crankseg atmosmodd msdoor inlin mesh ldoor multipli input vector element brought regist memori indirect result accumul nonzero increment test loop purpos dot product comput element time memori indirect increment addit multipl test jump nonzero code generat complex basic vectori oper oper compil code load consecut valu spars row bit simd regist doubl precis float point number singl oper popul simd regist valu input vector popul vector multipli accumu late previous singl fuse multipli add oper popul simd regist appropri valu trivial valu consecut memori simpl ineffici method fetch xeon phi offer instruct vgatherd allow fetch multipl valu instruct take offset array simd regi ter pointer array destin regist bit mask indic element offset array load general case instruct load element simultan fetch element cachelin instruct call time number cachelin offset regist touch fma vector load nonzero matrix column posit increment test vgatherd perform nonzero matrix figur spmv perform matrix flag function cachelin densiti ucld metric devis analysi row comput ratio number nonzero row number element cachelin input vector row averag valu comput ucld instanc row three nonzero ucld singl row three nonzero spread cachelin input vector store store worst ucld element access cachelin best nonzero pack well align region column rfo lop vect figur compar vect comp vect spmv xeon phi matrix data set point figur perform mark perform mark point horizont align matrix vertic distanc repres correspond improv perform matrix perform improv vector vgatherd higher ucld high maximum perform achiev vectori instruct fair correl ucld correl explain bound comput common sourc perform bound memori bandwidth float point instruct throughput intel xeon phi peak float point perform architectur doubl precis clear bottleneck experi bandwidth consider nonzero matrix transfer core process assum access vector incur memori transfer nonzero take byte column incur float point oper multipl sum flop byte ratio spmv micro benchmark sustain memori bandwidth indic maximum perform spmv kernel assum byte nonzero transfer core naiv bandwidth spmv vector row indic transfer matrix nonzero actual minimum amount memori transfer way densiti matrix high will domin equat sparser matric ignor applic bandwidth term account common altern cross architectur measur perform spmv figur bandwidth achiev experi naiv actual applica tion bandwidth clear naiv approach ignor portion data matric rfo lop cach densiti vect figur improv comp vect link cachelin densiti applic bandwidth rang matric applic bandwidth applic bandwidth comput assum singl byte problem transfer exact assumpt true matrix output vector hold input vector reason element input vector will thread singl core element will transfer multipl core cach xeon phi core input vector fit cach matric matrix element transfer multipl time core analyt comput number cachelin access core assum chunk row distribut round robin fashion reason approxim dynam schedul polici perform analysi infinit cach cach comput effect memori bandwidth spmv assumpt display top stack bar figur three observ strike differ applic bandwidth estim actual bandwidth greater instanc three highest differ sphere amount data transfer time larger applic bandwidth second differ assum infinit cach cach bandwidth visibl differ instanc cach thrash occur final actual memori transfer account bandwidth architectur peak bandwidth understand bottleneck applic better applic bandwidth instanc number core thread core figur select instanc repres matric instanc profil present figur differ perform achiev thread matric crankseg pdbhys webbas profil figur bare differ wid naiveappl hardwar cachehardwar cach figur bandwidth achiev spmv assumpt perform achiev thread matric differ thread core perform indic satur instruct pipelin memori subsystem band width instanc bound latenc memori access mention spmv perform equal well instanc thread core instanc bound core bottleneck core peak memori bandwidth instruct pipelin full three instanc crankseg pdbhys achiev applic bandwidth memori bandwidth bound webbas reach bandwidth lesser figur perform core thread core lower thread system hinder system oper strang visibl bandwidth experi conduct summari summar learn spmv intel xeon phi maxim vgatherd instruct key optim perform matric nonzero row cach column block doubl precis will higher perform coalesc memori access crucial good perform gpus differ applic bandwidth actual bandwidth high part input vector access core today cut edg processor core share cach intel xeon phi coprocessor physic cach improp structur spars matrix requir input vector transfer time issu problem input vector distribut distribut memori spmv despit cach core small standard observ cach thrash experi instanc spmv kernel configur relat perform instanc improv tabl perform regist block base implement relat regist block second row present geometr relat perform instanc ratio gflop regist block origin implement appear memori latenc bound memori bandwidth bound matrix order approach improv perform spmv oper order row column input matrix suitabl kernel permut set row column techniqu spars linear algebra multipl purpos improv numer stabil precondit matrix reduc number iter improv perform employ matlab implemen tation revers cuthil mckee algorithm rcm rcm minim maximum distanc nonzero diagon matrix bandwidth matrix bfs vertex row order correspond graph matrix group nonzero region diagon leav area diagon complet empti expect densif nonzero improv ucld matrix reduc number time vector need transfer main memori core cach present figur improv perform cachelin densiti vector access posit improv negat degrad metric vector access repres expect number time input vector transfer memori perform improv figur matrix obtain absolut improv matric observ improv higher matric improv perform observ matric observ degrad matric shallow mac econ increas observ number time input vector transfer rcm matric friend architectur vector access crucial correl metric perform spmv xeon phi regist block limit origin spmv implement singl nonzero process time idea regist block process nonzero region region small data associ store regist minim memori access implement regist block regular partit block size nonzero region correspond block repres dens explicit includ zero matrix reduc list empti block repres list crs xeon phi architectur natur align bit chose block dimens doubl take bit dimens vari dens block repres row major order column major order depend dimens size experi differ scheme perform multipl block load stream regist pack val zero nonzero allow multipl perform fuse multipli add oper regist block help reduc number oper need process nonzero insid block fur thermor reduc size matrix matrix nonzero dens region byte memori crs byte byte offset regist block region repres byte singl offset requir regist block summar tabl omit matrix transforma tion time time matrix multipl observ improv partit block best scheme improv perform instanc compar origin implement regist block improv perform averag block size help larg block kernel memori bound effect hardwar memori bandwidth reach matric thread core averag relat formanc wors matric low local configur store valu nonzero matric transfer memori memori wast experi regist block save memori valu block nonzero matric respect condit block block smaller densiti increas explain increas relat perform matric densiti size densiti experi regist block dens block storag promis spmv intel xeon phi variant logic straightforward solut store block spars storag scheme generat dens represent fli bitmap suffici repres nonzero pattern block represent improv memori usag increas relat perform suffici surpass origin implement reason matric spars form regist block will provid improv regist block chang access pattern input vector access induc latenc kernel spmm intel xeon phi flop byte ratio spmv limit achiev perform simpl idea achiev perform xeon phi coprocessor increas flop byte ratio perform spmv time multipli multipl vector will allow reach higher perform applic advantag multipl vector multipl time applic graph base recommend system eigensolv lobpcg algorithm multipli vector matrix boil multipli spars matrix dens matrix refer spmm statement valid exist cut edg processor acceler larg simd regist xeon phi expect perform better spmm implement oper dens input matrix encod row major row contigu memori process row spars matrix temporari array size initi nonzero row stream multi pli nonzero result accumul temporari array develop three variant algorithm xeon phi variant generic code reli compil vector second tune valu multipl code manual vector load row vector block doubl simd regist perform multipl accumul fuse multipli add temporari valu regist advantag larg number simd regist xeon phi third variant global order write instruct read hint nrngo prove fastest bandwidth experi experi figur instanc manual vec toriz doubl perform allow reach instanc nrngo write instruct perform improv achiev perform peak matrix pwtk matrix figur bandwidth achiev best implement applic bandwidth surpass instanc size data comput input vector overhead induc transfer valu multipl core higher amount data transfer account comput applic bandwidth impact finit cach small spmv cach size problem xeon phi cach problem applic architectur compar spars matrix multipl perform xeon phi architectur includ gpu configur cpu configur cuda enabl card nvidia nvidia tesla equip cuda core clock memori clock ecc machin cuda driver cuda runtim tesla cuda core clock memori clock ecc machin cuda driver cuda runtim gpu configur cuspars librari implement intel cpu system dual intel xeon configur call westmer processor equip core clock hyperthread disabl processor equip share cach core local cach second configur dual intel xeon denot sandi processor equip core clock hyperthread enabl processor equip share cach core local cach code cpu architectur compil icc optim flag kernel implement openmp perform stabil run perform thread pin kmp affin implement xeon phi vector optim spmm instruct set differ experi present figur gpu cpu architec ture expect better stack bar chart top sandi top westmer figur spmv sandi appear rough faster westmer reach perform achiev highest perform instanc gpu architectur card typic faster card perform better instanc obtain highest perform instanc xeon phi reach highest perform instanc architectur instanc figur spmm sandi perform westmer relat spmv perform gpu faster better compar relat perform spmv xeon phi coprocessor best perform instanc number cpu gpu configur intel xeon phi architectur achiev reach instanc cpu configur reach instanc gpu configur achiev perform conclus futur work work analyz perform intel xeon phi coprocessor spmv spmm spars algebra kernel applic best knowledg analysi absolut perform intel xeon phi spars matrix kernel investig latenc bound experi suggest small cach core problem intel xeon phi hav ing core bring increas decreas exist optim approach literatur desir properti larg number core negat impact perform input data larg requir transfer multipl cach creas matrix storag scheme intra core local data partit core futur work plan investig techniqu detail improv perform xeon phi perform coprocessor promis compar cut edg proce sor acceler spmv spmm perform superior wide regist vector capabl xeon phi will gain interest hpc communiti futur acknowledg work partial support nsf grant cns oci oci nvidia card intel xeon phi prototyp ohio supercomput center access intel hardwar timothi princ intel suggest valuabl discuss refer bell garland implement spars matrix vector multipl throughput orient processor proc high perform comput network storag analysi buluc fineman frigo gilbert leiserson parallel spars matrix vector matrix transpos vector multipl compress spars block proc spaa buluc william olik demmel reduc bandwidth multithread algorithm spars matrix vector multipl proc ipdp cramer schmidl klemm mey openmp program intel xeon phi coprocessor earli perform comparison proceed core applic communiti marc symposium rwth aachen univers nov cuthil mckee reduc bandwidth spars symmetr matric proc acm nation confer eisenlor hudak tomko princ dens linear algebra factor openmp cilk intel mic develop experi perform analysi tacc intel high parallel comput symp yelick optim spars matrix comput regist reus sparsiti proc icc jain poski extens autotun framework perform optim spmvs multicor architectur thesi berkeley krotkiewski dabrowski parallel symmetr spars matrix vector product scalar multi core cpus parallel comput apr ktunc kaya saul atalyu rek fast recommend bibliograph network proc asonam aug mellor crummey garvin optim spars matrix vector product comput unrol jam int high perform comput appl nishtala vuduc demmel yelick cach block spars matrix vector multipli work appl algebra eng commun comput potluri tomko bureddi panda intra mic mpi communic earli experi tacc intel high parallel comput symp saad sparskit basic tool kit spars matrix comput version saul atalyu rek earli evalu scalabl graph algorithm intel mic architectur ipdp workshop mtaap stock pouchet sadayappan automat transform effect parallel execut intel integr core tacc intel high parallel comput symp vuduc demmel yelic oski librari automat tune spars matrix kernel proc scidac physic confer seri william olik vuduc shalf yelick demmel optim spars matrix vector multipl emerg multicor platform proc zhou saul aktulga yang mari vari atalyu rek core eigensolv ssd equip cluster proc ieee cluster sep wid number core thr thr core thr thr core max sustain write bwmax sustain read wid number core thr thr core thr thr core max sustain write bwmax sustain read crankseg figur strong scale applic bandwidth instanc schedul dynam rfo perform ucld vector access figur differ perform metric rcm order posit impli improv rfo lop comp vectmanu vect manual vect nrngo comparison three spmm variant wid applicationhardwar cach hardwar cach bandwidth manual vect nrngo figur perform spmm nrngo variant read hint global order rfo lop spmv rfo lop spmm figur architectur comparison intel xeon phi coprocessor pre releas nvidia gpus dual cpu architectur intel xeon intel xeon 