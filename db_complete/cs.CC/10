complex phylogeni constraint satisfact manuel bodirski institut algebra dresden germani peter jonsson depart comput system scienc linko ping universitet linko ping sweden trung van pham institut algebra dresden germani pham june abstract systemat studi comput complex broad class comput problem phylogenet reconstruct class exampl root tripl consist problem forbidden subtre problem quartet consist problem problem studi bioinformat literatur studi problem describ constraint satisfact problem constraint order definit root tripl relat phylogeni problem solv polynomi time complet algorithm side general well polynomi time algorithm aho sagiv szymanski ullman root tripl consist problem algorithm repeat solv linear equat system construct solut polynomi time phylogeni problem solv algorithm complet classif establish dichotomi larg class infinit structur independ interest univers algebra model theori topolog proof main result combin techniqu area classif model complet core reduct homogen binari branch relat ramsey theorem root tree univers algebra content introduct phylogeni problem root tree phylogeni problem phylogeni problem csps univers algebra approach primit posit defin polymorph model complet core border tractabl hard ramsey theori tree toolbox preclassif equal constraint satisfact problem forbidden tripl relat binari inject polymorph violat forbidden tripl relat domin affin split separ freeness affin horn relat affin horn formula inject case general case test satisfi affin horn formula affin tree oper exist affin tree oper oper affin horn formula symmetri modulo endomorph main primit posit interpret clone homomorph taylor oper modulo endomorph algebra topolog dichotomi complex dichotomi introduct phylogenet consist problem comput problem studi phylo genet reconstruct comput biolog area deal larg amount inconsist data tree comput genealog comput lin guistic collect partial tree consist sens exist singl tree compat partial concret exampl comput problem context root tripl consist problem instanc problem set variabl set tripl written form exist root tree leav tripl youngest common ancestor tree youngest common ancestor aho sagiv szymanski ullmann present polynomi time algorithm problem comput problem defin root tripl consist problem studi literatur exampl includ subtre avoid problem steel wormald forbidden tripl problem bryant hard problem bodirski mueller determin complex root phylogeni problem special case disjunct constraint relat result cover instanc subtre avoid problem forbidden tripl problem consider strengthen result classifi complex phylogeni problem set phylogeni constraint defin mention root tripl relat equal problem problem polynomi time solvabl complet will demonstr class problem express unroot phylogeni problem famous exampl unroot phylogeni problem complet quartet consist problem set variabl set quartet exist tree leav quartet shortest path intersect shortest path phylogeni problem studi literatur fall framework paper tree discoveri problem input consist set tupl variabl task find root tree tripl input youngest common ancestor proper descend lowest common ancestor proof complex classif base varieti method step altern descript phylogeni problem constraint satisfact problem csps countabl infinit domain constraint relat order defin isomorph uniqu homogen binari branch relat well structur model theori central result simplifi work consider analysi endomorph monoid relat inform result impli precis type phylogeni problem trivial solut constant solut root unroot degener case call equal csps will unroot phylogeni problem hard complex equal csps basic method proceed algebra approach constraint satisfact prob lem studi set oper polymorph analys constraint tool work polymorph infinit domain ramsey theori paper ramsey result root tree leeb prove polymorph behav canon larg part domain sens bodirski pinsker allow perform simplifi combinatori analysi interest phylogeni problem solv polynomi time fall class solv algorithm algorithm consider extens algorithm bodirski mueller root tripl consist problem solv repeat system linear boolean equat decid satisfi phylogeni problem class illustr exampl phylogeni problem solv polynomi time algorithm algorithm comput problem input uniform hypergraph vertex set question exist root tree leaf set hyperedg input disjoint subtre precis vertic hyperedg phylogeni problem solv algorithm complet stronger complex dichotomi fact prove univers algebra dichotomi statement larg class infinit structur theorem independ interest studi homogen structur polymorph clone respect situat previous classif csps constraint order defin order ration random graph time classif direct state term continu clone homomorph comparison previous work dichotomi easier state tractabl class harder prove exist method dichotomi prevent test case wider classif csps homogen structur paper structur provid basic definit concern phylogeni prob lem explain problem view constraint satisfact problem reduct homogen binari branch relat contain introduct univers algebra approach complex constraint satisfact collect will proof appli univers algebra approach phylogeni problem deriv structur properti phi logeni problem simul hard phylogeni problem translat structur properti defin properti term syntact restrict formula call affin horn formula algorithm solv tractabl case characteris tractabl class phylogeni problem base polymorph final state prove main includ mention complex dichotomi phylogeni problem defin section class phylogeni problem illustr show instanc class studi literatur continu show formul phylogeni problem constraint satisfact problem infinit domain root tree standard terminolog concern root tree tree undirect acycl connect graph distinguish vertex root vertic denot tree paper will binari vertic root degre root degre leav vertic degre lie path pass lie strict lie youngest common ancestor yca set vertic node lie vertic maxim distanc node uniqu determin definit leaf structur binari root tree relat structur hold yca lie strict yca call under tree leaf structur well root tree uniqu determin leaf structur definit finit write yca yca lie sequenc distinct vertic write notat typic literatur phylogeni problem equival note includ possibl impli tripl leav root binari tree note xixj ykyl phylogeni problem atom phylogeni formula formula form form phylogeni formula quantifi free formula built atom phylogeni formula usual boolean connect disjunct conjunct negat phylogeni formula variabl satisfi exist root binari tree map satisfi usual semant order logic case solut finit set phylogeni formula phylogeni problem comput problem phylo instanc finit set variabl finit set phylogeni formula phylogeni formula substitut variabl variabl question tree map satisfi formula shortcut xixj ykyl diff shortcut exampl fundament problem phylogenet reconstruct root tripl consist problem mention introduct problem state conveni phylo instanc root tripl consist problem consist finit set variabl finit set atom formula form question exist tree map formula input hold exampl complet problem introduc studi close form steel wormald set root tree common leav set exist tree leav set intuit tree tree match tree hard proof problem steel wormald phylogeni problem phylo diff diff special case problem hard exampl hard proof root subtre avoid problem steel wormald adapt hard phylo diff hard proof phd thesi exampl quartet consist problem describ introduct cast phylo phylogeni formula formula describ root tree leav shortest path intersect shortest path true fact independ posit root exampl formula phyl model comput problem input consist uniform hypergraph finit set vertic task determin binari tree leaf set hyperedg input exact lie child yca exampl solv algorithm aho sagiv syzmanski ullman generalis algorithm present problem solv polynomi time algorithm present main result full classif comput complex phylo theorem finit set phylogeni formula phylo complet phylogeni problem csps mention introduct phylogeni problem formul constraint satisfact problem infinit domain reformul will essenti univers algebra ramsey theoret tool complex classif phylogeni problem structur relat signatur tupl finit infinit domain dki relat ariti structur homomorph map domain domain suppos signatur finit constraint satisfact problem denot csp comput problem csp instanc finit structur question homomorph templat problem csp formul phylogeni problem constraint satisfact problem finit set phylogeni formula xki variabl introduc relat symbol ariti write set relat symbol instanc phyl variabl associ structur domain ariti relat tupl instanc formula formula replac variabl variabl proposit finit set phylogeni formula exist structur countabl domain properti instanc phyl satisfi homomorph map structur proposit uniqu structur easi con struct specif choic present proof complex classif phylogeni problem will pleasant model theoret proper tie defin defin base structur defin term structur well studi object model theori theori infinit permut group will defin fra amalgam preliminari model theori inject homomorph preserv complement relat call embed domain relat structur substructur induc structur domain ari write structur disjoint domain intersect structur domain structur amalgam embed class structur amalgam properti amalgam class finit structur amalgam properti close isomorph induc substructur call amalgam class homomorph call endomorph automorph bijec tive endomorph invers endomorph biject embed set endomorph denot set auto morphism denot aut relat structur call homogen isomorph finit induc substructur extend automorph homogen structur finit relat signatur categor countabl structur satisfi order sentenc isomorph cameron hodg theorem fra theorem hodg amalgam class countabl isomorph member countabl infinit homogen structur class structur emb structur uniqu isomorph call fra limit work relat structur conveni distinguish relat relat symbol instanc write leaf structur definit letter stand relat symbol relat confus proposit proposit class leaf structur finit root binari tree amalgam class write fra limit amalgam class proposit struc ture well studi literatur relat common refer binari branch homogen relat studi context infinit permut group substanti literatur minim structur analog minim structur relat play role order minim structur definit structur relat structur domain call reduct relat order definit conjunct disjunct negat univers existenti quantif usual param eter relat ariti exist order formula free variabl hold well structur order definit categor structur categor refer hodg theorem analog statement homogen fals proof proposit finit set phylogeni formula reduct defin free variabl ari relat defin formula straightforward definit structur properti requir statement proposit convers csp reduct correspond phylogeni problem well fact theorem hodg categor structur homogen quantifi elimin order formula equival quantifi free formula quantifi free order definit instanc csp consid instanc phyl variabl vertic tupl formula straightforward verifi homomorph map satisfi instanc phyl class phylogeni problem correspond precis class csps templat reduct univers algebra approach appli call univers algebra approach detail introduct approach categor templat bodirski languag univers algebra eleg state border tractabl hard phylogeni problem primit posit defin order formula free variabl signatur primit posit form atom form form structur defin ari relat set tupl satisfi denot set finitari relat primit posit defin lemma illustr concept primit posit defin relat appear lemma will section lemma proof note formula equival primit posit formula note final impli result motiv interest posit primit defin con nection complex csps lemma jeavon constraint languag structur relat primit posit defin csp csp polynomi time equival polymorph primit posit defin characteris preserv call polymorph start point univers algebra approach constraint satisfact instanc bulatov jeavon krokhin approach finit domain direct categor cross product relat structur structur domain relat relat hold iff hold hold homomorph call polymorph relat domain preserv close polymorph note unari polymorph endomorph order formula defin preserv preserv oper preserv relat violat set polymorph pol relat structur form algebra object call function clone set oper defin set close composit project write pol ari function pol set pol local close sens set function domain local close function properti belong finit subset oper write smallest set local close generat oper smallest local close function clone polymorph clone character primit posit defin finit structur kotov romov geiger fals general infinit structur result remain true relat structur categor theorem bodirski categor structur primit posit defin relat precis relat preserv polymorph permut group set orbit tupl set tupl form permut discov independ engel svenonius ryll nardzewski theorem theorem hodg countabl relat structur categor automorph group oligomorph finit orbit tupl aut relat order definit categor structur preserv automorph observ lemma bodirski kara relat structur ari relat union orbit tupl aut polymorph violat ari polymorph violat function tacit extend tupl natur write set convent will conveni work polymorph model complet core structur core endomorph embed note endomorph preserv existenti posit formula embed preserv existenti formula order theori model complet embed model preserv order formula structur call model complet order theori model complet homogen categor structur provid exampl model complet structur reason categor homogen order formula equival quantifi free formula theorem embed preserv quantifi free formula statement lemma lemma structur model complet core proof endomorph suppos contradict distinct element contradict assumpt preserv inject note negat equival existenti posit definit preserv impli embed core model complet homogen structur model complet core proof proof left reader categor character model complet term embed embed lemma lemma bodirski pinsker countabl categor structur model complet embed generat automorph core endomorph embed consequ corollari countabl categor structur model complet core endomorph generat automorph note order expans categor model complet core remain model complet core structur homomorph equival exist homomor phism clear homomorph equival structur ident csps theorem bodirski categor structur homomorph equival categor model complet core structur uniqu isomorph categor speak model complet core categor structur border tractabl hard concept polymorph model complet core concis descrip tion border csps reduct solv polynomi time complet theorem reduct model complet core binari polymorph endomorph element csp csp complet proof theorem ramsey theori tree appli ramsey theori find regular behavior polymorph constraint languag approach succes adopt earlier ramsey theorem well will describ introduct ramsey theori enter analysi constraint languag finit structur write set substructur isomorph structur write color exist constant definit class finit relat structur close isomorph substructur call ramsey finit exist homogen structur call ramsey class finit structur emb ramsey ramsey theori polymorph behav canon larg part domain sens defin wider introduct canon function bodirski pinsker bodirski definit structur subset domain function canon respect aut exist aut ramsey theorem allow work canon polymorph expans constant theorem lemma bodirski pinsker tsankov homogen order ramsey structur domain oper aut generat oper canon respect ident tupl valu discuss ramsey class relev context work expans linear order defin fra limit linear order element leaf structur call convex class convexli order leaf structur appropri variant proposit omit straightforward proof proposit class amalgam class fra limit isomorph expans convex linear order clear automorph denot automorph theorem leeb structur ramsey convexli order leaf structur exist convexli order leaf structur contain proof theorem toolbox collect easi corollari relev complex classif phylogeni languag preclassif fundament result classif endomorph monoid model complet core reduct theorem bodirski jonsson pham reduct satisfi constant endomorph model complet core isomorph reduct set endomorph equal set endomorph set endomorph equal set endomorph constant endomorph csp trivial homomorph equival reduct complex csp determin item theorem deduc statement primit posit defin relat lemma phylogeni constraint languag constant endomorph homomorph equival equal constraint languag model complet core primit posit defin proof relat consist singl orbit tupl aut arbitrarili choos entri tupl pairwis distinct map send partial isomorph aut homogen partial map extend automorph impli consist orbit tupl aut aut primit posit definit model complet core lemma primit posit definit polymorph violat theorem consist orbit tupl aut endomorph violat lemma impli violat lemma polymorph coincid constant endomorph homomorph equival equal constraint languag theorem impli relat preserv endomorph model complet core lemma case model complet core recal primit posit defin lemma preserv endomorph arbitrari tupl map send partial isomorph homogen lemma partial map extend automorph impli contain orbit tupl aut aut ifqd preserv polymorph lemma preserv endomorph lead contradict preserv polymorph conclud relat primit posit defin theorem problem csp complet steel recal lemma order classifi comput plexiti csp concentr situat relat primit posit defin equal constraint satisfact problem csps reduct call equal constraint satisfact problem statement theorem special case function call essenti unari exist function theorem bodirski bodirski reduct csp preserv constant oper inject binari oper case polymorph element polymorph essenti unari csp complet case reduct preserv inject binari oper relat characteris syntact horn formula formula conjunct normal form posit liter claus lemma bodirski chen pinsker relat order definit preserv binari inject polymorph definit quantifi free horn forbidden tripl relat recal definit relat relat call forbidden tripl relat bryant lemma csp hard proof lemma mention exampl bryant csp complet lemma csp hard section interest reduct will prove reduct finit relat signatur csp binari inject polymorph condit impli categor structur binari inject polymorph exist binari inject polymorph play role part paper suffici condit exist constant endomorph finit subset domain call set element orbit set set aut imag lemma lemma bodirski orbit set inject polymorph constant endomorph definit automorph group aut call transit sequenc distinct element aut homogen structur reduct transit automorph group note transit aut impli exist orbit set definit relat independ respect primit posit formula satisfi satisfi terminolog explain greater detail cohen jeavon jonsson koubaraki will lemma corollari bodirski jonsson von oertzen infinit set relat order definit lemma lemma schel infinit set oper preserv essenti unari lemma contraposit lemma structur infinit domain binari relat independ lemma lemma bodirski pinsker countabl categor structur equival independ binari inject polymorph polymorph ariti call essenti unari function theorem categor structur countabl infinit domain transit automorph group suppos essenti polymorph constant endo morphism binari inject polymorph proof lemma lemma impli preserv essenti unari relat contradict assumpt preserv essenti polymorph binari automorph group transit continu show primit posit definit assum theorem polymorph violat consist orbit pair aut lemma endomorph violat impli inject transit automorph group orbit set lemma impli constant endomorph contradict assumpt lemma impli independ appli lemma conclud binari inject polymorph corollari reduct binari inject polymorph proof endomorph preserv constant endomorph domorph preserv violat polymorph theorem essenti polymorph reduct transit automorph group statement theorem violat forbidden tripl relat assum reduct justifi will subsect assumpt strong consequ relat domin introduc notion domin function definit function call domin argument domin second argument simpli speak domin second argument will binari polymorph canon respect domin argument defin lemma pol canon respect symmetr proof proof statement second statement symmetr preserv remain choos observ conclud main result lemma pol canon respect domin second argument proof canon assum case appli case treat analog lemma claim domin argument arbitrari case tupl pairwis distinct entri assum loss general renam consid case case analog element assumpt impli case arbitrarili choos pairwis distinct case conclud affin split notion split vector split vector tptq note split vector split vector definit split relat ari boolean relat split vector tupl will split relat relat affin defin conjunct linear equat boolean relat affin preserv mod suffic split relat preserv boolean oper defin mod lemma will part paper lemma reduct pol seri lemma need proof lemma lemma denot reduct denot ari relat primit posit definit lemma suppos tupl pairwis distinct entri orbit aut relat tupl tupl pairwis distinct orbit orbit aut proof lemma consist orbit lemma theorem impli exist pol violat pairwis distinct entri choos pairwis distinct orbit second condit fact preserv lemma suppos tupl pairwis distinct entri tupl proof hand side figur tupl correspond binari tree note tue tupl figur satisfi precondit lemma will start desir tupl repeat applic lemma step digraph left hand side figur tupl appli lemma tupl incom edg digraph pairwis distinct orbit tupl orbit aut orbit binari tree drawn figur justifi binari tree drawn conclud proof lemma suppos tupl pairwis distinct entri exist proof proof lemma repeat lemma tupl tupl final desir properti diagram figur lemma suppos tupl pairwis distinct entri tupl figur diagram proof lemma figur diagram proof lemma proof tupl appli lemma distinguish case case appli lemma tupl tupl statement case case exchang role appli lemma tupl point continu case work case case exchang role case exhaust proof lemma tupl pairwis distinct entri defin pol clear preserv polymor phism primit posit defin lemma exist pol claim preserv preserv impli claim arbitrarili choos distinct aut function polymorph lemma reduct relat affin split relat proof ari relat arbitrarili choos clear suppos case split vector split vector pol lemma aut preserv choic consid tupl impli split vector separ introduc notion separ relat definit relat call separ exist tupl common split vector denot reduct will prove relat separ start generalis lemma lemma inject pol proof corollari binari inject polymorph theo rem impli aut generat binari polymorph inject canon respect lemma function domin second argument lemma pol domin argument inject inject domin argument case domin second argument treat function lemma relat separ proof relat ariti lemma exist inject pol theorem set aut generat binari inject function canon respect ident impli arbitrarili choos preserv observ substructur induc isomorph arbitrari tupl orbit aut orbit aut impli function canon respect appli lemma restrict domin argument second argument split vector analys number case exist domin argument homogen recal split vector hold inject properti direct domin argument straightforward verifi satisfi exist domin second argument case analog previous case work polymorph arbitrari oper domin argument second argument homogen choos aut fact straightforward verifi vector split vector assumpt concern domin properti hmhn domin argument tmtn hmhn domin second argument choos aut split vector fact impli note hmhn domin second argument direct fact domin argument condit satisfi arbitrari oper domin second argument argument case treat previous case consid polymorph case exhaust conclud proof freeness introduc notion free relat definit ari relat call free common split vector lie orbit aut tupl split vector tjtl assum will prove relat free introduc notion cone split definit sequenc subset call cone split partit observ cone split uniqu cone split cone split cone split cone split uniqu determin set cone split cone split arbitrari binari polymorph observ fact preserv lemma binari inject polymorph theorem aut generat inject binari polymor phism canon respect ident note impli defin subset arbitrarili choos defin canon lemma function domin second argument defin observ substructur induc isomorph arbitrari orbit orbit impli function canon respect isomorph previous item observ lemma impli domin second argument domin argument domin argument fact canon respect arbitrari subset domin domin argument domin second argument domin observ impli domin second argument case appli domin domin choic deal case lemma lemma domin relat free proof ariti arbitrarili choos tupl split vector orbit tupl aut assum domin argument consid polymorph function domin second argument assumpt note homogen choos aut tupl orbit aut inject function preserv impli split vector tjtl domin argument domin second argument desir properti definit lemma assum domin ari relat orbit aut cone split tupl orbit aut cone split tjtl proof suppos loss general domin second argument prove lemma induct base case requir properti induct step assum statement hold prove hold exist partit consid cone split sequel note induct hypothesi applic cone split homogen exist aut note map set set observ cone split tupl addit properti tupl orbit aut inject observ connect definit hjhl fact notdomin second argument observ second properti impli cone split induct assumpt tupl orbit aut cone split tjtl hjhl conclud cone split observ appli induct assumpt cone split tupl properti tupl orbit aut tjtl tjtl impli second third condit impli tjtl final orbit aut tupl desir properti lemma relat free proof pol introduc observ observ domin lemma assum domin assum domin second argument consid polymorph ari relat lie orbit aut common split vector defin clear cone split appli lemma cone split exist tupl cone split split vector tjtl satisfi condit definit affin horn relat reduct relat separ free affin split prove relat defin quantifi free formula special syntact restrict form call affin horn formula affin horn formula introduc mention characteris step final polynomi time algorithm test satisfi affin horn formula polynomi time algorithm csp finit signatur affin horn formula recal boolean relat call affin defin system linear equat system element field well boolean relat affin preserv function mod definit boolean relat stand formula formula call affin affin definit affin horn claus formula form form affin formula affin horn formula conjunct affin horn claus relat call affin horn defin affin horn formula phylogeni constraint languag call affin horn relat affin horn note definit equal variabl equal exampl relat affin horn note equival defin formula suffici verifi conjunct affin horn formula obvious second third fourth conjunct conjunct consid relat boolean relat affin mod mod equival mention consequ theorem affin horn relat separ free affin split relat convers true exampl consid relat defin xyz note relat separ free affin split relat affin horn observ equival primit posi tive formula relat split relat affin class affin horn relat close primit posit defin corollari affin horn inject case reduct relat separ free affin split relat studi ari relat tupl pairwis distinct entri defin note defin clear split relat affin assumpt lemma proof clear prove revers inclus suffic exist rip common split vector relat separ split vector hold tjtl rjrl rip common split vector consid affin horn formula defin xip diff lemma relat affin horn definit proof proof induct ariti statement trivial express defin note note relat tupl pairwis distinct entri sake notat assum induct assumpt definit definit assumpt free definit lemma xlr xlr xlr xlr final impli xlr observ split vector satisfi disjunct xli sli xli sli xlr consequ previous paragraph xip xjq impli conclud general case finish proof relat affin horn proposit ariti defin relat defin formula choic note form partit distinct relat contain dif ferent orbit aut pick formula defin lemma formula preserv inject proof suppos satisfi formula satisfi satisfi corollari binari inject polymorph inject orbit aut satisfi formula lemma combin lemma quantifi free horn definit entri equal entri exact aiq aiq pairwis distinct defin affin horn formula aij proposit relat affin horn definit proposit main result proof establish fact concern relat separ lemma entri uip equal exist lie orbit tupl aut wip uip common split vector proof uip distinct compon split vector consid case depend size sip separ appli hold lie orbit aut wjwl ujul uip wip common split vector desir properti separ appli exist hold lie orbit aut tupl common split vector impli wip uip common split vector case desir properti proof proposit tupl satisfi member satisfi exist satisfi hold satisfi satisfi tupl pairwis distinct entri diff xip xip defin lemma tupl satisfi diff xip remain satisfi clear satisfi verifi satisfi indic aij satisfi disjunct left case aij ail order satisfi split vector lemma appli exist lie orbit aut wip common split vector split vector conclud proof satisfi corollari reduct relat affin horn proof lemma relat affin split free separ proposit relat affin horn solv input affin horn formula output satisfi unsatisfi spec satisfi return satisfi spec set variabl contract empti claus return unsatisfi return solv spec input affin horn formula variabl output satisfi subset trivial solut split problem return trivial solut spec return spec return return satisfi figur polynomi time procedur satisfi affin horn formula test satisfi affin horn formula satisfi affin horn formula solv polynomi time formul algorithm concept origin bodirski mueller definit affin horn formula split problem boolean constraint satisfact problem variabl conjunct form affin boolean constraint formula empti set variabl contract formula replac variabl subsequ remov disjunct form conjunct form lemma finit subset automorph proof consequ fact finit leaf structur emb homogen theorem polynomi time algorithm decid affin horn formula satisfi proof algorithm figur correct algorithm direct claim procedur spec describ figur properti spec return satisfi exist inject solut solut variabl distinct valu spec return set variabl solut variabl equal prove claim induct recurs structur spec split problem affin boolean csp decid polynomi time gaussian elimin constant solut inject solut split problem constant solut trivial solut induc left children root solut split problem constant solut variabl equal valu output algorithm satisfi claim suppos split problem trivial solut recurs call spec return satisfi return set variabl correct claim induct assumpt reason subset constraint impli variabl denot equal valu solut impli variabl equal solut spec return input correct recurs call return satisfi argu exist solut inject solut map automorph automorph exist lemma claim inject solut conjunct disjunct form satisfi inject variabl satisfi induct assumpt variabl side suppos free variabl ari boolean relat tupl solut split problem satisfi disjunct final run time polynomi size input variabl contract perform bound number recurs call procedur solv final procedur spec solv linear number boolean affin split problem polynomi time well corollari reduct affin horn finit signatur csp solv polynomi time proof instanc csp conjunct definit conjunct affin horn formula finit relat symbol replac conjunct defin formula chang size formula constant factor formula conjunct affin horn formula satisfi satisfi affin tree oper border hard polynomi time tractabl phylogeni problem state term polymorph announc theorem order prove result introduc kind binari oper call affin tree oper defin affin tree oper concept perfect domin stronger notion domin introduc finit subset function call perfect domin argument condit hold call perfect domin second argument function perfect domin argument inject function finit subset induct defin semidomin semidomin semidomin subset condit hold semidomin perfect domin argument perfect domin second argument definit oper call affin tree oper semidomin finit subset exist affin tree oper prove exist affin tree oper denot start finit version statement write lemma finit subset function empti subset function semidomin perfect domin argument proof proof induct claim trivial function arbitrari requir properti suppos partit induct assumpt function satisfi condit claim assum aut continu argument perfect domin argument perfect domin second argument assum reason satisfi condit statement resp resp semidomin partit clear straightforward verifi resp perfect domin argument resp second argument resp perfect domin argument resp perfect domin second argument induct assumpt resp semidomin resp semidomin proposit exist affin tree oper call oper properti finit exist aut proof empti finit subset arbitrari binari function satisfi condit lemma prove induct automorph aut arbitrari trivial partit induct assumpt exist aut perfect domin argument second argument aut condit partial isomorph homogen extend automorph claim claim combin lemma impli arbitrari finit subset function satisfi condit lemma function satisfi condit lemma satisfi countabl exist oper semidomin finit subset prove second statement proposit induct clear claim hold consid case will partial isomorph partit hold assum perfect domin argument perfect domin second argument map partial isomorph induct assumpt partial isomorph properti partial isomorph extend automorph aut homogen oper affin horn formula note inject preserv fact preserv larger class affin horn formula preserv affin formula definit lemma affin preserv formula introduc definit proof tupl satisfi denot set consid case claim trivial assum case exhaust perfect domin common split vector satisfi semidomin impli common split vector satisfi argu case remain consid case enumer denot tupl split vector view function map constant perfect domin impli common split vector satisfi consid case constant semidomin common split vector satisfi argu case constant constant left case constant partit consid case common split vector split vector satisfi suppos common split vector split vector split vector assumpt empti impli split vector affin satisfi proposit function preserv affin horn formula proof proposit suffic preserv affin horn claus formula form affin formula tupl satisfi claus satisfi satisfi inject satisfi claus satisfi satisfi lemma preserv affin formula satisfi satisfi claus corollari reduct equival preserv relat affin horn relat affin horn proof impli oper preserv expans addit relat preserv note oper preserv relat arbitrarili choos pairwis distinct element clear semidomin properti note impli preserv theorem corollari relat affin horn impli trivial impli proposit symmetri modulo endomorph prove exist endomorph idea lemma proof proposit bodirski pinsker pongracz lemma categor pol suppos finit subset domain exist aut aut proof construct root tree vertex tree lie level enumer set partial isomorph domain defin equival relat exist aut note relat finit equival class categor theorem vertic tree level precis equival class equival satisfi equival class partial map empti domain root tree level defin adjac tree restrict vertex level vertex level adjac tree note root tree finit branch assumpt tree vertic level tree lemma exist infinit path tree level defin aut suppos defin defin will adjac exist definit exist aut defin observ extend defin corollari exist endomorph proof proposit finit aut lemma appli main complet proof complex dichotomi phylogeni problem announc theorem reformul csps reduct theorem stronger complex classif theorem dichotomi reduct remain interest view fundament result context constraint satisfact dichotomi phrase equival way terminolog topolog univers algebra model theori introduc concept state link strongest formul primit posit interpret primit posit interpret prove hard refer reader bodirski will consid relat nae connect primit posit interpret problem csp nae call posit equal garey johnson complet definit relat structur order interpret structur exist natur number call dimens formula call domain formula atom formula formula denot dis joint tupl distinct variabl call defin formula surject map tupl element satisfi call coordin map atom formula tupl domain formula primit posit interpret primit posit interpret paramet interpret formula involv element paramet interpret paramet interpret expans finit constant primit posit interpret context csp lemma lemma proposit structur finit relat signatur suppos categor primit posit interpret polynomi time reduct csp csp model complet core interpret paramet conclus lemma hold primit posit interdefin propo sition concern relat second proposit concern relat proposit arbitrari distinct member structur nae primit posit interpret proof freeli relat primit posit formula lemma dimens interpret domain formula coordin map send defin formula ternari relat interpret verifi nae hold suppos solut consequ solut final impli contradict situat rule analog interpret formula symmetr suppos case satisfi assign valu case treat analog consid case satisfi assign valu note interpret formula symmetr case treat analog final remain case analog previous symmetri proposit structur nae primit posit interpret three pairwis distinct constant proof relat defin lemma bodirski jonsson van pham isomorph isomorph transit assum loss general fix straightforward verifi exist dimension primit posit interpret coordin choos interpret formula interpret formula boolean split relat affin lemma impli primit posit defin recal tacit assum proposit structur primit posit interpret primit posit interpret clone homomorph denot function clone defin function call clone homomorph send project correspond project satisfi ident ari ari homomorph continu map continu respect topolog pointwis converg close set precis set local close defin continu clone homomorph context primit posit inter pretat theorem bodirski pinsker categor finit primit posit interpret pol continu clone homomorph pol relev situat primit posit interpret hard boolean csps thing specif theorem situat write clone set project theorem bodirski pinsker categor structur nae primit posit interpret pol continu clone homomor phism taylor oper modulo endomorph polymorph ariti call taylor polymorph modulo endomorph endomorph gamma hold special case taylor polymorph modulo endomorph symmetr polymorph modulo endomorph exist endomorph general categor model complet core taylor poli morphism nae primit posit interpret paramet case item equival result model complet core reduct interpret nae paramet equival exist symmetr polymorph modulo endomorph mention direct true general exist taylor polymorph modulo endomorph rule exist interpret nae paramet proof fact special case symmetr polymorph modulo endomor phism restrict special case simplic notat special case statement main result reduct lemma categor model complet core symmetr polymor phism modulo endomorph clone homomorph pol proof denot domain assumpt exist binari polymorph clear endomorph denot lie orbit aut model complet core aut clear choic will pol symmetr polymorph modulo endomorph clone homomorph pol algebra topolog dichotomi studi reduct situat relat primit posit defin situat characteris binari symmetr polymorph modulo endomorph present theorem case finit relat signatur equival item theorem describ precis csp compar theorem theorem reduct equival relat primit posit definit relat primit posit definit free separ induc affin split relat relat affin horn preserv binari oper binari polymorph endomorph clone homomorph pol continu clone homomorph pol expans finit constant primit posit interpret nae proof equival prove implic cyclic order combin lemma proposit lemma lemma lemma fortiori theorem contraposit proposit fact requir clone homomorph continu item theorem simpli drop item remark clear continu condit drop clone homomorph polymorph clone general relat structur discuss suppos reduct finit relat signatur interest meta problem decid complex csp effect assum order definit relat equival condit theorem algorithm decid problem way base techniqu develop bodirski pinsker tsankov reduct ramsey structur finit bound refer definit detail effect test relat second base third item theorem test relat affin horn key observ proof proposit prove exist affin horn definit relat construct theorem reduct model complet core equival binari polymorph endomorph element clone homomorph pol element continu clone homomorph pol expans finit constant primit posit interpret nae proof proof theorem implic hold categor model complet core general element easi item statement true isomorph reduct statement deriv easili theorem lemma structur model complet core identifi lemma state primit posit defin proposit impli item statement fals statement theorem base proof theorem decid result decid meta problem general reduct finit signatur complex dichotomi ingredi prove complex classif state theorem recal theorem csps class binari polymorph symmetr modulo endomorph complet proof theorem reduct finit relat signatur clear csp model complet core expans finit constant interpret nae primit posit csp csp complet lemma assum case theorem structur polymorph endomorph revisit proof fact order prove csp case constant endomorph model complet core element csp trivial isomorph reduct statement theorem lemma structur model complet core relat relat primit posit defin proposit assumpt imposs theorem impli polymorph relat affin horn case csp corollari prove complex classif phylogeni problem state theo rem translat csps explain refer adelek neumann relat between structur automorph volum memoir american mathemat societi aho sagiv szymanski ullman infer tree lowest common ancestor applic optim relat express siam journal comput bodirski core countabl categor structur logic method comput scienc bodirski constraint satisfact problem infinit templat vollmer editor complex constraint collect survey articl volum lectur note comput scienc springer bodirski complex classif infinit domain constraint satisfact moir dirig des recherch universit diderot pari arxiv bodirski ramsey class exampl construct appear proceed british combinatori confer arxiv bodirski chen pinsker reduct equal primit posit interdefin journal symbol logic bodirski jonsson pham reduct homogen binari branch relat preprint arxiv bodirski jonsson von oertzen horn versus full order complex chotomi algebra constraint satisfact journal logic comput bodirski complex equal constraint languag theori comput ing system confer version appear proceed comput scienc russia csr bodirski complex tempor constraint satisfact problem journal acm extend abstract appear proceed symposium theori comput stoc bodirski mueller root phylogeni problem logic method comput scienc extend abstract appear proceed icdt bodirski constraint satisfact countabl homogen templat journal logic comput bodirski pinsker reduct ramsey structur contemporari mathemat model theoret method finit combinator bodirski pinsker theorem graph proceed annual symposium theori comput stoc preprint long version bodirski pinsker minim function random graph israel journal mathemat bodirski pinsker topolog birkhoff transact american mathemat societi bodirski pinsker pongra project clone homomorph preprint avail arxiv bodirski pinsker tsankov decid defin journal symbol logic confer version appear proceed lic kotov romov galoi theori post algebra cybernet bryant build tree hunt tree compar tree phd thesi univers canterburi bryant steel extens oper set leaf label tree advanc appli mathemat bulatov krokhin jeavon classifi complex constraint finit algebra siam journal comput cameron oligomorph permut group cambridg univers press cambridg chen rendezv logic complex algebra sigact news cohen jeavon jonsson koubaraki build tractabl disjunct con straint journal acm garey johnson guid complet csli press stanford geiger close system function predic pacif journal mathemat haskel macpherson cell decomposit minim structur annal pure appli logic henzing king warnow construct tree homeomorph subtre applic comput evolutionari biolog proceed symposium discret algorithm soda hodg model theori cambridg univers press jeavon algebra structur combinatori problem theoret comput scienc leeb vorlesungen ber pascaltheori volum arbeitsbericht des institut mathematisch maschinen und datenverarbeitung friedrich alexand universita erlangen rnberg macpherson steinhorn variant minim ann pure appl logic steel wormald difficulti construct leaf label tree includ avoid subtre discret appli mathemat schel funktionen und relationenalgebren deutscher verlag der wissenschaften steel complex reconstruct tree qualit charat subtre journal classif szendrei clone univers algebra minair math matiqu supe rieur les press montr 