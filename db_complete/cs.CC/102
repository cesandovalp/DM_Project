reduct valu csp min cost homomorph problem digraph robert powel andrei krokhin durham univers school engin comput scienc durham juli abstract valu constraint satisfact problem vcsp goal find assign label variabl minim sum func tion function sum depend subset variabl take valu ration number infin chosen fix finit set function call constraint languag case function valu infin constraint sat isfact problem csp csp fix constraint languag polynomi time equival constraint lan guag singl binari relat digraph proof bulin reduct preserv algebra properti constraint languag charac teriz complex correspond csp adapt proof general set vcsp vcsp fix finit valu constraint languag equival constraint lan guag consist valu binari function digraph finit valu unari function problem tend minimum cost homomorph problem digraph reduct preserv algebra properti valu constraint languag introduct constraint satisfact problem csp well studi framework express number combinatori problem includ proposit satisfiabil iti graph colour system equat instanc csp consist set variabl set label variabl set constraint combin label subset variabl goal find assign label variabl satisfi work partial support epsrc grant constraint well csp general complet strict problem fix set constraint type general refer constraint languag polynomi time solvabl subprob lem classifi complex csps fix constraint languag major area pioneer dichotomi result natur optimis version csp will consid minimum cost homomorph mincosthom valu csp vcsp mincosthom instanc csp addit cost func tion cost assign label variabl goal decid satisfi assign exist find minim total cost note natur restrict set cost function consid constraint languag complex classifica tion mincosthom vcsp general optimis version csp constraint allow combin label variabl assign combin label cost ration number infin indic disallow combin goal find assign minim total cost natur constraint languag consist cost func tion relat interest classifi complex vcsps survey note csp deal entir feasibl issu constraint satisfi mincosthom add limit optimis aspect cost func tion appli individu variabl vcsp fulli incorpor feasibl optimis issu full complex classif csp open fact major open problem interest find difficulti classifi three framework relat surpris classif vcsp duce classif mincosthom case mincosthom constraint languag consist digraph unari cost function well csp cast homomorph problem relat structur special case studi homomor phism problem graph csp fix constraint languag problem decid exist homomorph fix relat structur csp fix target structur polynomi time equival digraph homomorph problem fix target digraph bulin develop variant reduct maintain number algebra prop erti crucial extrem success algebra approach csp explicit ask techniqu extend constraint problem vcsp fact proof reus part note paper announc complex classif vcsps reduc classi ficat csps preliminari valu constraint satisfact homomorph problem fix finit set denot set negat ration number posit infin set ari function will call function cost function remaind paper consid finit constraint languag definit set variabl valu constraint express instanc vcsp function valu constraint negat ration weight goal find map minimis definit valu constraint languag finit subset valu constraint languag vcsp class instanc vcsp cost function valu constraint vcsp framework flexibl describ number well problem highlight exampl exampl consid well hard problem max cut edg weight graph aim partit vertic set maximis total weight edg endpoint set easi problem equival express vcsp vcsp equival max cut vcsp hard exampl standard csp express vcsp cost function valu repres allow disallow tupl respec tive valu constraint valu cost function refer crisp constraint exampl arbitrari lattic function call submodular satisfi inequ constraint languag consist submodular function vcsp tractabl exampl hard tractabl problem express vcsps survey explain csp vcsp cast homomorph prob lem definit relat signatur set relat symbol associ ariti relat structur consist finit domain relat ariti structur domain homomorph function tupl appli compon wise case write definit finit relat structur csp decis problem structur homomorph exampl digraph homomorph problem fix digraph ask input digraph admit homomorph map problem colour problem complet graph vertic problem well colour problem restrict csp general structur digraph reduc difficulti classifi complex theorem structur digraph csp csp polynomi time equival definit themincosthom problem input structur addit unari cost function spec ifi cost map individu element goal decid homomorph find minim total cost set unari cost function mincosthom denot subproblem mincosthom unari function instanc form write simpli mincosthom problem mincosthom studi seri paper plete complex classif undirect graph digraph general structur partial complex classif problem mincosthom mincosthom intermedi problem csp vcsp optimis aspect limit sens control separ unari function explicit interact variabl will defin vcsp homomorph problem will allow easili reus definit weight relat ariti set function ari relat set weight structur structur relat weight ignor weight function turn weight structur ordinari unweight structur instanc vcsp weight structur feasibl solut instanc homomorph cost cost goal decid homomorph exist find minim cost definit ari cost function defin feasibl relat fea fea obvious correspond valu constraint languag weight structur constraint languag turn weight structur turn function weight relat fea simpli ignor tupl infinit cost introduc signatur symbol ariti function ariti clear obtain weight structur revers procedur convert weight structur valu constraint languag correspond vcsp vcsp fol low instanc vcsp view domain set variabl instanc vcsp tupl rise valu constraint weight func tion extend infinit valu homomorph precis solut finit cost correspon denc preserv cost vcsp vcsp effect problem note function valu vcsp fact csp weight structur describ will weight effect unweight vcsp problem csp clear function valu unari finit valu vcsp mincosthom obvious choic algebra definit weight relat under relat oper polymorph appli compon wise weight structur denot pol set oper polymorph pol set ari oper pol polymorph play major role classif complex ordinari csp vcsp general notion weight polymorph definit weight relat pol function ari weight polymorph satisfi condit project wpol denot set weight polymorph exampl rewrit submodular condit exampl binari weight polymorph function oper oper project second coordin consid weight oper assign oper respect weight easi check function weight polymorph submodular weight structur wpol wawpol weight polymorph power algebra tool studi vcsp complex valu constraint languag charac teris weight polymorph theorem weight structur wpol wpol vcsp polynomi time reduc vcsp weight polymorph special case play key role plexiti classif vcsp introduc notion core valu constraint languag intu itiv valu constraint languag core element domain instanc optim solut simpli remov reduc problem smaller domain formal core defin definit weight structur core unari polymorph biject rigid core ident map unari polymorph lemma weight structur weight structur rigid core vcsp polynomi time equival vcsp formal state prove main paper theorem weight structur rigid core balanc digraph rigid core finit valu function problem vcsp mincosthom polynomi time equival proof assum loss general weight relat ariti ariti standard trick direct product relat well hard replac chang complex vcsp reduct vcsp mincosthom lem mas reduct opposit direct lemma construct first introduc simpl definit digraph will construct main theorem paper definit digraph orient path consist sequenc vertic precis edg denot initi vertex termin vertex definit digraph vertic connect orient path write exist homomorph digraph weak connect pair vertic connect length orient cycl defin absolut differ edg orient direct edg orient opposit direct connect digraph balanc cycl length vertic balanc digraph organis level edg digraph lvl lvl minimum level top level height will call level vertic base vertic zigzag orient path singl edg path recal ariti singl weight relat defin singl edg zigzag defin orient path height denot concaten path under relat domain start point consid digraph vertic edg replac edg path digraph complet construct defin unari function vertic note unari function digraph ident digraph defin definit number vertic remain number edg proven construct perform polynomi time exampl consid weight structur domain singl weight relat undefin figur digraph built weight structur digraph construct figur unari function built vertex lemma state unari polymorph relat digraph correspond lemma rigid core rigid core reduct vcsp mincosthom instanc vcsp weight structur variabl constraint instanc explicit constrain subset variabl instanc implicit constrain combin constraint weight relat describ plicit constraint belong express definit instanc vcsp domain tupl distinct element defin weight relat min cost note homomorph undefin weight relat express instanc vcsp domain lemma weight structur weight relat express vcsp polynomi time reduc vcsp weight relat structur weight rela tion simpli assign edg lemma express proof domain weight relat express sens equat consid weight structur binari weight relat correspond orient path defin empti unari relat initi vertex unari weight relat defin homomorph simpli homomorph clear imag homomorph exact base element precis element express consid weight structur binari weight relat correspond digraph identifi termin vertic direct path unari relat singl element common vertex path weight initi element hard definit precis requir weight relat reduct mincosthom vcsp structur weight relat make weight vcsp vcsp polynomi time equival lemma mincosthom reduc vcsp polynomi time proof instanc mincosthom digraph unari weight relat respons optimis aspect problem formal match definit assum vertic function appli reduct modif reduct stage reduct exact stage modifi stage verifi balanc test height initi check verifi balanc height greater height condit fail homomorph return fix instanc vcsp easi check perform polynomi time clear balanc height homomorph vertic top level map vertic top level vertex top level affect cost homomorph safe remov will assum empti top level vertic stage elimin short compon connect compon height short ponent find optim solut compon direct polynomi time proof repeat procedur short compon compon solut return fix instanc vcsp pro vide optim solut short compon ignor compon remaind reduct height find optim solut connect compon complet reduct output fix instanc vcsp stage construct stage ident stage includ complet stage build object consist list tupl subscript list equal tupl set vertic vertic creat algorithm will technic detail digraphh satisfi digraph homomorph connect balanc digraph smallest set satisfi set effici denot set vertic creat algorithm construct uniqu remind reader height ariti weight relat intern compon connect compon induc subgraph remov vertic height algorithm first creat tupl top level vertic ver tex will tupl subscript vertex height identifi intern compon edg compon add vertex ith compon vertex set output tupl intern compon edg vertic level add ith vertex set output tupl add vertex ith vertex set output tupl complet algorithm construct creat tupl will subscript base vertic level vertex identifi intern compon edg edg vertex height intern compon exist valu constraint languag add ith vertex set output tupl add vertex ith vertex set output tupl algorithm complet creat list equal show vertic will map vertex homomor phism rule creat intern compon edg distinct vertic height write intern compon edg distinct vertic height write stage construct modif construct structur proof construct weight structur weight relat relat will weight relat ident uniqu relat structur whilst built control optimis aspect reduct start build equal graph vertic base vertic vertic creat stage algorithm rule creat edg equal graph direct three rule creat edg equal graph add edg vertex vertex lie vertex set add edg equal iii add edg appear ith vertex set tupl subscript equal element domain will set vertic connect compon equal graph construct vertic connect compon map element homomorph tupl replac vertex set coordin tupl set vertic connect compon ing vertex set equal graph remov book keep subscript tupl weight relat assign weight weight relat will defin tupl defin assum defin defin tupl subscript satisfi case defin sum valu state homomorph correspond homomorph elabor correspond homomorph construct consist tupl element vertex set vertex set bottom vertic ofg vertic creat stage algorithm consid vertex set tupl vertex set vertic common vertex set ident identifi group equal graph stage vertex set consist vertic vertex set appear tupl note ignor repeat tupl tupl consist vertic ignor note tupl map homomorph homomorph correspond ignor tupl homomorph map bottom vertic bottom vertic definit bottom vertic element consid tupl element vertex set bottom vertex element map map vertex homomorph fulli determin act vertex set bottom vertex consid case tupl element vertex set vertic assum element ith posit tupl vertic creat stage step step specif top vertex step specif base vertex will fall exact case consid case vertex creat specif top vertex vertex creat intern ponent edg step intern compon edg edg base vertic step homomorph identifi top vertex vertex map identifi uniqu intern compon top vertex base vertex connect identifi base vertex element map vertex set con tain vertic determin act vertex set consid case vertex creat base vertex step note creat vertex intern compon edg edg top vertex note intern compon tupl consist vertic ignor intern compon edg homomorph identifi base vertex map vertic map identifi specif top vertex orient path map method identifi base vertex vertex map identifi uniqu intern compon top vertex identifi base vertex connect homomorph map vertex base vertex determin act vertex set case cover vertex set appear tupl fulli defin remain argu homomorph tupl construct tupl correspond top vertex map homomorph top vertex vertex correspond tupl tupl consid element tupl vertex set set base vertic vertic map base vertex correspond appropri element tupl tupl homomorph argument revers direct simpler arbitrari homomorph easili recov homomorph construct tupl correspond top vertic element set bottom vertic vertic likewis tupl correspond top vertic element bottom vertic homomorph top vertic map top vertic likewis bottom vertic intern compon forc map satisfi path recov homomorph fulli determin vice versa suc cess proven correspond construct correspond homomor phism will cost consid homomorph will cost cost correspond homomorph will cost cost defin top vertex top level vertex tupl tupl construct top vertic correspond tupl top level vertic correspond tupl correspond homomorph vertex correspond tupl vertex correspond tupl cost appli homomorph vertex cost appli homomorph correspond tupl definit final argu cost equal consid case vertic map uniqu top vertic definit cost cost consid case map ver tice top vertex impli fore weight sum weight order cost cost hold definit set empti cost undefin turn tupl defin cost undefin reduc problem feasibl problem deal short compon provid argument justifi stage algorithm proof lemma consid vcsps elimin short compon input digraph check compon satisfi method standard csps involv test compon satisfi fix famili direct path identifi associ cost lemma lemma consid path recal path zigzag posit csp solvabl polynomi time singleton unari relat problem csp solvabl polynomi time definit qsl path initi termin vertex defin fan structur path amalgam share vertex unari function restrict lemma mincosthom restrict input height polynomi time solvabl proof consid instanc mincosthom assum homomorph height strict height singl compon call homomorph solut satisfi solut consid case check solut involv case satisfi path qsi appli lemma path qsi identifi path feasibl vertex interpret height path qsi unari singleton height test solut find solut fix height success height find solut height path qsi continu case solut vertex map top level vertex cost map multipl solut cost choos solut minim cost reduc singl valu tupl object function determin cost vertex map vertex feasibl solut influenc optimis problem ignor remaind reduct solut involv follow procedur optimis consid procedur complet choos vertex check interpret height lemma consid compon induc graph remov vertic height test compon satisfact path qsi highest level vertic constrain height qsi compon satisfi path qsi satisfi satisfi choic vertex select vertex repeat satisfi assum feasibl solut reduc singl valu tupl object function determin cost preserv algebra properti studi algebra properti polymorph constraint languag classifi comput complex csps basi number csp dichotomi proof element domain work barto kozik describ constraint languag solvabl local consist method problem bound width algebra csp dichotomi conjectur predict term polymorph split polynomi time complet problem occur properti polymorph ident equal term hold choic variabl involv type oper oper idempot satisfi ident ari oper weak unanim wnu idem potent satisfi ident ari oper cyclic ari oper symmetr permut exampl algebra dichotomi conjectur state core structur csp tractabl wnu polymorph ariti complet core problem csp bound width wnu polymorph ariti core weight structur weight relat defin tupl correspond ariti vcsp solvabl polynomi time symmetr weight polymorph ariti hard well easi weight unweight structur rigid core polymorph idempot oper signatur set oper symbol ariti assign ident express term signatur ident linear involv occurr oper symbol balanc variabl occur notion balanc digraph set ident linear con tain linear ident idempot oper symbol ident balanc ident balanc note ident defin wnu symmetr cyclic oper linear balanc recal structur lemma express weight polymorph restrict weight poli morphism presenc weight polymorph oper satisfi set ident carri linear balanc set ident convers true introduc fact connect compon power direct kth power digraph vertic tupl element edg edg consid diagon set clear diagon contain weak connect compon denot will properti proven lemma lemma assum connect compon tupl lvl lvl satisfi lvl lvl element defin linear order vertic digraph denot path write linear order extend linear order defin map set minim final defin linear order vertic digraph lvl lvl lvl lvl lvl lvl closer lemma subset edg edg minim element edg introduc main theorem theorem theorem ari weight polymorph oper satisfi linear balanc set ident ari weight polymorph biject oper satisfi oper project oper wnu hold oper project oper cyclic symmetr hold proof polymorph transform fact extend polymorph set linear balanc ident carri transform design preserv balanc ident purpos simplifi version appli simplifi transform project oper extend project oper stay project oper biject weight oper will weight polymorph weight condit definit weight polymorph will trivial satisfi condit trivial carri remain ensur weight polymorph extend oper oper condit fact weight polymorph fact weight polymorph rest proof set linear balanc ident oper symbol interpret specif oper oper satisfi loss general assum set project oper will extend project oper correspond projec tion project oper polymorph will satisfi construct will ensur describ weight polymorph digraph zigzag vertic label describ orient path vertex pair zigzag defin oper vertex closer ariti clear set satisfi balanc set ident defin polymorph assum ari project oper will denot element appli tupl compon wise note polymorph appli element element construct case defin defin case minim pei singl edg defin vertex level zigzag pei zigzag well pei zigzag pei uniqu isomor phism denot isomorph pei zigzag defin minim element set pei zigzag case defin minim element set definit case split three subcas unnecessari purpos case proof polymorph subset proof claim remain weight polymorph satisfi third condit definit weight polymorph appli condit recal definit inspect definit clear term sum correspond project weight posit definit sum posit hand case inequ hold inequ hold finish proof theorem refer barto kozik constraint satisfact problem solvabl local consist method journal acm articl bulatov dichotomi theorem constraint satisfact problem element set journal acm bulatov jeavon krokhin classifi complex constraint finit algebra siam journal comput bulin delic jackson niven reduct csp dichotomi conjectur digraph volum lncs bulin delic jackson niven finer reduct constraint problem digraph technic report arxiv cohen cooper creed jeavon algebra theori complex discret optimis siam journal pute cohen cooper jeavon algebra characteris complex valu constraint volum lncs cohen cooper jeavon krokhin complex soft constraint satisfact artifici intellig feder vardi comput structur monoton monad snp constraint satisfact studi datalog group theori siam journal comput gutin hell rafiey yeo dichotomi minimum cost graph homomorph european journal combinator hell graph homomorph oxford univers press hell rafiey dichotomi minimum cost homomorph problem digraph siam journal discret mathemat huber krokhin powel skew bisubmodular valu csps siam journal comptu jeavon krokhin complex valu constraint satisfact bulletin beatc kolmogorov krokhin rol complex general valu csps technic report arxiv maro mckenzi exist theorem weak symmetr oper algebra universali kozik ochremiak algebra properti valu constraint satisfact problem technic report arxiv schaefer complex satisfi problem stoc takhanov dichotomi theorem general minimum cost momorph problem stac takhanov extens minimum cost homomorph problem cocoon thapper power linear program valu csps foc thapper complex finit valu csps stoc uppman complex three element min sol conserv min cost hom icalp uppman comput complex extend minimum cost homomorph problem three element domain stac 